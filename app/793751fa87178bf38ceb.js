/*! For license information please see 793751fa87178bf38ceb.js.LICENSE.txt */
(globalThis.webpackChunk_upsetjs_app=globalThis.webpackChunk_upsetjs_app||[]).push([[680],{1680:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Xn});var a=n(6538),r=n(4082),s=n(3945),l=n(7079);class o{constructor(){Object.defineProperty(this,"sidePanelExpanded",{enumerable:!0,configurable:!0,writable:!0,value:new Set((localStorage.getItem("sidePanel")||"queries,options,sets,elems").split(","))}),Object.defineProperty(this,"menu",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"zen",{enumerable:!0,configurable:!0,writable:!0,value:"T"===localStorage.getItem("zen")}),Object.defineProperty(this,"defaultTheme",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"setTable",{enumerable:!0,configurable:!0,writable:!0,value:{order:"desc",orderBy:"cardinality"}}),Object.defineProperty(this,"elemTable",{enumerable:!0,configurable:!0,writable:!0,value:{order:"asc",orderBy:"name"}}),Object.defineProperty(this,"speedDial",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ref",{enumerable:!0,configurable:!0,writable:!0,value:(0,r.createRef)()}),Object.defineProperty(this,"toast",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"visXAttr",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"visYAttr",{enumerable:!0,configurable:!0,writable:!0,value:null}),(0,l.rC)(this),(0,l.EH)((()=>{localStorage.setItem("zen",this.zen?"T":"F")})),(0,l.EH)((()=>{localStorage.setItem("sidePanel",Array.from(this.sidePanelExpanded).join(","))}))}get theme(){var e;return null!==(e=this.defaultTheme)&&void 0!==e?e:"light"}setSpeedDial(e){this.speedDial=e}toggleSidePanelExpansion(e){this.sidePanelExpanded.has(e)?this.sidePanelExpanded.delete(e):this.sidePanelExpanded.add(e)}changeSetTableOptions(e){Object.assign(this.setTable,e)}changeElemTableOptions(e){Object.assign(this.elemTable,e)}closeToast(){this.toast=null}showToast(e){this.toast=e}toggleMenu(){this.menu=!this.menu}toggleTheme(){this.defaultTheme="dark"===this.defaultTheme?"light":"dark"}toggleZen(){this.zen=!this.zen}setVisXAttr(e){this.visXAttr=e||null}setVisYAttr(e){this.visYAttr=e||null}}(0,s.gn)([l.LO],o.prototype,"sidePanelExpanded",void 0),(0,s.gn)([l.LO],o.prototype,"menu",void 0),(0,s.gn)([l.LO],o.prototype,"zen",void 0),(0,s.gn)([l.LO],o.prototype,"defaultTheme",void 0),(0,s.gn)([l.LO],o.prototype,"setTable",void 0),(0,s.gn)([l.LO],o.prototype,"elemTable",void 0),(0,s.gn)([l.LO],o.prototype,"speedDial",void 0),(0,s.gn)([l.LO],o.prototype,"ref",void 0),(0,s.gn)([l.LO],o.prototype,"toast",void 0),(0,s.gn)([l.LO],o.prototype,"visXAttr",void 0),(0,s.gn)([l.LO],o.prototype,"visYAttr",void 0),(0,s.gn)([l.Fl],o.prototype,"theme",null),(0,s.gn)([l.aD],o.prototype,"setSpeedDial",null),(0,s.gn)([l.aD],o.prototype,"toggleSidePanelExpansion",null),(0,s.gn)([l.aD],o.prototype,"changeSetTableOptions",null),(0,s.gn)([l.aD],o.prototype,"changeElemTableOptions",null),(0,s.gn)([l.aD.bound],o.prototype,"closeToast",null),(0,s.gn)([l.aD],o.prototype,"showToast",null),(0,s.gn)([l.aD.bound],o.prototype,"toggleMenu",null),(0,s.gn)([l.aD.bound],o.prototype,"toggleTheme",null),(0,s.gn)([l.aD.bound],o.prototype,"toggleZen",null),(0,s.gn)([l.aD],o.prototype,"setVisXAttr",null),(0,s.gn)([l.aD],o.prototype,"setVisYAttr",null);var i=n(2674);const c=JSON.parse('[{"name":"Aegon Targaryen","episodes":0,"words":0,"sets":["royal","was killed","Targaryen"]},{"name":"Aeron Greyjoy","episodes":2,"words":206,"sets":["Greyjoy","male"]},{"name":"Aerys II Targaryen","episodes":0,"words":0,"sets":["royal","was killed","has killed","Targaryen"]},{"name":"Alton Lannister","episodes":3,"words":339,"sets":["was killed","Lannister","male"]},{"name":"Arya Stark","episodes":58,"words":6465,"sets":["has killed","Stark","female"]},{"name":"Balon Greyjoy","episodes":4,"words":809,"sets":["was killed","Greyjoy","male"]},{"name":"Baratheon Guard","episodes":0,"words":0,"sets":["Baratheon"]},{"name":"Benjen Stark","episodes":6,"words":633,"sets":["was killed","Stark","male"]},{"name":"Black Walder Rivers","episodes":4,"words":173,"sets":["was killed","has killed","Frey","male"]},{"name":"Bran Stark","episodes":38,"words":3260,"sets":["royal","Stark","male"]},{"name":"Brandon Stark","episodes":0,"words":0,"sets":["was killed","Stark"]},{"name":"Brynden Tully","episodes":6,"words":762,"sets":["Tully","male"]},{"name":"Catelyn Stark","episodes":25,"words":3496,"sets":["was killed","has killed","Stark","Tully","female"]},{"name":"Cersei Lannister","episodes":60,"words":15234,"sets":["royal","was killed","has killed","Lannister","Baratheon","female"]},{"name":"Daenerys Targaryen","episodes":61,"words":12560,"sets":["royal","was killed","has killed","Targaryen","female"]},{"name":"Doran Martell","episodes":5,"words":526,"sets":["was killed","Martell","male"]},{"name":"Drogon","episodes":0,"words":0,"sets":["has killed","Targaryen","male"]},{"name":"Eddard Stark","episodes":11,"words":3511,"sets":["was killed","has killed","Stark","male"]},{"name":"Edmure Tully","episodes":7,"words":684,"sets":["Tully","male"]},{"name":"Elia Martell","episodes":0,"words":0,"sets":["royal","was killed","Martell"]},{"name":"Ellaria Sand","episodes":12,"words":805,"sets":["has killed","Martell","female"]},{"name":"Euron Greyjoy","episodes":9,"words":1328,"sets":["was killed","has killed","Greyjoy","male"]},{"name":"Gendry","episodes":21,"words":1894,"sets":["has killed","Baratheon","male"]},{"name":"Ghost","episodes":0,"words":0,"sets":["has killed","Stark","male","direwolf"]},{"name":"Grey Wind","episodes":0,"words":0,"sets":["was killed","has killed","Stark","male","direwolf"]},{"name":"Hoster Tully","episodes":0,"words":0,"sets":["Tully","male"]},{"name":"Jaime Lannister","episodes":53,"words":11728,"sets":["was killed","has killed","Lannister","male"]},{"name":"Jeor Mormont","episodes":12,"words":1601,"sets":["was killed","Mormont","male"]},{"name":"Joffrey Baratheon","episodes":21,"words":3303,"sets":["royal","was killed","has killed","Baratheon","male"]},{"name":"Jon Snow","episodes":60,"words":12592,"sets":["royal","was killed","has killed","Stark","Targaryen","male"]},{"name":"Jorah Mormont","episodes":49,"words":4806,"sets":["was killed","has killed","Mormont","male"]},{"name":"Kevan Lannister","episodes":9,"words":492,"sets":["was killed","Lannister","male"]},{"name":"Kitty Frey","episodes":0,"words":0,"sets":["Frey","female"]},{"name":"Lady","episodes":0,"words":0,"sets":["was killed","Stark","female","direwolf"]},{"name":"Lancel Lannister","episodes":13,"words":752,"sets":["was killed","Lannister","male"]},{"name":"Loras Tyrell","episodes":15,"words":1093,"sets":["was killed","Tyrell","male"]},{"name":"Lothar Frey","episodes":4,"words":163,"sets":["was killed","has killed","Frey","male"]},{"name":"Lyanna Mormont","episodes":8,"words":565,"sets":["was killed","has killed","Mormont","female"]},{"name":"Lyanna Stark","episodes":1,"words":63,"sets":["was killed","Stark","female"]},{"name":"Lysa Arryn","episodes":5,"words":1320,"sets":["was killed","has killed","Arryn","Tully","female"]},{"name":"Mace Tyrell","episodes":10,"words":483,"sets":["was killed","Tyrell","male"]},{"name":"Maester Aemon","episodes":11,"words":1350,"sets":["was killed","Targaryen","male"]},{"name":"Margaery Tyrell","episodes":25,"words":3534,"sets":["was killed","Tyrell","female"]},{"name":"Martyn Lannister","episodes":2,"words":43,"sets":["was killed","Lannister","male"]},{"name":"Myrcella Baratheon","episodes":7,"words":277,"sets":["royal","was killed","Baratheon","female"]},{"name":"Ned Umber","episodes":2,"words":21,"sets":["was killed","Umber","male"]},{"name":"Nymeria","episodes":0,"words":0,"sets":["Stark","female","direwolf"]},{"name":"Nymeria Sand","episodes":7,"words":147,"sets":["was killed","Martell","female"]},{"name":"Obara Sand","episodes":7,"words":212,"sets":["was killed","has killed","Martell","female"]},{"name":"Oberyn Martell","episodes":7,"words":1912,"sets":["was killed","Martell","male"]},{"name":"Olenna Tyrell","episodes":18,"words":3924,"sets":["was killed","has killed","Tyrell","female"]},{"name":"Ramsay Snow","episodes":20,"words":3329,"sets":["was killed","has killed","Bolton","male"]},{"name":"Renly Baratheon","episodes":8,"words":1400,"sets":["was killed","Baratheon","male"]},{"name":"Rhaegal","episodes":0,"words":0,"sets":["was killed","has killed","Targaryen","male"]},{"name":"Rhaegar Targaryen","episodes":1,"words":23,"sets":["royal","was killed","Targaryen","male"]},{"name":"Rhaella Targaryen","episodes":0,"words":0,"sets":["royal","Targaryen"]},{"name":"Rhaenys Targaryen","episodes":0,"words":0,"sets":["royal","was killed","Targaryen"]},{"name":"Rickard Stark","episodes":1,"words":27,"sets":["was killed","Stark","male"]},{"name":"Rickon Stark","episodes":7,"words":124,"sets":["was killed","Stark","male"]},{"name":"Robb Stark","episodes":21,"words":3920,"sets":["royal","was killed","has killed","Stark","male"]},{"name":"Robert Baratheon","episodes":7,"words":2608,"sets":["royal","was killed","has killed","Baratheon","male"]},{"name":"Roose Bolton","episodes":19,"words":2036,"sets":["was killed","has killed","Bolton","male"]},{"name":"Roslin Frey","episodes":1,"words":33,"sets":["Frey","female"]},{"name":"Sansa Stark","episodes":59,"words":8937,"sets":["royal","Stark","female"]},{"name":"Selyse Baratheon","episodes":7,"words":585,"sets":["was killed","has killed","Baratheon","female"]},{"name":"Shaggydog","episodes":0,"words":0,"sets":["was killed","Stark","male","direwolf"]},{"name":"Shireen Baratheon","episodes":8,"words":1046,"sets":["was killed","Baratheon","female"]},{"name":"Stannis Baratheon","episodes":24,"words":3607,"sets":["was killed","has killed","Baratheon","male"]},{"name":"Stevron Frey","episodes":1,"words":7,"sets":["Frey","male"]},{"name":"Summer","episodes":0,"words":0,"sets":["was killed","has killed","Stark","male","direwolf"]},{"name":"Talla Tarly","episodes":1,"words":79,"sets":["Tarly","female"]},{"name":"Theon Greyjoy","episodes":44,"words":5363,"sets":["was killed","has killed","Greyjoy","male"]},{"name":"Tommen Baratheon","episodes":14,"words":1400,"sets":["royal","was killed","has killed","Baratheon","male"]},{"name":"Trystane Martell","episodes":4,"words":109,"sets":["was killed","Martell","male"]},{"name":"Tyene Sand","episodes":7,"words":201,"sets":["was killed","has killed","Martell","female"]},{"name":"Tyrion Lannister","episodes":66,"words":27655,"sets":["has killed","Lannister","male"]},{"name":"Tywin Lannister","episodes":26,"words":5964,"sets":["was killed","Lannister","male"]},{"name":"Viserion","episodes":0,"words":0,"sets":["was killed","has killed","Targaryen","male"]},{"name":"Viserys Targaryen","episodes":5,"words":1177,"sets":["royal","was killed","Targaryen","male"]},{"name":"Walda Bolton","episodes":0,"words":0,"sets":["was killed","Bolton","Frey","female"]},{"name":"Walder Frey","episodes":6,"words":1648,"sets":["was killed","Frey","male"]},{"name":"Willem Lannister","episodes":1,"words":4,"sets":["was killed","Lannister","male"]},{"name":"Yara Greyjoy","episodes":14,"words":1829,"sets":["Greyjoy","female"]}]').map((e=>({name:e.name,sets:e.sets,attrs:{words:e.words,episodes:e.episodes}}))),m=(0,i.Y2)(c),d={id:"got",name:"Game of Thrones Characters",description:"Game of Thrones characters data from https://github.com/ jeffreylancaster/game-of-thrones",author:"Samuel Gratzl",attrs:["words","episodes"],setCount:m.length,load:()=>Promise.resolve({sets:m,elems:c})},u=JSON.parse('[{"name":"Alton Lannister","sets":["was killed","Lannister","male"]},{"name":"Arya Stark","sets":["Stark","female"]},{"name":"Benjen Stark","sets":["was killed","Stark","male"]},{"name":"Bran Stark","sets":["royal","Stark","male"]},{"name":"Brandon Stark","sets":["was killed","Stark"]},{"name":"Catelyn Stark","sets":["was killed","Stark","female"]},{"name":"Cersei Lannister","sets":["royal","was killed","Lannister","female"]},{"name":"Eddard Stark","sets":["was killed","Stark","male"]},{"name":"Jaime Lannister","sets":["was killed","Lannister","male"]},{"name":"Jon Snow","sets":["royal","was killed","Stark","male"]},{"name":"Kevan Lannister","sets":["was killed","Lannister","male"]},{"name":"Lancel Lannister","sets":["was killed","Lannister","male"]},{"name":"Lyanna Stark","sets":["was killed","Stark","female"]},{"name":"Martyn Lannister","sets":["was killed","Lannister","male"]},{"name":"Rickard Stark","sets":["was killed","Stark","male"]},{"name":"Rickon Stark","sets":["was killed","Stark","male"]},{"name":"Robb Stark","sets":["royal","was killed","Stark","male"]},{"name":"Sansa Stark","sets":["royal","Stark","female"]},{"name":"Tyrion Lannister","sets":["Lannister","male"]},{"name":"Tywin Lannister","sets":["was killed","Lannister","male"]},{"name":"Willem Lannister","sets":["was killed","Lannister","male"]}]').map((e=>({name:e.name,sets:e.sets,attrs:{}}))),p=(0,i.Y2)(u),y={id:"got_small",name:"Game of Thrones Characters (small)",description:"Game of Thrones characters data from https://github.com/ jeffreylancaster/game-of-thrones",author:"Samuel Gratzl",attrs:[],setCount:p.length,load:()=>Promise.resolve({sets:p,elems:u})};var h=n(8254);function f(e){const t=new URL(e);return fetch(`https://cors-anywhere.herokuapp.com/${e}`,{headers:{Origin:`${t.protocol}://${t.hostname}`}})}const g="https://vcg.github.io/upset/",x="https://vdl.sci.utah.edu/upset2";function b(){return function(e=`${g}/datasets.json`,t=g){return(0,s.mG)(this,void 0,void 0,(function*(){return(yield f(e).then((e=>e.json()))).map((e=>f(`${t}/${e}`).then((e=>e.json())).then((e=>(e.file=e.file.startsWith("https")?e.file:`${t}/${e.file}`,function(e){var t,n,a;return{id:(a=e.name,a.replace(/[(); \-{}~%$^&@#]+/g," ").trim().split(" ").map((e=>e.slice(0,2))).join("")),name:e.name,description:null!==(t=e.description)&&void 0!==t?t:"",author:null!==(n=e.author)&&void 0!==n?n:"",attrs:e.meta.filter((e=>"float"===e.type||"integer"===e.type)).map((e=>e.name)),setCount:e.sets.length>0?e.sets[0].end-e.sets[0].start+1:void 0,load:()=>(0,s.mG)(this,void 0,void 0,(function*(){const t=yield function(e){var t,n;return(0,s.mG)(this,void 0,void 0,(function*(){const a=yield f(e.file).then((e=>e.text())),r=(0,h.parse)(a,{delimiter:e.separator,skipEmptyLines:!0}),s={start:e.sets[0].start,end:e.sets[0].end+1},l=null!==(n=null===(t=e.meta.find((e=>"id"===e.type)))||void 0===t?void 0:t.index)&&void 0!==n?n:0,o=r.data,i=o[e.skip+e.header],c=o.slice(e.skip+e.header+1),m=i.slice(s.start,s.end);return c.map((t=>{const n=t.slice(s.start,s.end).map(((e,t)=>[e,m[t]])).filter((([e,t])=>"1"===e)).map((([e,t])=>t)),a={};return e.meta.filter((e=>"float"===e.type||"integer"===e.type)).forEach((e=>{a[e.name]=Number.parseFloat(t[e.index])})),{name:t[l],sets:n,attrs:a}}))}))}(e);return{elems:t,sets:(0,i.Y2)(t)}}))}}(e))))))}))}(`${x}/data/datasets.json`,x)}function v(e,t,n=!1){return e.map((e=>{if(0===t.length)return e.name;if(n)return[e.name].concat(t.map((t=>e.attrs[t])));const a={name:e.name};return t.forEach((t=>a[t]=e.attrs[t])),a}))}function w(e){const t=new Map(e.map(((e,t)=>[e,t])));return e=>t.get(e)}function $(e,t={}){var n,a;let r=e.elems;const s=0===e.combinationsOptions.min,l=t.all?e.sortedSets:e.visibleSets;if(!s){const e=new Set(l.map((e=>e.elems)).flat());r=r.filter((t=>e.has(t)))}const o=w(r),i=w(l),c=w(e.visibleCombinations),m=null!==(a=null===(n=e.dataset)||void 0===n?void 0:n.attrs)&&void 0!==a?a:[],d=t.all?m:m.filter((t=>e.selectedAttrs.has(t)));return{all:s,sets:l,elems:v(r,d,t.maxCompress),attrs:d,toElemIndex:o,toSetIndex:i,toCombinationIndx:c,toSetRef:e=>({type:e.type,index:"set"===e.type?i(e):c(e)})}}var S=n(5337),E=n(9336);function k(e,t={}){var n;const a=$(e,t),r=e.dataset,s=(0,i.yn)({sets:a.sets,queries:e.visibleQueries,toElemIndex:a.toElemIndex,selection:e.selection||void 0,combinations:e.visibleCombinations,combinationOptions:(0,l.ZN)(e.combinationsOptions)},{compress:null!==(n=t.compress)&&void 0!==n?n:"auto"});return Object.assign({},(0,E.toUpSetJSDump)(s,(0,l.ZN)(a.elems),(0,l.ZN)(e.props),r.author),{name:r.name,description:r.description,author:r.author,attrs:(0,l.ZN)(a.attrs)})}function C(e,t={}){var n;const a=e.dataset,r=(0,i.mH)({sets:e.visibleSets,combinations:e.visibleCombinations,selection:null!==(n=e.selection)&&void 0!==n?n:void 0,queries:e.visibleQueries},t);return Object.assign({},(0,E.toUpSetJSStaticDump)(r,(0,l.ZN)(e.props),a.author),{name:a.name,description:a.description,author:a.author})}const O=4096;function N(e,t){var n;return{id:t,name:e.name,author:null!==(n=e.author)&&void 0!==n?n:"Unknown",description:e.description,creationDate:new Date,attrs:e.attrs,setCount:e.sets.length,load:()=>{const t=function(e,t){return e.map((e=>{var n;if("string"==typeof e||"number"==typeof e)return{name:String(e),attrs:{}};const a=null!==(n=e.attrs)&&void 0!==n?n:{};return Array.isArray(e)?(t.forEach(((t,n)=>a[t]=e[n+1])),{name:e[0],attrs:a}):(t.forEach((t=>{void 0!==e[t]&&(a[t]=e[t])})),{name:e.name,attrs:a})}))}(e.elements,e.attrs),n=e.sets.map((e=>(0,i.jM)(Object.assign(Object.assign({},e),{elems:(0,i.RT)(e.elems,t)}))));return Promise.resolve({elems:t,sets:n,props:e.props,combinations:e.combinationOptions,queries:e.queries})}}}function A(e,t){const n=e.map(((e,t)=>Object.assign({},{name:t.toString(),attrs:{}},e))),a=(0,i.Y2)(n);return{id:t,name:t,author:"Unknown",description:"",creationDate:new Date,attrs:[],setCount:a.length,load:()=>Promise.resolve({elems:n,sets:a,props:{},combinations:{},queries:[]})}}function M(e){return"string"==typeof e?(t=e,fetch(`https://cors-anywhere.herokuapp.com/${t}`).then((e=>e.json()))).then((t=>{const n=e.includes("/")?e.slice(e.lastIndexOf("/")+1):e;return"https://upset.js.org/schema.1.0.0.json"===t.$schema?N(t,n):A(t,n)})):function(e){return new Promise(((t,n)=>{const a=new FileReader;a.addEventListener("load",(()=>{const e=JSON.parse(a.result);t(e)})),a.addEventListener("error",(()=>{n(a.error)})),a.readAsText(e)}))}(e).then((t=>"https://upset.js.org/schema.1.0.0.json"===t.$schema?N(t,e.name):A(t,e.name)));var t}let L=null;function j(){return L?Promise.resolve(L):n.e(366).then(n.bind(n,366)).then((e=>{class t extends e.default{constructor(){super("UpSet.js App DB"),Object.defineProperty(this,"datasets",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.version(1).stores({datasets:"++uid,id,name,creationDate"}),this.datasets=this.datasets||void 0}}return new t})).then((e=>L=e))}function T(e){const t=N(e,String(e.uid));return t.uid=e.uid,t.creationDate=new Date(e.creationDate),t}function Z(e){return e.sort(((e,t)=>t.creationDate-e.creationDate))}var P=n(8105);const q={hinges:P.HV,fivenum:P.Jc,type7:P.Du,quantiles:P.Du,linear:P.sZ,lower:P.E5,higher:P.kE,nearest:P.HT,midpoint:P.X_};function D(e,t={}){const n=Object.assign({},t,{quantiles:"function"==typeof t.quantiles||null==t.quantiles?t.quantiles:q[t.quantiles]});return null==n.quantiles&&delete n.quantiles,(0,P.ZP)(e,n)}function z(e){const t=e[1]-e[0];return n=>n*t+e[0]}function I(e){const t=e[1]-e[0];return n=>(n-e[0])/t}function B(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n}function R(e){return Math.round(100*e)/100}const F=e=>e.toFixed(2);function _(e,t){return`Min: ${t(e.min)}, 25% Quantile: ${t(e.q1)}, Median: ${t(e.median)}, 75% Quantile: ${t(e.q3)}, Max: ${t(e.max)}`}const H=e=>{const{theme:t="light",mode:n="normal",boxStyle:a,lineStyle:s,outlierStyle:l,margin:o=0,boxPadding:i=.1,outlierRadius:c=3,numberFormat:m=F}=e,d=B(e,["theme","mode","boxStyle","lineStyle","outlierStyle","margin","boxPadding","outlierRadius","numberFormat"]),u=Array.isArray(e.values)?D(e.values,d):e.values;if(Number.isNaN(u.median))return r.createElement("g",null);const p="vertical"!==e.orient,y=I([e.min,e.max]),h=z([0,p?e.width:e.height]),f=e=>R(h(y(e))),g={max:f(u.max),avg:f(u.mean),med:f(u.median),min:f(u.min),q1:f(u.q1),q3:f(u.q3),wh:f(u.whiskerHigh),wl:f(u.whiskerLow)},x=!1!==e.tooltips&&r.createElement("title",null,_(u,m)),b=(0,E.getDefaultTheme)(t).notMemberColor,v={box:Object.assign({fill:b},a),line:Object.assign({fill:"none",stroke:"light"===t?"black":"#cccccc"},s),outlier:Object.assign({fill:b},l)};if(p){const t=e.height/2,a=R(e.height*i)+o,s=e.height-a,l=`M${g.wl},${o} l0,${e.height-2*o} M${g.wl},${t} L${g.q1},${t}`,d=`M${g.q3},${t} L${g.wh},${t} M${g.wh},${o} L${g.wh},${e.height-o}`,p=`M${g.q1},${a} L${g.q3},${a} L${g.q3},${s} L${g.q1},${s} L${g.q1},${a} M${g.med},${a} l0,${s-a}`,y=r.createElement("path",{d:`${l} ${d} ${p}`,style:v.line});return"indicator"===n?y:r.createElement("g",null,x,"normal"===n&&r.createElement("rect",{x:g.q1,y:a,width:g.q3-g.q1,height:e.height-2*a,style:v.box}),y,u.outlier.map((e=>r.createElement("circle",{key:e,r:c,cy:t,cx:f(e),style:v.outlier},r.createElement("title",null,"$",m(e))))))}{const t=e.width/2,a=R(e.width*i)+o,s=e.width-a,l=`M${o},${g.wl} l${e.width-2*o},0 M${t},${g.wl} L${t},${g.q1}`,d=`M${t},${g.q3} L${t},${g.wh} M${o},${g.wh} L${e.width-o},${g.wh}`,p=`M${a},${g.q1} L${a},${g.q3} l${s-a},0 L${s},${g.q1} L${a},${g.q1} M${a},${g.med} l${s-a},0`,y=r.createElement("path",{d:`${l} ${d} ${p}`,style:v.line});return"indicator"===n?y:r.createElement("g",null,x,"normal"===n&&r.createElement("rect",{y:g.q1,x:a,height:g.q3-g.q1,width:e.width-2*a,style:v.box}),y,u.outlier.map((e=>r.createElement("circle",{key:e,r:c,cx:t,cy:f(e),style:v.outlier},r.createElement("title",null,"$",m(e))))))}},K=r.memo(H);function J(e,t,n={}){var{size:a=100,position:s,name:l=e.toString()}=n,o=B(n,["size","position","name"]);const i="function"==typeof e?e:t=>t[e];let c=Number.POSITIVE_INFINITY,m=Number.NEGATIVE_INFINITY;if(Array.isArray(t))t.forEach((e=>{const t=i(e);null==t||Number.isNaN(t)||(t<c&&(c=t),t>m&&(m=t))}));else{const e=t;c=e.min,m=e.max}const d=function(e,t,n="horizontal"){const a=I(e),r=z(e),s=z(t),l=e=>s(a(e)),o="horizontal"===n?5:7;return l.ticks=(e=o)=>Array(e).fill(0).map(((t,n)=>{const a=r(n/(e-1));return{value:a,label:a.toFixed(2)}})),l.tickFormat=()=>e=>e.toFixed(2),l}([c,m],[0,a],o.orient);return{name:l,position:s,size:a,scale:d,createOnHandlerData:e=>{const t=D(e.elems.map(i),o);return{id:"boxplot",name:l,value:Object.assign(Object.assign(Object.assign({},t),{toString(){var e;return _(this,null!==(e=o.numberFormat)&&void 0!==e?e:F)}}),t)}},render:({width:e,height:t,set:n,theme:a})=>{const s=n.elems.map(i);return r.createElement(K,Object.assign({values:s,width:e,height:t,min:c,max:m,theme:a},o))},renderSelection:({width:e,height:t,overlap:n,selectionColor:a,theme:s})=>{if(null==n||0===n.length)return null;const l=n.map(i);return r.createElement(K,Object.assign({values:l,width:e,height:t,min:c,max:m,mode:"box",lineStyle:{stroke:a,strokeWidth:2},outlierStyle:{fill:a},theme:s},o))},renderQuery:({width:e,height:t,overlap:n,query:a,secondary:s,index:l,theme:d})=>{if(null==n||0===n.length)return null;const u=n.map(i);return r.createElement(K,Object.assign({values:u,width:e,height:t,min:c,max:m,mode:s?"indicator":"box",margin:s?l+2:0,lineStyle:{stroke:a.color,strokeWidth:s?1:2},outlierStyle:{fill:a.color},theme:d},o))}}}function U(e,t,n){const a=function(e,t){const n="function"==typeof e?e:t=>t[e],a="asc"===t?1:-1;return(e,t)=>{const r=n(e),s=n(t);return r===s?0:r<s?-a:a}}(t,n),r=e.map(((e,t)=>({v:e,i:t})));return r.sort(((e,t)=>{const n=a(e.v,t.v);return 0!==n?n:e.i-t.i})),r.map((e=>e.v))}var G=n(2527);function V(e,t){const n={};return e.forEach((e=>n[e]=t[e])),n}function W(e,t){return null!=e?e.toString():t.toString()}function Q(e){const t=function(e){let t="";return t="string"==typeof e?e.includes("/")?e.slice(e.lastIndexOf("/")+1):e:e.name,t.includes(".")?t.slice(0,t.lastIndexOf(".")):t}(e);return new Promise((n=>{(0,h.parse)(e,{download:"string"==typeof e,dynamicTyping:!0,header:!0,skipEmptyLines:!0,complete(e){const a=e.meta.fields,r=function(e){const t=e.map((e=>e.toLowerCase()));return t.includes("name")?e[t.indexOf("name")]:t.includes("id")?e[t.indexOf("id")]:e[0]}(a),s=function(e,t){return t.filter((t=>e.every((e=>function(e){if(""===e||null==e)return!0;if("number"==typeof e)return 1===e||0===e;if("string"==typeof e){const t=e.toLowerCase();return"t"===t||"f"===t||"true"===t||"false"===t}return!1}(e[t])))))}(e.data,a),l=function(e,t){return t.filter((t=>e.every((e=>"number"==typeof e[t]))))}(e.data,a.filter((e=>!s.includes(e)&&e!==r)));n({id:t,name:t,creationDate:new Date,author:"User",description:`imported from ${t}`,attrs:l,load:()=>{const t=e.data.map(((e,t)=>({name:W(e[r],t),sets:s.filter((t=>function(e){if(""===e||null==e)return!1;if("number"==typeof e)return 1===e;if("string"==typeof e){const t=e.toLowerCase();return"t"===t||"true"===t}return!1}(e[t]))),attrs:V(l,e)})));return Promise.resolve({elems:t,sets:(0,i.Y2)(t)})}})}})}))}function X(e){return e.replace(/([A-Z])/gm,(e=>`.${e.toLowerCase()}`))}function Y(e){return"string"==typeof e?`"${e}"`:`c(${e.map(Y).join(", ")})`}function ee(e){return e.replace(/([A-Z])/gm,(e=>`_${e.toLowerCase()}`))}const te='<div id="app"></div>',ne="#app {\n  width: 100vw;\n  height: 100vh;\n}";function ae(e,t="UpSetJS."){const n=$(e);function a(e){return`${t}fromIndicesArray(${JSON.stringify((0,i.nz)(Array.from(e),n.toElemIndex,{sortAble:!0})).replace(/"/gm,"'")}, elems)`}const r=e.visibleSets.map((e=>a(e.elems))),s=e.visibleSets.map(((e,n)=>function(e,t){return t.color&&(e.color=t.color),e}({name:e.name,elems:`CC${t}fromIndicesArray(${JSON.stringify(r[n]).replace(/"/gm,"'")}, elems)CC`},e))),o=e.visibleQueries.some(i.DR)||(0,i.vK)(e.selection),c=e=>{const t=n.toSetRef(e);return`fromSetRef({ type: '${t.type}', index: ${t.index} })`},m=n.attrs.length>0?`\n  setAddons: ${JSON.stringify(n.attrs.map((e=>`CC${t}boxplotAddon((v) => v['${e}'], elems, { name: '${e}' })CC`)))},\n  combinationAddons: ${JSON.stringify(n.attrs.map((e=>`CC${t}boxplotAddon((v) => v['${e}'], elems, { orient: 'vertical', name: '${e}' })CC`)))}`:"",d=`\nconst root = document.getElementById("app");\nconst sets = ${t}asSets(${JSON.stringify((0,l.ZN)(s),null,2)});\n\nconst combinations = ${t}generateCombinations(sets, ${JSON.stringify(Object.assign(Object.assign({},e.combinationsOptions),{elems:"CCelemsCC"}),null,2)});\n\n${o?'function fromSetRef(ref) {\n  if (ref.type === "set") {\n    return sets[ref.index];\n  }\n  return combinations[ref.index];\n}':""}\n\nlet selection = ${e.selection?function(t){if(Array.isArray(t))return a(t);const n=t;return"set"===n.type?c(n):e.visibleCombinations.findIndex((e=>e.name===n.name&&e.type===n.type))<0?a(n.elems):c(n)}(e.selection):null};\nconst queries = ${JSON.stringify(e.visibleQueries.map((function(t){if((0,i.AX)(t))return{name:t.name,color:t.color,elems:`CC${a(t.elems)}CC`};const n=t.set;return"set"===n.type?{name:t.name,color:t.color,set:`CC${c(n)}CC`}:e.visibleCombinations.findIndex((e=>e.name===n.name&&e.type===n.type))<0?{name:t.name,color:t.color,elems:`CC${a(n.elems)}CC`}:{name:t.name,color:t.color,set:`CC${c(n)}CC`}})),null,2)};\n\nconst props = Object.assign({\n  width: root.clientWidth,\n  height: root.clientHeight,\n}, {\n  sets: sets,\n  combinations: combinations,\n  selection: selection,\n  queries: queries,${m}\n}, ${JSON.stringify(me(e.props,e.ui.theme),null,2)});\n\nfunction update() {\n  ${t}render(root, props);\n}\n\n// uncomment for interactivity\nprops.onHover = (s) => {\n  props.selection = s;\n  update();\n}\n//props.onClick = (s) => {\n//  console.log(s);\n//}\n\nupdate();\n\n`.replace(/"CC/gm,"").replace(/CC"/gm,"");return{elems:(0,l.ZN)(n.elems),js:d}}function re(e){const{elems:t,js:n}=ae(e);return{html:`${te}\n<script id="data" type="application/json">\n${JSON.stringify(t)}\n<\/script>\n`,js:`const elems = JSON.parse(document.getElementById("data").textContent);\n${n}`}}const se=[G.Z[0],...G.Z.slice(2)],le=se.shift(),oe=["selectionColor","color","textColor","hoverHintColor","notMemberColor","alternatingBackgroundColor","hasSelectionColor","opacity","hasSelectionColor"],ie=["padding","barPadding","dotPadding","widthRatios","heightRatios","fontSizes","combinationName","setName","barLabelOffset","setNameAxisOffset","combinationNameAxisOffset","theme","fontFamily","numericScale","bandScale",""];function ce(e,t){const n=(0,E.fillDefaults)({theme:t,width:100,height:100,sets:[]}),a={};for(const t of e)a[t]=n[t];return a}function me(e,t){const n=ce(oe.concat(ie),t),a=(e,t)=>{const n={};for(const a of Object.keys(e)){const r=t[a],s=e[a];r!==s&&(n[a]=s)}return n},r=a(e,n);if(r.fontSizes){const e=a(r.fontSizes,n.fontSizes);0===Object.keys(e).length?delete r.fontSizes:r.fontSizes=e}return Array.isArray(r.heightRatios)&&r.heightRatios.every(((e,t)=>e===n.heightRatios[t]))&&delete r.heightRatios,Array.isArray(r.widthRatios)&&r.widthRatios.every(((e,t)=>e===n.widthRatios[t]))&&delete r.widthRatios,r}class de{constructor(e,t){Object.defineProperty(this,"q",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"visible",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.q=e,this.visible=t}}(0,s.gn)([l.LO.ref],de.prototype,"q",void 0),(0,s.gn)([l.LO],de.prototype,"visible",void 0);class ue{constructor(){Object.defineProperty(this,"ui",{enumerable:!0,configurable:!0,writable:!0,value:new o}),Object.defineProperty(this,"datasets",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"dataset",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"sets",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"elems",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"props",{enumerable:!0,configurable:!0,writable:!0,value:ce(oe.concat(ie),this.ui.theme)}),Object.defineProperty(this,"hover",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"selection",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"queries",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"selectedAttrs",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"combinationsOptions",{enumerable:!0,configurable:!0,writable:!0,value:{type:"intersection",min:1,max:5,empty:!1,limit:100,order:["cardinality","name"]}}),Object.defineProperty(this,"selectedSets",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),(0,l.rC)(this),this.appendDatasets([d,y]),this.ui.showToast({severity:"info",message:"Preparing Datasets..."}),Promise.all([j().then((e=>e.datasets.toArray())).then(Z).then((e=>e.map(T))).then((e=>this.appendDatasets(e))),b().then((e=>{e.forEach((e=>e.then((e=>this.appendDatasets([e])))))}))]).then((()=>{this.ui.closeToast(),this.syncHistory()})),(0,l.EH)((()=>{Object.assign(this.props,ce(oe.concat(ie),this.ui.theme))})),(0,l.EH)((()=>{document.title=this.title}))}syncHistory(){const e=(e=!1)=>{var t;const n=new URL(window.location.href);if(n.searchParams.has("ds")){const a=decodeURIComponent(n.searchParams.get("ds"));e&&a.startsWith("http")?this.importFile(a):(null===(t=this.dataset)||void 0===t?void 0:t.id)!==a&&this.selectDataSet(a)}},t=e.bind(this,!1);window.addEventListener("popstate",t),e(!0),(0,l.EH)((()=>{const e=new URLSearchParams;this.dataset&&e.set("ds",encodeURIComponent(this.dataset.id)),e.sort();const n=new URL(window.location.href);n.searchParams.toString()!==e.toString()&&(n.search=`?${e.toString()}`,window.removeEventListener("popstate",t),window.history.pushState(null,"",n.toString()),window.addEventListener("popstate",t))}))}resetProps(){Object.assign(this.props,ce(oe.concat(ie),this.ui.theme))}appendDatasets(e){e.length<=0||(this.datasets.push(...e),this.sortDatasets(),this.datasets.length>0&&!this.dataset&&this.loadDataSet(this.datasets[0]))}sortDatasets(){this.datasets=this.datasets.slice().sort(((e,t)=>"got"===e.id?-1:"got"===t.id?1:e.name.localeCompare(t.name)))}selectDataSet(e){var t;const n=null!==(t=this.datasets.find((t=>t.id===e)))&&void 0!==t?t:null;this.loadDataSet(n)}pushDataSet(e){this.datasets.push(e),this.sortDatasets(),this.dataset=e,this.loadDataSet(e,(()=>{(function(e){const t=Object.assign({creationDate:Date.now()},k(e,{all:!0}));return t.name=`${t.name} - Local`,j().then((e=>e.datasets.add(t))).then((e=>T(Object.assign(t,{uid:e}))))})(this).then((t=>{this.dataset=t,this.datasets.splice(this.datasets.indexOf(e),1,t)}))})),this.ui.showToast({severity:"success",message:"Data set loaded"})}deleteDataSet(e){e.uid&&function(e){return j().then((t=>t.transaction("rw",t.datasets,(()=>Promise.all([t.datasets.where("uid").equals(e.uid).delete()])))))}(e).then((()=>(0,l.z)((()=>{this.datasets.splice(this.datasets.indexOf(e),1),this.dataset===e&&this.loadDataSet(this.datasets[0]),this.ui.showToast({severity:"success",message:"Data set deleted"})}))))}loadDataSet(e,t){this.dataset=e,this.sets=[],this.elems=[],this.selectedSets=new Set,this.selectedAttrs=new Set(e?e.attrs.slice(0,1):[]),this.ui.visXAttr=null,this.ui.visYAttr=null,this.hover=null,this.selection=null,this.queries.splice(0,this.queries.length),this.dataset&&this.dataset.load().then((e=>(0,l.z)((()=>{var n,a;this.sets=e.sets,this.elems=e.elems,Object.assign(this.props,null!==(n=e.props)&&void 0!==n?n:{}),Object.assign(this.combinationsOptions,null!==(a=e.combinations)&&void 0!==a?a:{}),this.selectedSets=new Set(this.sortedSets.slice(0,5).map((e=>e.name))),t&&t()}))))}setHover(e,t){if(!(e&&this.selection&&t&&t.ctrlKey&&(0,i.vK)(e)&&(0,i.vK)(this.selection)))return void(this.hover=e);const n=new Set;if("set"===e.type?n.add(e):e.sets.forEach((e=>n.add(e))),"set"===this.selection.type?n.add(this.selection):(0,i.vK)(this.selection)&&this.selection.sets.forEach((e=>n.add(e))),1===n.size)return void(this.hover=e);const a=this.visibleCombinations.find((e=>e.degree===n.size&&Array.from(e.sets).every((e=>n.has(e)))));this.hover=a||e}setSelection(e){this.selection=e}get visibleSets(){return this.sortedSets.filter((e=>this.selectedSets.has(e.name)))}get visibleVennSets(){return this.visibleSets.slice(0,Math.min(this.visibleSets.length,5))}get visibleSetAddons(){return this.dataset?this.dataset.attrs.filter((e=>this.selectedAttrs.has(e))).map((e=>J((t=>t.attrs[e]),this.elems,{name:e}))):[]}get visibleCombinationAddons(){return this.dataset?this.dataset.attrs.filter((e=>this.selectedAttrs.has(e))).map((e=>J((t=>t.attrs[e]),this.elems,{orient:"vertical",name:e}))):[]}get sortedSelectedElems(){if(!this.selection)return[];const e=this.ui.elemTable.orderBy;return U((0,i.vK)(this.selection)?this.selection.elems:this.selection,e.startsWith("attrs")?t=>t.attrs[e.slice(6)]:e,this.ui.elemTable.order)}get sortedSets(){return U(this.sets,this.ui.setTable.orderBy,this.ui.setTable.order)}setSelectedSets(e){this.selectedSets=e}setSelectedAttrs(e){this.selectedAttrs=e}get visibleCombinations(){return(0,i.Qv)(this.visibleSets,Object.assign({elems:this.elems},this.combinationsOptions))}changeCombinations(e){Object.assign(this.combinationsOptions,e)}changeProps(e){Object.assign(this.props,e),e.theme&&Object.assign(this.props,function(e){const t=(0,E.fillDefaults)({theme:e,width:100,height:100,sets:[]}),n={};for(const e of oe)n[e]=t[e];return n}(e.theme))}changeFontSize(e){this.props.fontSizes=Object.assign({},this.props.fontSizes,e)}get visibleQueries(){return this.queries.filter((e=>e.visible)).map((e=>e.q))}get queriesAndSelection(){const e=this.visibleQueries;return this.selection?[(0,i.vK)(this.selection)?{name:this.selection.name,color:le,set:this.selection}:{name:"Array",color:le,elems:this.selection}].concat(e):e}deleteQuery(e){const t=this.queries.findIndex((t=>t.q===e));t>=0&&(this.queries.splice(t,1),se.unshift(e.color))}persistSelection(){this.selection&&(this.queries.push(new de((0,i.vK)(this.selection)?{name:this.selection.name,color:se.length>0?se.shift():"grey",set:this.selection}:{name:"Array",color:se.length>0?se.shift():"grey",elems:this.selection},!0)),this.selection=null)}toggleQueryVisibility(e){const t=this.queries.find((t=>t.q===e));t&&(t.visible=!t.visible)}get title(){var e,t;return`UpSet.js - ${null!==(t=null===(e=this.dataset)||void 0===e?void 0:e.name)&&void 0!==t?t:"Unknown"}`}exportSVG(){this.ui.ref.current&&(0,E.exportSVG)(this.ui.ref.current,{type:"svg",title:this.title})}exportPNG(){this.ui.ref.current&&(0,E.exportSVG)(this.ui.ref.current,{type:"png",title:this.title})}exportVega(){this.ui.ref.current&&((0,E.exportVegaLite)(this.ui.ref.current,{title:this.title}),this.ui.showToast({severity:"success",message:`${this.title}.json generated`,link:{alt:"Vega-Lite Editor",href:"https://vega.github.io/"}}))}downloadFile(e,t,n,a){const r=new Blob([e],{type:t}),s=URL.createObjectURL(r);(0,E.downloadUrl)(s,`${this.title}.${n}`,document),URL.revokeObjectURL(s),this.ui.showToast({severity:"success",message:`${this.title}.${n} generated`,link:a})}exportCSV(){this.downloadFile(function(e){const t=e.visibleSets,n=e.visibleCombinations,a=e.dataset.attrs.filter((t=>e.selectedAttrs.has(t)));return(0,h.unparse)([["Name","Cardinality","Degree",t.map((e=>e.name)),a.map((e=>function(e){return["Count","Median","Mean","Min","Max","Q1","Q3"].map((t=>`${e}_${t}`))}(e)))].flat(2),...n.map((e=>[e.name,e.cardinality,e.degree,t.map((t=>e.sets.has(t)?1:0)),a.map((t=>function(e,t){const n=D(t.map((t=>t.attrs[e])));return[n.count,n.median,n.mean,n.min,n.max,n.q1,n.q3]}(t,e.elems)))].flat(2)))])}(this),"text/csv","csv")}exportJSON(){this.downloadFile(function(e){const t=k(e,{compress:"no"});return JSON.stringify(t,null,2)}(this),"application/json","json")}exportStaticJSON(){this.downloadFile(function(e){const t=C(e,{compress:"no"});return JSON.stringify(t,null,2)}(this),"application/json","json")}exportR(){this.downloadFile(function(e){const t=e.selectedAttrs.size>0?function(e){const t=e.elems,n=Array.from(e.selectedAttrs);return`df <- data.frame(\n${e.visibleSets.map((e=>{const n=new Set(e.elems);return`   \`${e.name}\`= c(${t.map((e=>n.has(e)?1:0)).join(",")})`})).join(",\n")}\n)\nrownames(df) <- ${Y(t.map((e=>e.name)))}\ndf.attributes <- list(\n${n.map((e=>`\`${e}\` = c(${t.map((t=>{var n;return null!==(n=t.attrs[e])&&void 0!==n?n:"NULL"})).join(",")})`)).join(",\n")}\n)\nupsetjs() %>% fromDataFrame(df, attributes=df.attributes)`}(e):function(e){return`listInput <- list(\n${e.visibleSets.map((e=>`   \`${e.name}\`=${Y(e.elems.map((e=>e.name)))}`)).join(",\n")}\n)\nupsetjs() %>% fromList(listInput)`}(e),n=e.selection?`%>% setSelection(${function(e,t){if(Array.isArray(t))return`elems=${Y(t.map((e=>e.name)))}`;const n=t;return"set"===n.type?Y(n.name):e.visibleCombinations.findIndex((e=>e.name===n.name&&e.type===n.type))<0?`elems=${Y(n.elems.map((e=>e.name)))}`:Y(Array.from(n.sets).map((e=>e.name)).sort())}(e,e.selection)})`:"",a=e.combinationsOptions;return`\ndevtools::install_url("https://github.com/upsetjs/upsetjs_r/releases/v1.7.0/download/upsetjs.tar.gz")\nlibrary(upsetjs)\n\n${t}  %>% generate${a.type[0].toUpperCase()}${a.type.slice(1)}s(min=${a.min}, max=${a.max}, empty=${a.empty?"T":"F"}, limit=${a.limit}, order.by=${Y(a.order)})${n}${e.visibleQueries.map((t=>`%>% addQuery(${Y(t.name)}, ${Y(t.color)}, ${function(e,t){if((0,i.AX)(t))return`elems=${Y(Array.from(t.elems).map((e=>e.name)))}`;const n=t.set;return"set"===n.type?`set=${Y(n.name)}`:e.visibleCombinations.findIndex((e=>e.name===n.name&&e.type===n.type))<0?`elems=[${Y(n.elems.map((e=>e.name)))}`:`set=${Y(Array.from(n.sets).map((e=>e.name)).sort())}`}(e,t)})`)).join("")}${function(e){const t=Object.keys(e);if(0===t.length)return"";const n=[];return t.forEach((t=>{const a=t,r=e[a];"widthRatios"===a||"heightRatios"===a?n.push(`${X(a)} = c(${r})`):"fontSizes"===a?n.push(`font.sizes = list(${Object.keys(r).map((e=>`${X(e)} = "${r[e]}"`)).join(", ")})`):n.push(`${X(a)} = ${JSON.stringify(r)}`)})),` %>% chartProps(${n.join(", ")})`}(me(e.props,e.ui.theme))} %>% interactiveChart()\n`}(this),"text/plain","R",{href:"https://mybinder.org/v2/gh/upsetjs/upsetjs_r/master?urlpath=rstudio/",alt:"Open MyBinder R Environment"})}exportPython(){this.downloadFile(function(e){const t=e.selectedAttrs.size>0?function(e){const t=[],n=Array.from(e.selectedAttrs);t.push("df = pd.DataFrame({\n");const a=e.visibleSets.length+n.length-1;return e.visibleSets.forEach(((n,r)=>{const s=new Set(n.elems);t.push(`  "${n.name}": ${JSON.stringify(e.elems.map((e=>s.has(e)?1:0)))}${r<a?",":""}\n`)})),n.forEach(((a,r)=>{t.push(`  "${a}": ${JSON.stringify(e.elems.map((e=>e.attrs[a])))}${r<n.length-1?",":""}\n`.replace(/null/g,"None"))})),t.push(`}, index=${JSON.stringify(e.elems.map((e=>e.name)))}`),t.push(")\n"),t.push("\n"),t.push(`w = UpSetJSWidget[str]().from_dataframe(df${n.length>0?`, attributes=${JSON.stringify(n)}`:""})\n`),t}(e):function(e){return["dict_input = OrderedDict([\n",...e.visibleSets.map(((t,n)=>`   ("${t.name}", ${JSON.stringify(t.elems.map((e=>e.name)))})${n<e.visibleSets.length-1?",":""}\n`)),"])\n","\n","w = UpSetJSWidget[str]().from_dict(dict_input)\n"]}(e),n=e.combinationsOptions,a=`w.generate_${n.type}s(min_degree=${n.min}, max_degree=${n.max}, empty=${n.empty?"True":"False"}, limit=${n.limit})\n`,r=e.selection?`w.selection = ${(t=>{if(Array.isArray(t))return`[${t.map((e=>`"${e.name}"`)).join(", ")}]`;const n=t;return"set"===n.type?`next(s for s in w.sets if s.name == "${n.name}")`:e.visibleCombinations.findIndex((e=>e.name===n.name&&e.type===n.type))<0?`[${n.elems.map((e=>`"${e.name}"`)).join(", ")}]`:`next(s for s in w.combinations if s.name == "${n.name}")`})(e.selection)}\n`:null,s=e.visibleQueries.map((t=>`w.append_query("${t.name}", "${t.color}", ${(t=>{if((0,i.AX)(t))return`elems=[${Array.from(t.elems).map((e=>`"${e.name}"`)).join(", ")}]`;const n=t.set;return"set"===n.type?`upset=next(s for s in w.sets if s.name == "${n.name}")`:e.visibleCombinations.findIndex((e=>e.name===n.name&&e.type===n.type))<0?`elems=[${n.elems.map((e=>`"${e.name}"`)).join(", ")}]`:`upset=next(s for s in w.combinations if s.name == "${n.name}")`})(t)})\n`)),l=function(e){const t=[],n=me(e.props,e.ui.theme);return Object.keys(n).forEach((e=>{const a=e,r=n[a];"heightRatios"===a||"widthRatios"===a?t.push(`w.${ee(a)} = (${r})\n`):"fontSizes"===a?Object.keys(r).forEach((e=>{t.push(`w.font_sizes.${ee(e)} = "${r[e]}"\n`)})):t.push(`w.${ee(a)} = ${JSON.stringify(r)}\n`)})),t}(e),o={nbformat:4,nbformat_minor:2,metadata:{language_info:{name:"python",codemirror_mode:{name:"ipython",version:3}},orig_nbformat:2,file_extension:".py",mimetype:"text/x-python",name:"python",npconvert_exporter:"python",pygments_lexer:"ipython3",version:3},cells:[{cell_type:"markdown",metadata:{},source:[`# ${e.title}`,"\n","Please make sure the jupyter extension is installed:\n","```bash\n","pip install upsetjs_jupyter_widget\n","jupyter labextension install @jupyter-widgets/jupyterlab-manager@3.0.0-alpha.0\n","```\n"]},{cell_type:"code",execution_count:null,metadata:{},outputs:[],source:["from ipywidgets import interact\n","from collections import OrderedDict\n","from upsetjs_jupyter_widget import UpSetJSWidget\n","import pandas as pd"]},{cell_type:"code",execution_count:40,metadata:{},outputs:[],source:[...t,a,r,...s,...l,"w"].filter(Boolean)}]};return JSON.stringify(o,null,2)}(this),"application/vnd.jupyter","ipynb",{href:"https://mybinder.org/v2/gh/upsetjs/upsetjs_jupyter_widget/master?urlpath=lab/",alt:"Open MyBinder Python Environment"})}exportCodepen(){!function(e){const{html:t,js:n}=re(e),a={title:e.title,description:e.dataset.description,html:t,css:ne,css_pre_processor:"scss",css_starter:"normalize",js:n,js_pre_processor:"babel",js_modernizr:!1,js_external:`https://cdn.jsdelivr.net/npm/@upsetjs/bundle@${encodeURIComponent("^")}1.7.0`},r=JSON.stringify(a).replace(/"/g,"&quot;").replace(/'/g,"&apos;"),s=document.createElement("form");s.method="post",s.action="https://codepen.io/pen/define",s.target="_blank",s.rel="noopener noreferrer",s.innerHTML='<input type="hidden" name="data">',s.firstElementChild.value=r,document.body.appendChild(s),s.submit(),s.remove()}(this)}exportCodesandbox(){!function(e){const{elems:t,js:n}=ae(e,""),a=n.includes("boxplotAddon("),r=n.includes("fromIndicesArray"),s={files:{"index.html":{content:`<!DOCTYPE html>\n<html lang="en">\n<head>\n  <title>${e.title}</title>\n  <meta charset="utf-8">\n  <meta http-equiv="X-UA-Compatible" content="IE=edge">\n</head>\n<body>\n${te}\n</body>\n</html>`},"main.css":{content:ne},"data.json":{content:t},"index.js":{content:`\nimport {render, generateCombinations, ${r?"fromIndicesArray, ":""}${a?"boxplotAddon, ":""}asSets)} from "@upsetjs/bundle";\nimport elems from './data.json';\nimport "./main.css";\n\n${n}\n`},"package.json":{content:{name:e.dataset.name,description:e.dataset.description,dependencies:{"@upsetjs/bundle":"^1.7.0"}}}}},l=(0,S.compressToBase64)(JSON.stringify(s)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""),o=document.createElement("form");o.method="post",o.action="https://codesandbox.io/api/v1/sandboxes/define",o.target="_blank",o.rel="noopener noreferrer",o.innerHTML='<input type="hidden" name="parameters">',o.firstElementChild.value=l,document.body.appendChild(o),o.submit(),o.remove()}(this)}exportJSFiddle(){!function(e){const{html:t,js:n}=re(e),a=document.createElement("form");a.method="post",a.action="https://jsfiddle.net/api/post/library/pure/",a.target="_blank",a.rel="noopener noreferrer",a.innerHTML='\x3c!--https://docs.jsfiddle.net/api/display-a-fiddle-from-post--\x3e\n      <input type="hidden" name="title">\n      <input type="hidden" name="description">\n      <input type="hidden" name="resources">\n      <input type="hidden" name="html">\n      <input type="hidden" name="css">\n      <input type="hidden" name="js">\n      <input type="hidden" name="wrap" value="d">\n      <input type="hidden" name="normalize_css" value="yes">\n      <input type="hidden" name="css_panel" value="1">\x3c!--SCSS--\x3e\n      <input type="hidden" name="js_panel" value="2">\x3c!--JS 1.7--\x3e';const r=(e,t)=>{a.querySelector(`[name="${e}"]`).value=t.toString()};r("title",e.title),r("description",e.dataset.description),r("html",t),r("css",ne),r("js",n),r("resources",`https://cdn.jsdelivr.net/npm/@upsetjs/bundle@${encodeURIComponent("^")}1.7.0`),document.body.appendChild(a),a.submit(),a.remove()}(this)}sharedEmbedded(){(function(e){const t=k(e,{compress:"yes"});delete t.$schema;const n=(0,S.compressToEncodedURIComponent)(JSON.stringify(t)),a=new URL(window.location.toString());if(a.hash="",a.pathname.endsWith("/")?a.pathname=`${a.pathname}embed.html`:a.pathname.endsWith("index.html")?a.pathname=a.pathname.replace("index.html","embed.html"):a.pathname=`${a.pathname}/embed.html`,a.search="?",a.searchParams.set("p",n),a.toString().length<O)return window.open(a.toString(),"_blank"),!0;if(0===e.selectedAttrs.size){const t=C(e,{compress:"yes"});delete t.$schema;const n=(0,S.compressToEncodedURIComponent)(JSON.stringify(t));if(a.searchParams.set("p",n),a.toString().length<O)return window.open(a.toString(),"_blank"),!0}a.searchParams.delete("p");const r=window.open(a.toString(),"_blank");return null==r||r.addEventListener("load",(()=>{null==r||r.postMessage(t,a.origin)})),!1})(this)||this.ui.showToast({severity:"warning",message:`The current dataset cannot be encoded within ${O.toLocaleString()} characters in the URL. You can either try to deactive any attriubtes or save the page and host it yourself`})}importFile(e){const t="string"==typeof e?e:e.name;this.ui.showToast({severity:"info",message:`Importing Dataset: ${t}...`});const n=t.endsWith(".json")?M:t.endsWith(".csv")?Q:null;n?n(e).then((e=>{this.ui.closeToast(),this.pushDataSet(e)})).catch((e=>{console.error(e),this.ui.showToast({severity:"error",message:"Error occurred during dataset import!"})})):this.ui.showToast({severity:"error",message:"Unknown Dataset type: only .csv and .json are supported"})}}(0,s.gn)([l.LO],ue.prototype,"ui",void 0),(0,s.gn)([l.LO.shallow],ue.prototype,"datasets",void 0),(0,s.gn)([l.LO.ref],ue.prototype,"dataset",void 0),(0,s.gn)([l.LO.shallow],ue.prototype,"sets",void 0),(0,s.gn)([l.LO.shallow],ue.prototype,"elems",void 0),(0,s.gn)([l.LO],ue.prototype,"props",void 0),(0,s.gn)([l.LO.ref],ue.prototype,"hover",void 0),(0,s.gn)([l.LO.ref],ue.prototype,"selection",void 0),(0,s.gn)([l.LO],ue.prototype,"queries",void 0),(0,s.gn)([l.LO],ue.prototype,"selectedAttrs",void 0),(0,s.gn)([l.LO],ue.prototype,"combinationsOptions",void 0),(0,s.gn)([l.LO],ue.prototype,"selectedSets",void 0),(0,s.gn)([l.aD.bound],ue.prototype,"resetProps",null),(0,s.gn)([l.aD],ue.prototype,"appendDatasets",null),(0,s.gn)([l.aD],ue.prototype,"selectDataSet",null),(0,s.gn)([l.aD.bound],ue.prototype,"pushDataSet",null),(0,s.gn)([l.aD],ue.prototype,"deleteDataSet",null),(0,s.gn)([l.aD.bound],ue.prototype,"setHover",null),(0,s.gn)([l.aD.bound],ue.prototype,"setSelection",null),(0,s.gn)([l.Fl],ue.prototype,"visibleSets",null),(0,s.gn)([l.Fl],ue.prototype,"visibleVennSets",null),(0,s.gn)([l.Fl],ue.prototype,"visibleSetAddons",null),(0,s.gn)([l.Fl],ue.prototype,"visibleCombinationAddons",null),(0,s.gn)([l.Fl],ue.prototype,"sortedSelectedElems",null),(0,s.gn)([l.Fl],ue.prototype,"sortedSets",null),(0,s.gn)([l.aD],ue.prototype,"setSelectedSets",null),(0,s.gn)([l.aD],ue.prototype,"setSelectedAttrs",null),(0,s.gn)([l.Fl],ue.prototype,"visibleCombinations",null),(0,s.gn)([l.aD],ue.prototype,"changeCombinations",null),(0,s.gn)([l.aD],ue.prototype,"changeProps",null),(0,s.gn)([l.aD],ue.prototype,"changeFontSize",null),(0,s.gn)([l.Fl],ue.prototype,"visibleQueries",null),(0,s.gn)([l.Fl],ue.prototype,"queriesAndSelection",null),(0,s.gn)([l.aD],ue.prototype,"deleteQuery",null),(0,s.gn)([l.aD],ue.prototype,"persistSelection",null),(0,s.gn)([l.aD],ue.prototype,"toggleQueryVisibility",null),(0,s.gn)([l.Fl],ue.prototype,"title",null),(0,s.gn)([l.aD.bound],ue.prototype,"exportSVG",null),(0,s.gn)([l.aD.bound],ue.prototype,"exportPNG",null),(0,s.gn)([l.aD.bound],ue.prototype,"exportVega",null),(0,s.gn)([l.aD.bound],ue.prototype,"exportCSV",null),(0,s.gn)([l.aD.bound],ue.prototype,"exportJSON",null),(0,s.gn)([l.aD.bound],ue.prototype,"exportStaticJSON",null),(0,s.gn)([l.aD.bound],ue.prototype,"exportR",null),(0,s.gn)([l.aD.bound],ue.prototype,"exportPython",null),(0,s.gn)([l.aD.bound],ue.prototype,"exportCodepen",null),(0,s.gn)([l.aD.bound],ue.prototype,"exportCodesandbox",null),(0,s.gn)([l.aD.bound],ue.prototype,"exportJSFiddle",null),(0,s.gn)([l.aD.bound],ue.prototype,"sharedEmbedded",null),(0,s.gn)([l.aD.bound],ue.prototype,"importFile",null);const pe=r.createContext(null),ye=({children:e})=>{const t=(0,a.fv)((()=>new ue));return r.createElement(pe.Provider,{value:t}," ",e," ")},he=()=>{const e=r.useContext(pe);if(!e)throw new Error("useStore must be used within a StoreProvider.");return e};var fe=n(3225),ge=n(2948),xe=n(5895),be=n(1556),ve=n(692),we=n(7084),$e=n(2078),Se=n(647),Ee=n(9458),ke=n(1805);const Ce=(0,ve.Z)((e=>({root:{padding:e.spacing(1),display:"flex",flexDirection:"column"},header:{whiteSpace:"nowrap"}}))),Oe=(0,a.Pi)((({id:e,title:t,className:n,children:a})=>{const s=he(),l=Ce();return r.createElement($e.Z,{expanded:s.ui.sidePanelExpanded.has(e),onChange:(0,r.useCallback)((()=>s.ui.toggleSidePanelExpansion(e)),[s,e]),className:n},r.createElement(Ee.Z,{expandIcon:r.createElement(ke.Z,null),"aria-controls":e,id:e},r.createElement(we.Z,{variant:"h6",className:l.header},t)),r.createElement(Se.Z,{className:l.root},a))})),Ne=(0,a.Pi)((()=>{var e,t;const n=he(),a=n.dataset;return r.createElement(Oe,{id:"datasetinfo",title:"Dataset Information"},r.createElement(we.Z,{variant:"subtitle2"},"Name:"),r.createElement(we.Z,null,null==a?void 0:a.name),r.createElement(we.Z,{variant:"subtitle2"},"#Sets: ",n.sets.length),r.createElement(we.Z,{variant:"subtitle2"},"#Items: ",n.elems.length),r.createElement(we.Z,{variant:"subtitle2"},"#Attributes: ",null!==(t=null===(e=n.dataset)||void 0===e?void 0:e.attrs.length)&&void 0!==t?t:0),r.createElement(we.Z,{variant:"subtitle2"},"Author:"),r.createElement(we.Z,null,null==a?void 0:a.author),r.createElement(we.Z,{variant:"subtitle2"},"Description:"),r.createElement(we.Z,null,null==a?void 0:a.description))}));var Ae=n(3506),Me=n(6776),Le=n(7595),je=n(7868);const Te=(0,a.Pi)((()=>{var e;const t=he(),n=t.combinationsOptions,a=Array.isArray(n.order)?n.order.join(","):null!==(e=n.order)&&void 0!==e?e:"",s=(0,r.useCallback)((e=>t.changeCombinations({[e.target.name]:Number.parseInt(e.target.value,10)})),[t]),l=(0,r.useCallback)((e=>t.changeCombinations({[e.target.name]:e.target.checked})),[t]);return r.createElement(Oe,{id:"options",title:"Set Combinations"},r.createElement(je.Z,{margin:"dense",label:"Ordering",value:a,select:!0,required:!0,onChange:e=>t.changeCombinations({order:e.target.value.split(",")})},r.createElement(Me.Z,{value:"name"},"1. Name"),r.createElement(Me.Z,{value:"cardinality,name"},"1. Cardinality 2. Name"),r.createElement(Me.Z,{value:"cardinality,degree,name"},"1. Cardinality 2. Degree 3. Name"),r.createElement(Me.Z,{value:"degree,name"},"1. Degree 2. Name"),r.createElement(Me.Z,{value:"degree,cardinality,name"},"1. Degree 2. Cardinality 3. Name"),r.createElement(Me.Z,{value:"group,name"},"1. Set Group 2. Name"),r.createElement(Me.Z,{value:"group,cardinality,name"},"1. Set Group 2. Cardinality 3. Name"),r.createElement(Me.Z,{value:"group,degree,name"},"1. Set Group 2. Degree 3. Name"),r.createElement(Me.Z,{value:"group,degree,cardinality,name"},"1. Set Group 2. Degree 3. Cardinality 4. Name")),r.createElement(je.Z,{margin:"dense",label:"Mode",value:n.type,select:!0,required:!0,onChange:e=>t.changeCombinations({type:String(e.target.value)})},r.createElement(Me.Z,{value:"intersection"},"Set Intersections"),r.createElement(Me.Z,{value:"distinctIntersection"},"Distinct Set Intersections"),r.createElement(Me.Z,{value:"union"},"Set Unions")),r.createElement(je.Z,{margin:"dense",label:"Minimum Set Members",value:n.min,name:"min",type:"number",required:!0,inputProps:{min:0,max:t.sets.length>0?t.sets.length:void 0},onChange:s}),r.createElement(je.Z,{margin:"dense",label:"Maximum Set Members",name:"max",value:n.max,type:"number",required:!0,inputProps:{min:1,max:t.sets.length>0?t.sets.length:void 0},onChange:s}),r.createElement(je.Z,{margin:"dense",label:"Max # Combinations",name:"limit",value:n.limit,type:"number",required:!0,inputProps:{min:1},onChange:s}),r.createElement(Ae.Z,{control:r.createElement(Le.Z,{checked:n.empty,onChange:l,name:"empty",size:"small"}),label:"Include Empty Combinations"}))}));var Ze=n(9137),Pe=n(7766),qe=n(9150),De=n(5728),ze=n(5280),Ie=n(3848),Be=n(5620),Re=n(7457);const Fe=(0,ve.Z)((e=>({pointer:{cursor:"pointer"},cell:{position:"relative"},bar:{position:"absolute",left:0,top:"6px",bottom:"6px",backgroundColor:e.palette.text.primary,opacity:.3}}))),_e=(0,a.Pi)((()=>{const e=he(),t=Fe(),n=e.ui.setTable,a=e.sets,s=a.length,l=e.selectedSets,o=e.selectedSets.size,i=(0,r.useCallback)((()=>{const t="name"===n.orderBy&&"asc"===n.order;e.ui.changeSetTableOptions({order:t?"desc":"asc",orderBy:"name"})}),[e,n]),c=(0,r.useCallback)((()=>{const t="cardinality"===n.orderBy&&"asc"===n.order;e.ui.changeSetTableOptions({order:t?"desc":"asc",orderBy:"cardinality"})}),[e,n]),m=(0,r.useCallback)((t=>{if(t.target.checked){const t=a.map((e=>e.name));e.setSelectedSets(new Set(t))}else e.setSelectedSets(new Set([]))}),[a,e]),d=(0,r.useCallback)((t=>{const n=new Set(l),a=t.currentTarget.dataset.name;n.has(a)?n.delete(a):n.add(a),e.setSelectedSets(n)}),[e,l]),u=e.sortedSets.reduce(((e,t)=>Math.max(e,t.cardinality)),0);return r.createElement(Oe,{id:"sets",title:"Set Chooser"},r.createElement(ze.Z,null,r.createElement(Pe.Z,{size:"small"},r.createElement(Ie.Z,null,r.createElement(Be.Z,null,r.createElement(De.Z,{padding:"checkbox"},r.createElement(Ze.Z,{indeterminate:o>0&&o<s,checked:s>0&&o===s,onChange:m,inputProps:{"aria-label":"select all sets"}})),r.createElement(De.Z,{padding:"none",sortDirection:"name"===n.orderBy&&n.order},r.createElement(Re.Z,{active:"name"===n.orderBy,direction:"name"===n.orderBy?n.order:"asc",onClick:i},"Name")),r.createElement(De.Z,{sortDirection:"cardinality"===n.orderBy&&n.order},r.createElement(Re.Z,{active:"cardinality"===n.orderBy,direction:"cardinality"===n.orderBy?n.order:"asc",onClick:c},"Cardinality")))),e.ui.sidePanelExpanded.has("sets")&&r.createElement(qe.Z,null,e.sortedSets.map((e=>{const n=(a=e.name,l.has(a));var a,s;return r.createElement(Be.Z,{hover:!0,"data-name":e.name,onClick:d,role:"checkbox",tabIndex:-1,key:e.name,selected:n,className:t.pointer},r.createElement(De.Z,{padding:"checkbox"},r.createElement(Ze.Z,{checked:n})),r.createElement(De.Z,{component:"th",scope:"row",padding:"none"},e.name),r.createElement(De.Z,{align:"right",className:t.cell},r.createElement("div",{className:t.bar,style:{width:(s=e.cardinality,`${Math.round(100*s/u)}%`)}}),e.cardinality))}))))))})),He=(0,ve.Z)((()=>({pointer:{cursor:"pointer"}}))),Ke=[],Je=(0,a.Pi)((()=>{var e,t;const n=he(),a=He(),s=null!==(t=null===(e=n.dataset)||void 0===e?void 0:e.attrs)&&void 0!==t?t:Ke,l=n.selectedAttrs,o=l.size,i=s.length,c=(0,r.useCallback)((e=>l.has(e)),[l]),m=(0,r.useCallback)((e=>{if(e.target.checked){const e=s;n.setSelectedAttrs(new Set(e))}else n.setSelectedAttrs(new Set([]))}),[s,n]),d=(0,r.useCallback)((e=>{const t=new Set(l),a=e.currentTarget.dataset.name;t.has(a)?t.delete(a):t.add(a),n.setSelectedAttrs(t)}),[l,n]);return 0===i?null:r.createElement(Oe,{id:"attrs",title:"Attribute Chooser"},r.createElement(ze.Z,null,r.createElement(Pe.Z,{size:"small"},r.createElement(Ie.Z,null,r.createElement(Be.Z,null,r.createElement(De.Z,{padding:"checkbox"},r.createElement(Ze.Z,{indeterminate:o>0&&o<i,checked:i>0&&o===i,onChange:m,inputProps:{"aria-label":"select all attributes"}})),r.createElement(De.Z,{padding:"none"},"Name"))),n.ui.sidePanelExpanded.has("attrs")&&r.createElement(qe.Z,null,s.map((e=>{const t=c(e);return r.createElement(Be.Z,{hover:!0,"data-name":e,onClick:d,role:"checkbox",tabIndex:-1,key:e,selected:t,className:a.pointer},r.createElement(De.Z,{padding:"checkbox"},r.createElement(Ze.Z,{checked:t})),r.createElement(De.Z,{component:"th",scope:"row",padding:"none"},e))}))))))}));var Ue=n(1384);const Ge=(0,ve.Z)((e=>({wrapper:{overflow:"auto",position:"relative",width:"15vw",borderRight:`1px solid ${e.palette.primary.main}`},root:{position:"absolute",left:0,width:"100%",height:"100%",display:"flex",flexDirection:"column"}}))),Ve=(0,a.Pi)((()=>{const e=Ge();return r.createElement(Ue.Z,{className:e.wrapper},r.createElement("div",{className:e.root},r.createElement(Te,null),r.createElement(_e,null),r.createElement(Je,null),r.createElement(Ne,null)))}));var We=n(7631),Qe=n(8960),Xe=n(6743),Ye=(n(5329),n(1189),n(409)),et=n(2400);function tt({label:e,name:t,value:n,required:a,onChange:s}){const l=(0,r.useRef)(null);(0,r.useEffect)((()=>{if(!l.current)return;const e=new CP(l.current,{color:"RGB"});return e.on("change",(function(e,n,r,o){const i=1===o?this.color(e,n,r,o):`rgba(${e},${n},${r},${o})`;l.current&&(l.current.value===i||!a&&""===l.current.value&&"#000000"===i)||s({target:{name:t,value:i}})})),()=>e.pop()}),[l,t,s,a]);const o=(0,r.useCallback)((()=>{s(""===n?{target:{name:t,value:"#000000"}}:{target:{name:t,value:""}})}),[s,n,t]),i=(0,r.useCallback)((e=>e.preventDefault()),[]);return r.createElement(je.Z,{label:e,size:"small",margin:"dense",name:t,value:n,required:a,inputProps:{ref:l},InputProps:{startAdornment:r.createElement(Xe.Z,{position:"start",style:{color:n}},r.createElement(Qe.Z,{onClick:a?void 0:o,onMouseDown:i,size:"small",color:"inherit"},""!==n?r.createElement(Ye.Z,null):r.createElement(et.Z,null)))}})}CP.RGB=e=>{if("string"==typeof e)return e.startsWith("#")?CP.HEX(e):function(e){let t;return(t=e.match(/^rgba\s*\(\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,\s*([01]|0?\.\d+)\s*\)$/i))?[+t[1],+t[2],+t[3],+t[4]]:(t=e.match(/^rgb\s*\(\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*\)$/i))?[+t[1],+t[2],+t[3],1]:[0,0,0,1]}(e);const t=+e[0],n=+e[1],a=+e[2],r=+(void 0===e[3]?1:e[3]);return 1===r?CP.HEX(e):`rgba(${t},${n},${a},${r})`};const nt=(0,a.Pi)((()=>{const e=he(),t=e.props,n=(0,r.useCallback)((t=>e.changeProps({[t.target.name]:""===t.target.value?void 0:t.target.value})),[e]),a=(0,r.useCallback)((t=>e.changeProps({[t.target.name]:""===t.target.value?void 0:Number.parseFloat(t.target.value)})),[e]);return r.createElement(Oe,{id:"theme",title:"Customize Theme"},r.createElement(je.Z,{label:"Theme",margin:"dense",value:t.theme,select:!0,required:!0,onChange:t=>e.changeProps({theme:String(t.target.value)})},r.createElement(Me.Z,{value:"dark"},"Dark Theme"),r.createElement(Me.Z,{value:"light"},"Light Theme"),r.createElement(Me.Z,{value:"vega"},"Vega Theme")),r.createElement(tt,{label:"Bar Color",required:!0,name:"color",value:t.color,onChange:n}),r.createElement(tt,{label:"Text Color",required:!0,name:"textColor",value:t.textColor,onChange:n}),r.createElement(tt,{label:"Selection Color",name:"selectionColor",value:t.selectionColor,onChange:n}),r.createElement(tt,{label:"Hover Hint Color",name:"hoverHintColor",value:t.hoverHintColor,required:!0,onChange:n}),r.createElement(tt,{label:"Not Member Dot Color",name:"notMemberColor",value:t.notMemberColor,required:!0,onChange:n}),r.createElement(tt,{label:"Alternating Background Color",name:"alternatingBackgroundColor",value:t.alternatingBackgroundColor||"",onChange:n}),r.createElement(tt,{label:"Has Selection Color",name:"hasSelectionColor",value:t.hasSelectionColor||"",onChange:n}),r.createElement(je.Z,{label:"Opacity",size:"small",margin:"dense",name:"opacity",value:t.opacity,type:"number",inputProps:{min:0,max:1,step:.1},onChange:a}),r.createElement(je.Z,{label:"Has Selection Opacity",size:"small",margin:"dense",name:"hasSelectionOpacity",value:null==t.hasSelectionOpacity||t.hasSelectionOpacity<0?"":t.hasSelectionOpacity,type:"number",inputProps:{min:0,max:1,step:.1},onChange:a}))}));var at=n(6841),rt=n(3759),st=n(6291),lt=n(9105),ot=n(9567),it=n(6461),ct=n(7887),mt=n(270),dt=n(4404);const ut=(0,ve.Z)((()=>({root:{}}))),pt=(0,a.Pi)((()=>{const e=he(),t=e.selection;return r.createElement(rt.Z,null,r.createElement(lt.Z,{onClick:(0,r.useCallback)((()=>e.persistSelection()),[e])},r.createElement(dt.ZP,{title:"Persist Selection"},r.createElement(Qe.Z,{edge:"start","aria-label":"persist"},r.createElement(ct.Z,{style:{color:le}})))),r.createElement(ot.Z,{primary:(0,i.vK)(t)?`${t.name}: ${t.cardinality}`:`Array: ${t.length}`}))})),yt=(0,a.Pi)((({query:e,visible:t})=>{const n=he();return r.createElement(rt.Z,null,r.createElement(lt.Z,{onClick:(0,r.useCallback)((()=>n.toggleQueryVisibility(e)),[n,e])},r.createElement(Ze.Z,{edge:"start",checked:t,tabIndex:-1,disableRipple:!0,style:{color:e.color}})),r.createElement(ot.Z,{primary:`${e.name}: ${(0,i.DR)(e)?e.set.cardinality:Array.isArray(e.elems)?e.elems.length:e.elems.size}`}),r.createElement(st.Z,null,r.createElement(dt.ZP,{title:"Remove Query"},r.createElement(Qe.Z,{edge:"end","aria-label":"delete",onClick:(0,r.useCallback)((()=>n.deleteQuery(e)),[n,e])},r.createElement(it.Z,null)))))})),ht=(0,a.Pi)((()=>{const e=he(),t=ut();return r.createElement(Oe,{id:"queries",title:"Queries",className:t.root},r.createElement(at.Z,{dense:!0},e.selection&&r.createElement(r.Fragment,null,r.createElement(pt,null),r.createElement(mt.Z,null)),e.queries.map((({q:e,visible:t})=>r.createElement(yt,{key:e.name+e.color,query:e,visible:t})))))}));var ft=n(5429),gt=n(369);function xt({label:e,value:t,name:n,onChange:a}){const s=Number.parseFloat(t),l=t.slice(s.toString().length),o=(0,r.useCallback)((e=>{a(n,`${e.target.value}${l}`)}),[a,n,l]),i=(0,r.useCallback)((e=>{a(n,`${s}${e.target.value}`)}),[a,n,s]);return r.createElement(je.Z,{margin:"dense",label:e,value:s,name:n,type:"number",inputProps:{min:0,step:1},InputProps:{endAdornment:r.createElement(Xe.Z,{position:"end"},r.createElement(ft.Z,{value:l,onChange:i},r.createElement(Me.Z,{value:"px"},"px"),r.createElement(Me.Z,{value:"pt"},"pt")))},required:!0,onChange:o})}const bt=(0,a.Pi)((()=>{const e=he(),t=e.props,n=(0,r.useCallback)((t=>e.changeProps({[t.target.name]:t.target.value})),[e]),a=(0,r.useCallback)((t=>e.changeProps({[t.target.name]:Number.parseFloat(t.target.value)})),[e]),s=(0,r.useCallback)((t=>e.changeProps({[t.target.name]:""===t.target.value?"auto":Number.parseFloat(t.target.value)})),[e]),l=(0,r.useCallback)(((t,n)=>e.changeFontSize({[t]:n})),[e]);return r.createElement(Oe,{id:"customize",title:"Customize"},r.createElement(je.Z,{margin:"dense",label:"Set Name",name:"setName",value:t.setName,required:!0,onChange:n}),r.createElement(je.Z,{size:"small",margin:"none",label:"Set Axis Offset",name:"setNameAxisOffset",value:"auto"===t.setNameAxisOffset?"":t.setNameAxisOffset,type:"number",onChange:s}),r.createElement(je.Z,{margin:"dense",label:"Combination Name",name:"combinationName",value:t.combinationName,required:!0,onChange:n}),r.createElement(je.Z,{size:"small",margin:"none",label:"Combination Axis Offset",name:"combinationNameAxisOffset",value:"auto"===t.combinationNameAxisOffset?"":t.combinationNameAxisOffset,type:"number",onChange:s}),r.createElement(je.Z,{margin:"dense",label:"Font Family",name:"fontFamily",value:t.fontFamily,required:!0,onChange:n}),r.createElement(xt,{label:"Chart Font Size",value:t.fontSizes.chartLabel,name:"chartLabel",onChange:l}),r.createElement(xt,{label:"Set Label Font Size",value:t.fontSizes.setLabel,name:"setLabel",onChange:l}),r.createElement(mt.Z,null),r.createElement(je.Z,{margin:"dense",label:"Axis Scale",value:"linear"===t.numericScale?"linear":"log",select:!0,required:!0,onChange:t=>e.changeProps({numericScale:"log"===String(t.target.value)?"log":"linear"})},r.createElement(Me.Z,{value:"linear"},"Linear Scale"),r.createElement(Me.Z,{value:"log"},"Log Scale")),r.createElement(je.Z,{margin:"dense",label:"Bar Padding",name:"barPadding",value:t.barPadding,type:"number",required:!0,inputProps:{min:0,max:1,step:.1},onChange:a}),r.createElement(je.Z,{margin:"dense",label:"Dot Padding",name:"dotPadding",value:t.dotPadding,type:"number",required:!0,inputProps:{min:0,max:1,step:.1},onChange:a}),r.createElement(je.Z,{margin:"dense",label:"Chart Padding",name:"padding",value:t.padding,type:"number",required:!0,onChange:a}),r.createElement(je.Z,{margin:"dense",label:"Combination to Set Height Ratio",value:t.heightRatios[0],type:"number",required:!0,inputProps:{min:0,max:1,step:.1},onChange:t=>{const n=Number.parseFloat(t.target.value);e.changeProps({heightRatios:[n]})}}),r.createElement(je.Z,{margin:"dense",label:"Combination to Set Width Ratio",value:1-t.widthRatios[0]-t.widthRatios[1],type:"number",required:!0,inputProps:{min:0,max:1,step:.05},onChange:n=>{const a=Number.parseFloat(n.target.value),r=t.widthRatios[0]+t.widthRatios[1],s=(1-a)*t.widthRatios[0]/r,l=(1-a)*t.widthRatios[1]/r;e.changeProps({widthRatios:[s,l]})}}),r.createElement(je.Z,{margin:"dense",label:"Set to Label Width Ratio",value:t.widthRatios[0]/(t.widthRatios[0]+t.widthRatios[1]),type:"number",required:!0,inputProps:{min:0,max:1,step:.05},onChange:n=>{const a=Number.parseFloat(n.target.value),r=t.widthRatios[0]+t.widthRatios[1],s=a*r,l=(1-a)*r;e.changeProps({widthRatios:[s,l]})}}),r.createElement(mt.Z,null),r.createElement(gt.Z,{onClick:e.resetProps},"Reset"))})),vt=(0,ve.Z)((()=>({root:{}}))),wt=[],$t=(0,a.Pi)((()=>{var e,t;const n=he(),a=vt(),s=n.sortedSelectedElems,l=null!==(t=null===(e=n.dataset)||void 0===e?void 0:e.attrs)&&void 0!==t?t:wt,o=n.ui.elemTable,i=(0,r.useCallback)((()=>{const e="name"===o.orderBy&&"asc"===o.order;n.ui.changeElemTableOptions({order:e?"desc":"asc",orderBy:"name"})}),[n,o]),c=(0,r.useMemo)((()=>l.map((e=>()=>{const t=`attrs.${e}`,a=o.orderBy===t&&"asc"===o.order;n.ui.changeElemTableOptions({order:a?"desc":"asc",orderBy:t})}))),[n,o,l]);return r.createElement(Oe,{id:"elems",title:`Selected ${s.length.toLocaleString()} Items`},r.createElement(ze.Z,null,r.createElement(Pe.Z,{size:"small",className:a.root},r.createElement(Ie.Z,null,r.createElement(Be.Z,null,r.createElement(De.Z,{padding:"none",sortDirection:"name"===o.orderBy&&o.order},r.createElement(Re.Z,{active:"name"===o.orderBy,direction:"name"===o.orderBy?o.order:"asc",onClick:i},"Name")),l.map(((e,t)=>r.createElement(De.Z,{key:e,sortDirection:o.orderBy===`attrs.${e}`&&o.order},r.createElement(Re.Z,{active:o.orderBy===`attrs.${e}`,direction:o.orderBy===`attrs.${e}`?o.order:"asc",onClick:c[t]},e)))))),n.ui.sidePanelExpanded.has("elems")&&r.createElement(qe.Z,null,s.map((e=>r.createElement(Be.Z,{hover:!0,tabIndex:-1,key:e.name},r.createElement(De.Z,{component:"th",scope:"row",padding:"none"},e.name),l.map((t=>r.createElement(De.Z,{key:t,align:"right"},e.attrs[t]))))))))))}));var St=n(2380),Et=n(5999),kt=n(3472),Ct=n.n(kt);function Ot(e){return Object.assign({theme:"light",title:"",description:""},(0,E.getDefaultTheme)(e.theme),e)}function Nt(e,t){if((0,i.Xz)(e))return t=>e.overlap([t])>0;if((0,i.DR)(e)){const n=e.set.overlap;if(n)return e=>n([e])>0;if(t){const n=new Set(e.set.elems.map(t));return e=>n.has(e)}{const t=new Set(e.set.elems);return e=>t.has(e)}}if((0,i.AX)(e)){if(t){const n=new Set(Array.from(e.elems).map(t));return e=>n.has(e)}const n=new Set(e.elems);return e=>n.has(e)}return!1}function At(e,t){if(!e)return!1;if("function"==typeof e)return t=>e({type:"set",name:"S",cardinality:1,elems:[t]})>0;if((0,i.vK)(e)){const n=e.overlap;if(n)return e=>n([e])>0;if(t){const n=new Set(e.elems.map(t));return e=>n.has(e)}{const t=new Set(e.elems);return e=>t.has(e)}}if(Array.isArray(e)){if(t){const n=new Set(e.map(t));return e=>n.has(e)}const n=new Set(e);return e=>n.has(e)}return!1}function Mt(e){return!1!==e&&(()=>e)}function Lt(e,t="k"){return{test:`inSetStore(upset_signal, datum.${t})`,value:e}}function jt(e="values",t="k"){return`countInSetStore(upset_signal, datum.${e}, '${t}')`}function Tt(e,t="values",n="k"){return`countInSetStore(upset_q${e}_signal, datum.${t}, '${n}')`}function Zt(e,t="k"){return(null!=e?e:[]).map(((e,n)=>({test:`inSetStore(upset_q${n}_signal, datum.${t})`,value:e.color})))}function Pt(e,t,n,a=!1){const s=(0,r.useRef)(null),l=(0,r.useRef)(n),o=(0,r.useCallback)((n=>(n.signals=n.signals||[],n.signals.push({name:"upset_signal",value:Mt(At(l.current,e))}),(null!=t?t:[]).forEach(((t,a)=>n.signals.push({name:`upset_q${a}_signal`,value:Mt(Nt(t,e))}))),n)),[l,t,e]);(0,r.useLayoutEffect)((()=>{l.current=null!=n?n:null,s.current&&(s.current.signal("upset_signal",At(n,e)),(null!=t?t:[]).forEach(((t,n)=>s.current.signal(`upset_q${n}_signal`,Nt(t,e)))),a&&!s.current._running&&s.current.resize().run())}),[s,n,t,a,e]);const i=(0,r.useCallback)((e=>{s.current=e}),[s]);return{viewRef:s,vegaProps:{patch:o,onNewView:i}}}function qt(e,t,n){if(e.length!==t.length)return!1;if(n){const a=new Set(t.map(n));return e.every((e=>a.has(n(e))))}const a=new Set(t);return e.every((e=>a.has(e)))}function Dt(e,t,n){return null!=e&&(0,i.vK)(e)&&"composite"===e.type&&"interval"===e.subType&&e.xAttr===t&&e.yAttr===n}function zt(e){return`[${Math.round(100*e[0])/100},${Math.round(100*e[1])/100}]`}function It(e,t){return e===t||null!=e&&null!=t&&e[0]===t[0]&&e[1]===t[1]}function Bt(e,t,n,a,s,l,o,{selectionName:c="select",transformedData:m="data_0",xField:d="x",yField:u="y",elemField:p="e"}={}){const y=(0,r.useRef)(t),h=(0,r.useMemo)((()=>{if(!l&&!o)return;const t={};return l&&(t[c]=Ct()(((t,r)=>{if(!e.current)return;const s=r;if(null==s[d])return void l(null);if(y.current&&Dt(y.current,n,a)&&(o=y.current,i=s[d],c=s[u],It(o.x,i)&&It(o.y,c)))return;var o,i,c;const m=e.current.data("table").filter((e=>e[d]>=s[d][0]&&e[d]<=s[d][1]&&e[u]>=s[u][0]&&e[u]<=s[u][1])).map((e=>e[p])),h=function(e,t,n,a,r){return{name:`Vega Brush (${e}: ${zt(a)}, ${t}: ${zt(r)}`,type:"composite",subType:"interval",cardinality:n.length,degree:0,elems:n,sets:new Set,x:a,y:r,xAttr:e,yAttr:t}}(n,a,m,s[d],s[u]);l(h)}),200)),o&&(t[`${c}_hover`]=function(e,t,n,a,r,s){return(l,o)=>{if(!e.current)return;const c=o;if(!c||!c._vgsid_||0===c._vgsid_.length)return void a(null);const m=new Set(c._vgsid_),d=e.current.data(r).filter((e=>m.has(e._vgsid_))).map((e=>e[s]));if(0===d.length)return void a(null);if(t.current&&(0,i.sm)(t.current)&&qt(t.current.elems,d,n))return;const u=function(e){return{name:"Vega Selection",type:"composite",cardinality:e.length,degree:0,elems:e,sets:new Set}}(d);a(u)}}(e,y,s,o,m,p)),t}),[c,l,o,s,e,n,a,y,m,d,u,p]);(0,r.useLayoutEffect)((()=>{y.current=null!=t?t:null,e.current&&l&&(Dt(t,n,a)?function(e,t,n,a,r){const s=t.signal(`${e}_${a}`),l=t.signal(`${e}_${r}`);s&&Array.isArray(s)&&It(s,n.x)||t.signal(`${e}_${a}`,n.x);const o=[n.y[1],n.y[0]];l&&Array.isArray(l)&&It(l,o)||t.signal(`${e}_${r}`,o)}(c,e.current,t,d,u):t||function(e,t,n,a){const r=t.signal(`${e}_${n}`),s=t.signal(`${e}_${a}`);r&&t.signal(`${e}_${n}`,null),s&&t.signal(`${e}_${a}`,null)}(c,e.current,d,u))}),[c,e,t,n,a,l,d,u]);const f=(0,r.useMemo)((()=>Object.assign({},l?{[c]:{type:"interval",empty:"none"}}:{},o?{[`${c}_hover`]:{type:"single",empty:"none",on:"mouseover"}}:{})),[c,l,o]);return{signalListeners:h,hoverName:o?`${c}_hover`:null,selectionName:l?c:null,selection:f}}function Rt(e,t){return null!=e&&(0,i.vK)(e)&&"composite"===e.type&&"aggregate"===e.subType&&e.attr===t}function Ft(e,t,n,a,s,{selectionName:l="select",aggregatedData:o="data_0",unitData:i="layer_0",aggregateField:c="v",valuesField:m="values",elemField:d="e",nameGen:u}={}){const p=(0,r.useRef)(t),y=(0,r.useMemo)((()=>{if(!a&&!s)return;const t={},r=t=>(a,r)=>{if(!e.current)return;const s=r;if(!s||!s._vgsid_||0===s._vgsid_.length)return void t(null);const l=new Set(s._vgsid_),i=e.current.data(o).filter((e=>l.has(e._vgsid_))),y=i.map((e=>e[c]));if(p.current&&Rt(p.current,n)&&qt(p.current.groups,y))return;const h=i.map((e=>e[m]||[])).flat().map((e=>e[d])),f=function(e,t,n,a){return{name:null!=a?a:`Vega Group ${e}: ${n.join(", ")}`,type:"composite",subType:"aggregate",cardinality:t.length,degree:0,elems:t,sets:new Set,groups:n,attr:e}}(n,h,y,u?u(i):void 0);t(f)};return a&&(t[l]=r(a)),s&&(t[`${l}_hover`]=r(s)),t}),[a,s,e,n,p,l,o,d,c,m,u]);(0,r.useLayoutEffect)((()=>{p.current=null!=t?t:null,e.current&&a&&(Rt(t,n)?function(e,t,n,a,r,s){const l=t.signal(`${e}_tuple`),o=t.data(a).filter((e=>n.groups.includes(e[s]))).map((e=>e._vgsid_));if(qt(l&&l.values?l.values:[],o))return;const i=l?Object.assign({},l,{values:o}):{unit:r,fields:t.signal(`${e}_tuple_fields`),values:o};t.signal(`${e}_tuple`,i)}(l,e.current,t,o,i,c):null==t&&function(e,t){const n=t.signal(`${e}_tuple`);n&&Array.isArray(n.values)&&0!==n.values.length&&t.signal(`${e}_tuple`,null)}(l,e.current))}),[e,t,n,l,a,o,i,c]);const h=(0,r.useMemo)((()=>Object.assign({},a?{[l]:{type:"single",empty:"none"}}:{},s?{[`${l}_hover`]:{type:"single",empty:"none",on:"mouseover"}}:{})),[l,a,s]);return{signalListeners:y,hoverName:s?`${l}_hover`:null,selectionName:a?l:null,selection:h}}function _t(e){var t,n;const{title:a,description:s,selectionColor:l,color:o,theme:i}=Ot(e),{xAttr:c,yAttr:m,elems:d,width:u,height:p,actions:y,toElemKey:h}=e,f=(null!==(t=e.xLabel)&&void 0!==t?t:"function"==typeof c)?"x":c.toString(),g=(null!==(n=e.yLabel)&&void 0!==n?n:"function"==typeof m)?"y":m.toString(),x=(0,r.useMemo)((()=>{const e="function"==typeof c?c:e=>e[c],t="function"==typeof m?m:e=>e[m];return{table:d.map((n=>({e:n,x:e(n),y:t(n),k:h?h(n):n})))}}),[d,c,m,h]),{viewRef:b,vegaProps:v}=Pt(h,e.queries,e.selection),{signalListeners:w,selection:$,selectionName:S,hoverName:E}=Bt(b,e.selection,f,g,h,e.onClick,e.onHover),k=(0,r.useMemo)((()=>({title:a,description:s,data:{name:"table"},selection:$,mark:{type:"point",stroke:null,cursor:E?"pointer":void 0,tooltip:!0},encoding:{fill:{condition:[E?[{selection:E,value:l}]:[],S?[{selection:S,value:l}]:[],Lt(l),Zt(e.queries)].flat(),value:o},x:{field:"x",type:"quantitative",title:f},y:{field:"y",type:"quantitative",title:g}}})),[f,g,a,s,l,o,e.queries,$,S,E]);return r.createElement(St.Z,Object.assign({spec:k,signalListeners:w,width:u,height:p,data:x,theme:"dark"===i?"dark":void 0,actions:y},v))}function Ht(e,t){return{transform:[{aggregate:[{op:"values",as:"values"}],groupby:["bin_maxbins_10_v","bin_maxbins_10_v_end"]}],mark:{type:"bar",tooltip:!1},encoding:{color:{value:t},x:{bin:!0,field:"v",type:"quantitative"},y:{datum:{signal:e},type:"quantitative",title:null},y2:{type:"quantitative",datum:0,title:null}}}}function Kt(e){var t;const{title:n,description:a,selectionColor:s,color:l,theme:o}=Ot(e),{attr:i,elems:c,width:m,height:d,actions:u,toElemKey:p}=e,y=(null!==(t=e.label)&&void 0!==t?t:"function"==typeof i)?"v":i.toString(),h=(0,r.useMemo)((()=>{const e="function"==typeof i?i:e=>e[i];return{table:c.map((t=>({e:t,i:1,v:e(t),k:p?p(t):t})))}}),[c,i,p]),{viewRef:f,vegaProps:g}=Pt(p,e.queries,e.selection,!0),{selection:x,signalListeners:b,selectionName:v,hoverName:w}=function(e,t,n,a,s,{selectionName:l="select",aggregatedData:o="data_1",unitData:i="layer_0",valueField:c="v",valuesField:m="values",elemField:d="e"}={}){const u=`bin_maxbins_10_${c}`,p=(0,r.useCallback)((e=>`Vega Bin ${n}: ${e.map((e=>`[${e[u]},${e[`${u}_end`]})`)).join(", ")}`),[u,n]);return Ft(e,t,n,a,s,{selectionName:l,aggregatedData:o,unitData:i,valuesField:m,elemField:d,aggregateField:u,nameGen:p})}(f,e.selection,y,e.onClick,e.onHover),$=(0,r.useMemo)((()=>{var t;return{title:n,description:a,data:{name:"table"},layer:[{selection:x,mark:{type:"bar",cursor:v||w?"pointer":void 0,tooltip:!0},encoding:{color:{condition:[w?[{selection:w,value:s}]:[],v?[{selection:v,value:s}]:[]].flat(),value:l},x:{bin:!0,field:"v",type:"quantitative",title:y},y:{aggregate:"sum",field:"i",type:"quantitative",title:"Count"}}},Ht(jt(),s),...(null!==(t=e.queries)&&void 0!==t?t:[]).map(((e,t)=>t>0||null!=w||null!=v?function(e,t){return{transform:[{aggregate:[{op:"values",as:"values"}],groupby:["bin_maxbins_10_v","bin_maxbins_10_v_end"]}],mark:{type:"point",shape:"triangle-right",tooltip:!1},encoding:{color:{value:t},x:{bin:!0,band:0,field:"v",type:"quantitative"},y:{datum:{signal:e},type:"quantitative"}}}}(Tt(t),e.color):Ht(Tt(t),e.color)))],resolve:{scale:{y:"shared"}}}}),[y,n,a,s,l,e.queries,x,v,w]);return r.createElement(St.Z,Object.assign({spec:$,width:m,height:d,data:h,signalListeners:b,theme:"dark"===o?"dark":void 0,actions:u},g))}(0,Et.expressionFunction)("inSetStore",(function(e,t){return"function"==typeof e&&e(t)})),(0,Et.expressionFunction)("countInSetStore",(function(e,t,n){return"function"==typeof e&&Array.isArray(t)?t.reduce(((t,a)=>t+(e(a[n])?1:0)),0):0}));var Jt=n(8206);const Ut=(0,a.Pi)((({width:e})=>{const t=he(),n=(0,r.useCallback)((e=>e.attrs[t.ui.visXAttr]),[t.ui.visXAttr]),a=(0,r.useCallback)((e=>e.attrs[t.ui.visYAttr]),[t.ui.visYAttr]);return t.ui.visXAttr||t.ui.visYAttr?t.ui.visXAttr&&t.ui.visYAttr?r.createElement(_t,{width:e-40,height:e-40,elems:t.elems,xAttr:n,yAttr:a,actions:!1,selection:t.hover,onHover:t.setHover,onClick:t.setSelection,queries:t.visibleQueries}):r.createElement(Kt,{width:e-40,height:200,elems:t.elems,attr:n,actions:!1,selection:t.hover,onHover:t.setHover,onClick:t.setSelection,queries:t.visibleQueries}):null}));function Gt({width:e,targetRef:t}){return r.createElement("div",{ref:t},r.createElement(Ut,{width:null!=e?e:0}))}const Vt=(0,a.Pi)((()=>{const e=he(),t=(0,r.useCallback)((t=>e.ui.setVisXAttr(t.target.value)),[e]),n=(0,r.useCallback)((t=>e.ui.setVisYAttr(t.target.value)),[e]);return e.dataset&&0!==e.dataset.attrs.length?r.createElement(Oe,{id:"vis",title:"Attribute Vis"},r.createElement(je.Z,{margin:"dense",label:"X Attr",value:e.ui.visXAttr||"",select:!0,required:!0,onChange:t},r.createElement(Me.Z,{value:""},"Choose ..."),e.dataset.attrs.map((e=>r.createElement(Me.Z,{key:e,value:e},e)))),r.createElement(je.Z,{margin:"dense",label:"Y Attr",value:e.ui.visYAttr||"",select:!0,required:!0,onChange:n},r.createElement(Me.Z,{value:""},"Choose ..."),e.dataset.attrs.map((e=>r.createElement(Me.Z,{key:e,value:e},e)))),e.ui.sidePanelExpanded.has("vis")&&r.createElement(Jt.ZP,{handleWidth:!0,render:Gt})):null}));var Wt=n(6042);const Qt=(0,ve.Z)((()=>({root:{display:"flex",alignItems:"center",justifyContent:"center"}})));function Xt({children:e}){const t=Qt();return r.createElement("div",{className:t.root},null!=e?e:r.createElement(Wt.Z,null))}var Yt=n(9946);const en=(0,ve.Z)((()=>({root:{display:"flex",padding:"1rem",height:200,"& > *":{flexGrow:1}},wrapper:{position:"absolute"}}))),tn=(0,r.lazy)((()=>Promise.resolve().then(n.bind(n,9336)).then((e=>({default:e.VennDiagram}))))),nn=(0,a.Pi)((({width:e,targetRef:t})=>{const n=he(),a=en();return r.createElement("div",{ref:t},r.createElement(r.Suspense,{fallback:r.createElement(Yt.Z,null)},e>0&&r.createElement(tn,Object.assign({width:e,height:200,className:a.wrapper},n.props,{sets:n.visibleVennSets,queries:n.queriesAndSelection,selection:n.hover,onHover:n.setHover,onClick:n.setSelection,exportButtons:!1,queryLegend:!1,ref:n.ui.ref}))))}));function an({width:e,targetRef:t}){return r.createElement(nn,{width:null!=e?e:0,targetRef:t})}const rn=(0,a.Pi)((()=>{const e=he(),t=en();return r.createElement("div",{className:t.root},e.sets.length>0&&e.dataset&&r.createElement(Jt.ZP,{handleWidth:!0,render:an}),!e.dataset&&r.createElement(Xt,null,"Choose Dataset"),0===e.sets.length&&e.dataset&&r.createElement(Xt,null))})),sn=(0,a.Pi)((()=>{const e=he();return r.createElement(Oe,{id:"venn",title:"Venn Diagram"},e.ui.sidePanelExpanded.has("venn")&&r.createElement(rn,null))})),ln=(0,ve.Z)((e=>({wrapper:{overflow:"auto",position:"relative",width:"15vw",borderLeft:`1px solid ${e.palette.primary.main}`},root:{position:"absolute",left:0,width:"100%",height:"100%",display:"flex",flexDirection:"column"}}))),on=(0,a.Pi)((()=>{const e=ln();return r.createElement(Ue.Z,{className:e.wrapper},r.createElement("div",{className:e.root},r.createElement(ht,null),r.createElement($t,null),r.createElement(nt,null),r.createElement(bt,null),r.createElement(sn,null),r.createElement(Vt,null)))})),cn=(0,ve.Z)((()=>({root:{display:"flex",padding:"1rem",flexGrow:1,"& > *":{flexGrow:1}},wrapper:{position:"absolute"}}))),mn=(0,r.lazy)((()=>Promise.resolve().then(n.bind(n,9336)))),dn=(0,a.Pi)((({width:e,height:t,targetRef:n})=>{const a=he(),s=cn();return r.createElement("div",{ref:n},r.createElement(r.Suspense,{fallback:r.createElement(Yt.Z,null)},e>0&&t>0&&r.createElement(mn,Object.assign({width:e,height:t,className:s.wrapper},a.props,{sets:a.visibleSets,queries:a.queriesAndSelection,combinations:a.visibleCombinations,selection:a.hover,onHover:a.setHover,onClick:a.setSelection,exportButtons:!1,setAddons:a.visibleSetAddons,combinationAddons:a.visibleCombinationAddons,ref:a.ui.ref}))))}));function un({width:e,height:t,targetRef:n}){return r.createElement(dn,{width:null!=e?e:0,height:null!=t?t:0,targetRef:n})}const pn=(0,a.Pi)((()=>{const e=he(),t=cn();return r.createElement("div",{className:t.root},e.sets.length>0&&e.dataset&&r.createElement(Jt.ZP,{handleWidth:!0,handleHeight:!0,render:un}),!e.dataset&&r.createElement(Xt,null,"Choose Dataset"),0===e.sets.length&&e.dataset&&r.createElement(Xt,null))}));var yn=n(3800),hn=n(3175),fn=n(972),gn=n(1306),xn=n(3627),bn=n(6759),vn=n(748),wn=n(492),$n=n(8600),Sn=n(1469),En=n(4729),kn=n(6774),Cn=n(5946),On=n(3484),Nn=n(6242),An=n(4440),Mn=n(7346),Ln=n(8601);const jn=(0,ve.Z)((e=>({menuButton:{marginRight:e.spacing(2)},hide:{display:"none"},title:{},select:{marginLeft:"1rem",minWidth:"20em",color:e.palette.primary.contrastText},menu:{display:"flex",justifyContent:"space-between"},speeddial:{position:"absolute",right:e.spacing(2),bottom:-e.spacing(2)},grow:{flexGrow:1},line:{display:"flex",alignItems:"center"},file:{position:"absolute",left:-1e4,top:-1e4,visibility:"hidden"}})));function Tn(e){if(!e)return"Choose Dataset...";const t=e.setCount?`${e.setCount} sets`:null,n=e.attrs.length>0?`${e.attrs.length} attributes`:null;return t||n?`${e.name} (${[t,n].filter(Boolean).join(", ")})`:e.name}const Zn=(0,a.Pi)((({className:e})=>{var t;const n=he(),a=jn(),s=r.useRef(null),l=(0,r.useCallback)((e=>{e.preventDefault(),e.stopPropagation()}),[]),o=(0,r.useCallback)((e=>{1===e.dataTransfer.files.length&&(e.preventDefault(),n.importFile(e.dataTransfer.files[0]))}),[n]),i=(0,r.useCallback)((()=>{s.current&&s.current.click()}),[]),c=(0,r.useCallback)((e=>{const t=e.target.files[0];e.target.value="",n.importFile(t)}),[n]);return r.createElement(yn.Z,{position:"fixed",className:e},r.createElement(hn.Z,null,r.createElement(Qe.Z,{edge:"start",className:(0,Ln.Z)(a.menuButton,n.ui.menu&&a.hide),color:"inherit","aria-label":"menu",onClick:n.ui.toggleMenu},r.createElement(fn.Z,null)),r.createElement("div",{className:a.line,onDragOver:l,onDrop:o},r.createElement(we.Z,{variant:"h6",className:a.title},"UpSet.js: ",r.createElement(ft.Z,{className:a.select,onChange:(0,r.useCallback)((e=>{n.selectDataSet(e.target.value)}),[n]),value:(null===(t=n.dataset)||void 0===t?void 0:t.id)||"",renderValue:()=>Tn(n.dataset)},r.createElement(Me.Z,{value:""},"Choose Dataset..."),n.datasets.map((e=>r.createElement(Me.Z,{key:e.id,value:e.id,className:a.menu},r.createElement("span",null,Tn(e)),null!=e.uid&&r.createElement(Qe.Z,{onClick:()=>n.deleteDataSet(e),edge:"end",size:"small"},r.createElement(it.Z,null))))))),r.createElement(dt.ZP,{title:"CSV file or JSON UpSet.js Dump file"},r.createElement(Qe.Z,{onClick:i},r.createElement(An.Z,null)))),r.createElement("div",{className:a.grow},r.createElement("input",{ref:s,type:"file",className:a.file,onChange:c,accept:".json,.csv,application/json,text/csv"})),r.createElement(Cn.Z,{ariaLabel:"Export",icon:r.createElement(Nn.Z,null),direction:"left",hidden:null==n.dataset,className:a.speeddial,onClose:(0,r.useCallback)((()=>n.ui.setSpeedDial(!1)),[n]),onOpen:(0,r.useCallback)((()=>n.ui.setSpeedDial(!0)),[n]),open:n.ui.speedDial},r.createElement(On.Z,{icon:r.createElement(gn.Z,null),tooltipTitle:"PNG Image",tooltipPlacement:"bottom",onClick:n.exportPNG}),r.createElement(On.Z,{icon:r.createElement(xn.Z,null),tooltipTitle:"SVG Image",tooltipPlacement:"bottom",onClick:n.exportSVG}),r.createElement(On.Z,{icon:r.createElement(xn.Z,null),tooltipTitle:"Vega Lite Specification (static)",tooltipPlacement:"bottom",onClick:n.exportVega}),r.createElement(On.Z,{icon:r.createElement(vn.Z,null),tooltipTitle:"CSV File",tooltipPlacement:"bottom",onClick:n.exportCSV}),r.createElement(On.Z,{icon:r.createElement(bn.Z,null),tooltipTitle:"JSON File",tooltipPlacement:"bottom",onClick:n.exportJSON}),r.createElement(On.Z,{icon:r.createElement(bn.Z,null),tooltipTitle:"Static JSON File",tooltipPlacement:"bottom",onClick:n.exportStaticJSON}),r.createElement(On.Z,{icon:r.createElement(wn.Z,null),tooltipTitle:"Export to Codepen.io",tooltipPlacement:"bottom",onClick:n.exportCodepen}),r.createElement(On.Z,{icon:r.createElement($n.Z,null),tooltipTitle:"Export to JSFiddle",tooltipPlacement:"bottom",onClick:n.exportJSFiddle}),r.createElement(On.Z,{icon:r.createElement(Sn.Z,null),tooltipTitle:"Export to CodeSandbox.io",tooltipPlacement:"bottom",onClick:n.exportCodesandbox}),r.createElement(On.Z,{icon:r.createElement(En.Z,null),tooltipTitle:"Create R Script",tooltipPlacement:"bottom",onClick:n.exportR}),r.createElement(On.Z,{icon:r.createElement(kn.Z,null),tooltipTitle:"Create Jupyter Notebook",tooltipPlacement:"bottom",onClick:n.exportPython}),r.createElement(On.Z,{icon:r.createElement(Mn.Z,null),tooltipTitle:"Open Embedded Version",tooltipPlacement:"bottom",onClick:n.sharedEmbedded}))))}));var Pn=n(9992),qn=n(7632),Dn=n(9411),zn=n(7989),In=n(1589);const Bn=(0,ve.Z)((()=>({grow:{flexGrow:1}}))),Rn=(0,a.Pi)((()=>{const e=Bn(),t=he();return r.createElement(r.Fragment,null,r.createElement(mt.Z,null),r.createElement(at.Z,null,r.createElement(In.Z,null,"Options"),r.createElement(rt.Z,{button:!0,onClick:t.ui.toggleZen},r.createElement(lt.Z,null,r.createElement(Le.Z,{checked:t.ui.zen})),r.createElement(ot.Z,null,"Zen Mode")),r.createElement(rt.Z,{button:!0,onClick:t.ui.toggleTheme},r.createElement(lt.Z,null,r.createElement(Le.Z,{checked:"dark"===t.ui.theme})),r.createElement(ot.Z,null,"Dark Theme"))),r.createElement("div",{className:e.grow}),r.createElement(mt.Z,null),r.createElement(at.Z,{dense:!0,disablePadding:!0},r.createElement(In.Z,null,"About"),r.createElement(rt.Z,null,r.createElement(lt.Z,null,r.createElement(zn.Z,null)),r.createElement(ot.Z,null,"v","1.7.0")),r.createElement(rt.Z,null,r.createElement(lt.Z,null,r.createElement(Dn.Z,null)),r.createElement(ot.Z,null,r.createElement(Pn.Z,{href:"https://github.com/upsetjs/upsetjs/blob/master/LICENSE.md",target:"_blank",rel:"noopener noreferrer"},"AGPL-3.0 and commercial license available"))),r.createElement(rt.Z,null,r.createElement(lt.Z,null,r.createElement(qn.Z,null)),r.createElement(ot.Z,null,r.createElement(Pn.Z,{href:"https://www.sgratzl.com",target:"_blank",rel:"noopener noreferrer"},"Samuel Gratzl"),", 2020"))))}));var Fn=n(298),_n=n(6509);function Hn(e){return r.createElement(_n.Z,Object.assign({elevation:6,variant:"filled"},e))}const Kn=(0,a.Pi)((()=>{const e=he();return r.createElement(Fn.Z,{open:null!=e.ui.toast,autoHideDuration:6e3,onClose:e.ui.closeToast},e.ui.toast?r.createElement(Hn,{onClose:e.ui.closeToast,severity:e.ui.toast.severity},e.ui.toast.message,e.ui.toast.link&&r.createElement("a",{href:e.ui.toast.link.href,target:"_blank",rel:"noopener noreferrer"},e.ui.toast.link.alt)):void 0)}));var Jn=n(1266);const Un=(0,ve.Z)((e=>({root:{width:"100vw",height:"100vh",display:"flex",flexGrow:1},appBar:{},appBarShift:{width:"calc(100% - 240px)",marginLeft:240},menuButton:{marginRight:e.spacing(2)},hide:{display:"none"},drawer:{width:240,flexShrink:0},drawerPaper:{width:240},drawerHeader:Object.assign(Object.assign({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar),{justifyContent:"flex-end"}),content:{display:"flex",flexDirection:"column",flexGrow:1,marginLeft:-240},main:{display:"flex",flexGrow:1},contentShift:{marginLeft:0}}))),Gn=(0,a.Pi)((()=>{const e=Un(),t=he();return r.createElement("div",{className:e.root},r.createElement(Zn,{className:(0,Ln.Z)(e.appBar,{[e.appBarShift]:t.ui.menu})}),r.createElement(We.ZP,{className:e.drawer,variant:"persistent",anchor:"left",open:t.ui.menu,classes:{paper:e.drawerPaper}},r.createElement("div",{className:e.drawerHeader},r.createElement(Qe.Z,{onClick:t.ui.toggleMenu},r.createElement(Jn.Z,null))),r.createElement(Rn,null)),r.createElement("div",{className:(0,Ln.Z)(e.content,{[e.contentShift]:t.ui.menu})},r.createElement("div",{className:e.drawerHeader}),r.createElement("main",{className:e.main},!t.ui.zen&&r.createElement(Ve,null),r.createElement(pn,null),!t.ui.zen&&r.createElement(on,null))),r.createElement(Kn,null))})),Vn=(0,xe.Z)({palette:{type:"dark"}}),Wn=(0,xe.Z)({palette:{type:"light"}}),Qn=(0,a.Pi)((()=>{const e=(0,ge.Z)("(prefers-color-scheme: dark)"),t=he();return(0,r.useEffect)((()=>{null==t.ui.defaultTheme&&(t.ui.defaultTheme=e?"dark":"light")})),r.createElement(be.Z,{theme:"dark"===t.ui.defaultTheme||null==t.ui.defaultTheme&&e?Vn:Wn},r.createElement(fe.ZP,null),r.createElement(Gn,null))}));function Xn(){return r.createElement(ye,null,r.createElement(Qn,null))}},9336:(e,t,n)=>{"use strict";n.r(t),n.d(t,{asCombination:()=>r.tB,asCombinations:()=>r.Cb,asSet:()=>r.jM,asSets:()=>r.Yb,bandScale:()=>r.DE,extractFromExpression:()=>r.M0,extractSets:()=>r.Y2,fromDump:()=>r._P,fromIndicesArray:()=>r.RT,fromSetName:()=>r.ks,fromStaticDump:()=>r.B5,generateCombinations:()=>r.Qv,isCalcQuery:()=>r.Xz,isElemQuery:()=>r.AX,isGenerateSetCombinationOptions:()=>r.IZ,isSet:()=>r.DM,isSetCombination:()=>r.sm,isSetLike:()=>r.vK,isSetQuery:()=>r.DR,isUpSetQuery:()=>r.H6,linearScale:()=>r.zy,logScale:()=>r.Im,mergeColors:()=>r.ou,parseColor:()=>r.lu,queryElemOverlap:()=>r.qm,queryOverlap:()=>r.l2,setElemIntersectionFactory:()=>r.Yd,setElemOverlap:()=>r.qs,setElemOverlapFactory:()=>r.l4,setOverlap:()=>r.WO,setOverlapFactory:()=>r.iv,toDump:()=>r.yn,toIndicesArray:()=>r.nz,toKey:()=>r.I2,toStaticDump:()=>r.mH,default:()=>it,KarnaughMap:()=>Ye,KarnaughMapSkeleton:()=>at,UpSetJS:()=>De,UpSetJSSkeleton:()=>tt,VennDiagram:()=>_e,VennDiagramSkeleton:()=>nt,createVennJSAdapter:()=>lt,downloadUrl:()=>H,exportSVG:()=>_,exportVegaLite:()=>K,fillDefaults:()=>D,fillDefaultsG:()=>P,fillKarnaughMapDefaults:()=>R,fillKarnaughMapDefaultsG:()=>B,fillVennDiagramDefaults:()=>I,fillVennDiagramDefaultsG:()=>z,getDefaultTheme:()=>T,isEllipse:()=>O,propValidators:()=>ot,toUpSetJSDump:()=>G,toUpSetJSStaticDump:()=>V});var a=n(4082),r=n(2674),s=n(5337),l=n.n(s);function o(e){return Array.from(e.classList).find((e=>e.startsWith("root-"))).slice("root-".length)}function i(e,t){var n,a;return null!==(a=null===(n=e.querySelector(`titleTextStyle-${t}`))||void 0===n?void 0:n.textContent)&&void 0!==a?a:"UpSetJS"}function c(e,t){var n,a;return null!==(a=null===(n=e.querySelector(`descTextStyle-${t}`))||void 0===n?void 0:n.textContent)&&void 0!==a?a:""}const m={},d=[],u={setLabel:"16px",axisTick:"10px",chartLabel:"16px",barLabel:"10px",legend:"10px",description:"16px",title:"24px",valueLabel:"12px",exportLabel:"10px"},p=[.18,.12,.7],y=[.6,.4],h={type:"intersection",order:["cardinality:desc","name:asc"]},f=Object.keys(u),g=["axisTick","bar","barLabel","chartLabel","dot","legend","title","description","setLabel","set","valueLabel"],x=["dump","png","share","svg","vega"],b=[.7,.4],v=[.15,.3];var w={sets:[],intersections:[],bb:{x:0,y:0,width:10,height:10}},$={sets:[{cx:0,cy:0,r:5,text:{x:3.5,y:-4},align:"start",verticalAlign:"bottom"}],intersections:[{sets:[0],x1:0,y1:5,arcs:[{mode:"i",ref:0,x2:0,y2:-5,sweep:!1,large:!1},{mode:"i",ref:0,x2:0,y2:5,sweep:!1,large:!1}],text:{x:0,y:0}}],bb:{x:-5,y:-5,width:10,height:10}},S={sets:[{cx:-4,cy:0,r:5,text:{x:-7.5,y:4},align:"end",verticalAlign:"top"},{cx:4,cy:0,r:5,text:{x:7.5,y:-4},align:"start",verticalAlign:"bottom"}],intersections:[{sets:[0],x1:0,y1:-3,arcs:[{mode:"i",ref:0,x2:0,y2:3,sweep:!1,large:!0},{mode:"o",ref:1,x2:0,y2:-3,sweep:!0,large:!1}],text:{x:-4,y:0}},{sets:[1],x1:0,y1:3,arcs:[{mode:"i",ref:1,x2:0,y2:-3,sweep:!1,large:!0},{mode:"o",ref:0,x2:0,y2:3,sweep:!0,large:!1}],text:{x:4,y:0}},{sets:[0,1],x1:0,y1:3,arcs:[{mode:"i",ref:0,x2:0,y2:-3,sweep:!1,large:!1},{mode:"i",ref:1,x2:0,y2:3,sweep:!1,large:!1}],text:{x:0,y:0}}],bb:{x:-9,y:-5,width:18,height:10}},E={sets:[{cx:-3.464,cy:-2,r:5,text:{x:-7,y:-6},align:"end"},{cx:3.464,cy:-2,r:5,text:{x:7,y:-6},align:"start"},{cx:0,cy:4,r:5,text:{x:4,y:7.5},align:"start",verticalAlign:"top"}],intersections:[{sets:[0],x1:-4.855,y1:2.803,arcs:[{mode:"o",ref:2,x2:-1.39,y2:-.803,sweep:!0,large:!1},{mode:"o",ref:1,x2:0,y2:-5.606,sweep:!0,large:!1},{mode:"i",ref:0,x2:-4.855,y2:2.803,sweep:!1,large:!0}],text:{x:-4.216,y:-2.434}},{sets:[1],x1:0,y1:-5.606,arcs:[{mode:"o",ref:0,x2:1.39,y2:-.803,sweep:!0,large:!1},{mode:"o",ref:2,x2:4.855,y2:2.803,sweep:!0,large:!1},{mode:"i",ref:1,x2:0,y2:-5.606,sweep:!1,large:!0}],text:{x:4.216,y:-2.434}},{sets:[2],x1:-4.855,y1:2.803,arcs:[{mode:"o",ref:0,x2:0,y2:1.606,sweep:!1,large:!1},{mode:"o",ref:1,x2:4.855,y2:2.803,sweep:!1,large:!1},{mode:"i",ref:2,x2:-4.855,y2:2.803,sweep:!0,large:!0}],text:{x:0,y:4.869}},{sets:[0,1],x1:0,y1:-5.606,arcs:[{mode:"i",ref:1,x2:-1.39,y2:-.803,sweep:!1,large:!1},{mode:"o",ref:2,x2:1.39,y2:-.803,sweep:!0,large:!1},{mode:"i",ref:0,x2:0,y2:-5.606,sweep:!1,large:!1}],text:{x:0,y:-2.404}},{sets:[0,2],x1:-4.855,y1:2.803,arcs:[{mode:"i",ref:2,x2:-1.39,y2:-.803,sweep:!0,large:!1},{mode:"o",ref:1,x2:0,y2:1.606,sweep:!1,large:!1},{mode:"i",ref:0,x2:-4.855,y2:2.803,sweep:!0,large:!1}],text:{x:-2.082,y:1.202}},{sets:[1,2],x1:4.855,y1:2.803,arcs:[{mode:"i",ref:2,x2:1.39,y2:-.803,sweep:!1,large:!1},{mode:"o",ref:0,x2:0,y2:1.606,sweep:!0,large:!1},{mode:"i",ref:1,x2:4.855,y2:2.803,sweep:!1,large:!1}],text:{x:2.082,y:1.202}},{sets:[0,1,2],x1:1.39,y1:-.803,arcs:[{mode:"i",ref:0,x2:0,y2:1.606,sweep:!0,large:!1},{mode:"i",ref:1,x2:-1.39,y2:-.803,sweep:!0,large:!1},{mode:"i",ref:2,x2:1.39,y2:-.803,sweep:!0,large:!1}],text:{x:0,y:0}}],bb:{x:-8.464,y:-7,width:16.928,height:16}},k={sets:[{cx:.439,cy:-1.061,rx:2.5,ry:5,rotation:45,text:{x:4.5,y:-4.5},align:"start",verticalAlign:"bottom"},{cx:2.561,cy:1.061,rx:2.5,ry:5,rotation:45,text:{x:4,y:3.75},align:"start",verticalAlign:"top"},{cx:-2.561,cy:1.061,rx:2.5,ry:5,rotation:-45,text:{x:-4,y:3.7},align:"end",verticalAlign:"top"},{cx:-.439,cy:-1.061,rx:2.5,ry:5,rotation:-45,text:{x:-4.5,y:-4.5},align:"end",verticalAlign:"bottom"}],intersections:[{sets:[0],x1:0,y1:-3.94,arcs:[{ref:0,mode:"i",x2:4.328,y2:-2.828,sweep:!0,large:!1},{ref:1,mode:"o",x2:2.179,y2:-1.858,large:!1},{ref:3,mode:"o",x2:0,y2:-3.94,large:!1}],text:{x:2.914,y:-3.536}},{sets:[1],x1:4.328,y1:-2.828,arcs:[{ref:1,mode:"i",x2:0,y2:5.006,sweep:!0,large:!0},{ref:2,mode:"o",x2:1.328,y2:2.828},{ref:3,mode:"o",x2:3.108,y2:-.328},{ref:0,mode:"o",x2:4.328,y2:-2.828}],text:{x:5.036,y:-1.414}},{sets:[2],x1:0,y1:5.006,arcs:[{ref:2,mode:"i",x2:-4.328,y2:-2.828,sweep:!0,large:!0},{ref:3,mode:"o",x2:-3.108,y2:-.328},{ref:0,mode:"o",x2:-1.328,y2:2.828},{ref:1,mode:"o",x2:0,y2:5.006}],text:{x:-5.036,y:-1.414}},{sets:[3],x1:-4.328,y1:-2.828,arcs:[{ref:3,mode:"i",x2:0,y2:-3.94,sweep:!0,large:!1},{ref:0,mode:"o",x2:-2.179,y2:-1.858,large:!1},{ref:2,mode:"o",x2:-4.328,y2:-2.828,large:!1}],text:{x:-2.914,y:-3.536}},{sets:[0,1],x1:4.328,y1:-2.828,arcs:[{ref:1,mode:"i",x2:3.108,y2:-.328,sweep:!0,large:!1},{ref:3,mode:"o",x2:2.179,y2:-1.858,sweep:!1,large:!1},{ref:0,mode:"i",x2:4.328,y2:-2.828,sweep:!0,large:!1}],text:{x:3.205,y:-1.672}},{sets:[0,2],x1:-1.328,y1:2.828,arcs:[{ref:0,mode:"i",x2:-3.108,y2:-.328,sweep:!0,large:!1},{ref:3,mode:"o",x2:-.969,y2:1.755,large:!1},{ref:1,mode:"o",x2:-1.328,y2:2.828,large:!1}],text:{x:-2.212,y:1.591}},{sets:[0,3],x1:0,y1:-3.94,arcs:[{ref:3,mode:"i",x2:2.179,y2:-1.858,sweep:!0,large:!1},{ref:1,mode:"o",x2:0,y2:.188,sweep:!1,large:!1},{ref:2,mode:"o",x2:-2.179,y2:-1.858,sweep:!1,large:!1},{ref:0,mode:"i",x2:0,y2:-3.94,sweep:!0}],text:{x:0,y:-1.87}},{sets:[1,2],x1:1.328,y1:2.828,arcs:[{ref:2,mode:"i",x2:0,y2:5.006,sweep:!0,large:!1},{ref:1,mode:"i",x2:-1.328,y2:2.828,sweep:!0,large:!1},{ref:0,mode:"o",x2:0,y2:2.346,large:!1},{ref:3,mode:"o",x2:1.328,y2:2.828}],text:{x:0,y:3.393}},{sets:[1,3],x1:3.108,y1:-.328,arcs:[{ref:3,mode:"i",x2:1.328,y2:2.828,sweep:!0,large:!1},{ref:2,mode:"o",x2:.969,y2:1.755,large:!1},{ref:1,mode:"i",x2:3.108,y2:-.328,large:!1}],text:{x:2.212,y:1.591}},{sets:[2,3],x1:-3.108,y1:-.328,arcs:[{ref:3,mode:"i",x2:-4.328,y2:-2.828,sweep:!0,large:!1},{ref:2,mode:"i",x2:-2.179,y2:-1.858,sweep:!0,large:!1},{ref:0,mode:"o",x2:-3.108,y2:-.328,large:!1}],text:{x:-3.205,y:-1.672}},{sets:[0,1,2],x1:0,y1:2.346,arcs:[{ref:0,mode:"i",x2:-1.328,y2:2.828,sweep:!0,large:!1},{ref:1,mode:"i",x2:-.969,y2:1.755,sweep:!0,large:!1},{ref:3,mode:"o",x2:0,y2:2.346,large:!1}],text:{x:-.766,y:2.31}},{sets:[0,1,3],x1:2.179,y1:-1.858,arcs:[{ref:3,mode:"i",x2:3.108,y2:-.328,sweep:!0,large:!1},{ref:0,mode:"i",x2:.969,y2:1.755,sweep:!0,large:!1},{ref:2,mode:"o",x2:0,y2:.188,sweep:!1,large:!1},{ref:1,mode:"i",x2:2.179,y2:-1.858,sweep:!0}],text:{x:1.558,y:-.056}},{sets:[0,2,3],x1:-.969,y1:1.755,arcs:[{ref:3,mode:"i",x2:-3.108,y2:-.328,sweep:!0,large:!1},{ref:0,mode:"i",x2:-2.179,y2:-1.858,sweep:!0,large:!1},{ref:2,mode:"i",x2:0,y2:.188,sweep:!0,large:!1},{ref:1,mode:"o",x2:-.969,y2:1.755}],text:{x:-1.558,y:-.056}},{sets:[1,2,3],x1:1.328,y1:2.828,arcs:[{ref:3,mode:"i",x2:0,y2:2.346,sweep:!0,large:!1},{ref:0,mode:"o",x2:.969,y2:1.755,sweep:!1,large:!1},{ref:2,mode:"i",x2:1.328,y2:2.828,sweep:!0,large:!1}],text:{x:.766,y:2.31}},{sets:[0,1,2,3],x1:0,y1:.188,arcs:[{ref:2,mode:"i",x2:.969,y2:1.755,sweep:!0,large:!1},{ref:0,mode:"i",x2:0,y2:2.346,sweep:!0,large:!1},{ref:3,mode:"i",x2:-.969,y2:1.755,sweep:!0,large:!1},{ref:1,mode:"i",x2:0,y2:.188,sweep:!0}],text:{x:0,y:1.43}}],bb:{x:-6.5,y:-5,width:13,height:10}},C={sets:[{cx:.5,cy:-1,rx:2.5,ry:5,rotation:0,text:{x:2.25,y:-5},align:"start",verticalAlign:"bottom"},{cx:1.106,cy:.167,rx:2.5,ry:5,rotation:72,text:{x:4.5,y:1.5},align:"start",verticalAlign:"top"},{cx:.183,cy:1.103,rx:2.5,ry:5,rotation:144,text:{x:4,y:4},align:"start",verticalAlign:"bottom"},{cx:-.992,cy:.515,rx:2.5,ry:5,rotation:216,text:{x:-4.7,y:2},align:"end",verticalAlign:"bottom"},{cx:-.797,cy:-.785,rx:2.5,ry:5,rotation:288,text:{x:-4,y:-3.6},align:"end",verticalAlign:"bottom"}],intersections:[{sets:[0],x1:-1.653,y1:-3.541,arcs:[{ref:0,mode:"i",x2:2.857,y2:-2.666,sweep:!0,large:!1},{ref:1,mode:"o",x2:2.5,y2:-2.648,large:!1},{ref:3,mode:"o",x2:-.495,y2:-3.303,large:!1},{ref:4,mode:"o",x2:-1.653,y2:-3.541}],text:{x:.5,y:-5}},{sets:[1],x1:2.857,y1:-2.666,arcs:[{ref:1,mode:"i",x2:3.419,y2:1.893,sweep:!0,large:!1},{ref:2,mode:"o",x2:3.291,y2:1.559,large:!1},{ref:4,mode:"o",x2:2.988,y2:-1.492,large:!1},{ref:0,mode:"o",x2:2.857,y2:-2.666}],text:{x:4.91,y:-1.07}},{sets:[2],x1:3.419,y1:1.893,arcs:[{ref:2,mode:"i",x2:-.744,y2:3.837,sweep:!0,large:!1},{ref:3,mode:"o",x2:-.466,y2:3.612,large:!1},{ref:0,mode:"o",x2:2.342,y2:2.381,large:!1},{ref:1,mode:"o",x2:3.419,y2:1.893}],text:{x:2.534,y:4.339}},{sets:[3],x1:-.744,y1:3.837,arcs:[{ref:3,mode:"i",x2:-3.879,y2:.478,sweep:!0,large:!1},{ref:4,mode:"o",x2:-3.579,y2:.673,large:!1},{ref:1,mode:"o",x2:-1.54,y2:2.963,large:!1},{ref:2,mode:"o",x2:-.744,y2:3.837}],text:{x:-3.343,y:3.751}},{sets:[4],x1:-3.879,y1:.478,arcs:[{ref:4,mode:"i",x2:-1.653,y2:-3.541,sweep:!0,large:!1},{ref:0,mode:"o",x2:-1.746,y2:-3.196,large:!1},{ref:2,mode:"o",x2:-3.294,y2:-.549,large:!1},{ref:3,mode:"o",x2:-3.879,y2:.478}],text:{x:-4.601,y:-2.021}},{sets:[0,1],x1:2.5,y1:-2.648,arcs:[{ref:1,mode:"i",x2:2.857,y2:-2.666,sweep:!0,large:!1},{ref:0,mode:"i",x2:2.988,y2:-1.492,sweep:!0,large:!1},{ref:4,mode:"o",x2:2.572,y2:-1.839,large:!1},{ref:3,mode:"o",x2:2.5,y2:-2.648}],text:{x:2.741,y:-2.152}},{sets:[0,2],x1:2.342,y1:2.381,arcs:[{ref:0,mode:"i",x2:-.466,y2:3.612,sweep:!0,large:!1},{ref:3,mode:"o",x2:.257,y2:2.922,large:!1},{ref:1,mode:"o",x2:2.342,y2:2.381,large:!1}],text:{x:.5,y:3.5}},{sets:[0,3],x1:-.495,y1:-3.303,arcs:[{ref:3,mode:"i",x2:2.5,y2:-2.648,sweep:!0,large:!1},{ref:1,mode:"o",x2:1.51,y2:-2.515,large:!1},{ref:4,mode:"o",x2:-.495,y2:-3.303,large:!1}],text:{x:1.653,y:-3.125}},{sets:[0,4],x1:-1.653,y1:-3.541,arcs:[{ref:4,mode:"i",x2:-.495,y2:-3.303,sweep:!0,large:!1},{ref:3,mode:"o",x2:-.954,y2:-3.015,large:!1},{ref:2,mode:"o",x2:-1.746,y2:-3.196,large:!1},{ref:0,mode:"i",x2:-1.653,y2:-3.541}],text:{x:-1.199,y:-3.272}},{sets:[1,2],x1:3.291,y1:1.559,arcs:[{ref:2,mode:"i",x2:3.419,y2:1.893,sweep:!0,large:!1},{ref:1,mode:"i",x2:2.342,y2:2.381,sweep:!0,large:!1},{ref:0,mode:"o",x2:2.544,y2:1.878,large:!1},{ref:4,mode:"o",x2:3.291,y2:1.559}],text:{x:2.894,y:1.942}},{sets:[1,3],x1:-1.54,y1:2.963,arcs:[{ref:1,mode:"i",x2:-3.579,y2:.673,sweep:!0,large:!1},{ref:4,mode:"o",x2:-2.7,y2:1.147,large:!1},{ref:2,mode:"o",x2:-1.54,y2:2.963,large:!1}],text:{x:-3.174,y:1.557}},{sets:[1,4],x1:2.988,y1:-1.492,arcs:[{ref:4,mode:"i",x2:3.291,y2:1.559,sweep:!0,large:!1},{ref:2,mode:"o",x2:2.858,y2:.659,large:!1},{ref:0,mode:"o",x2:2.988,y2:-1.492,large:!1}],text:{x:3.483,y:.606}},{sets:[2,3],x1:-.466,y1:3.612,arcs:[{ref:3,mode:"i",x2:-.744,y2:3.837,sweep:!0,large:!1},{ref:2,mode:"i",x2:-1.54,y2:2.963,sweep:!0,large:!1},{ref:1,mode:"o",x2:-1,y2:3,large:!1},{ref:0,mode:"o",x2:-.466,y2:3.612}],text:{x:-.953,y:3.352}},{sets:[2,4],x1:-3.294,y1:-.549,arcs:[{ref:2,mode:"i",x2:-1.746,y2:-3.196,sweep:!0},{ref:0,mode:"o",x2:-1.925,y2:-2.213},{ref:3,mode:"o",x2:-3.294,y2:-.549}],text:{x:-2.462,y:-2.538}},{sets:[3,4],x1:-3.579,y1:.673,arcs:[{ref:4,mode:"i",x2:-3.879,y2:.478,sweep:!0,large:!1},{ref:3,mode:"i",x2:-3.294,y2:-.549,sweep:!0,large:!1},{ref:2,mode:"o",x2:-3.162,y2:-.024,large:!1},{ref:1,mode:"o",x2:-3.579,y2:.673}],text:{x:-3.483,y:.13}},{sets:[0,1,2],x1:2.544,y1:1.878,arcs:[{ref:0,mode:"i",x2:2.342,y2:2.381,sweep:!0,large:!1},{ref:1,mode:"i",x2:.257,y2:2.922,sweep:!0,large:!1},{ref:3,mode:"o",x2:.983,y2:2.049,large:!1},{ref:4,mode:"o",x2:2.544,y2:1.878}],text:{x:1.457,y:2.331}},{sets:[0,1,3],x1:1.51,y1:-2.515,arcs:[{ref:1,mode:"i",x2:2.5,y2:-2.648,sweep:!0,large:!1},{ref:3,mode:"i",x2:2.572,y2:-1.839,sweep:!0,large:!1},{ref:4,mode:"o",x2:1.51,y2:-2.515,large:!1}],text:{x:2.194,y:-2.334}},{sets:[0,1,4],x1:2.572,y1:-1.839,arcs:[{ref:4,mode:"i",x2:2.988,y2:-1.492,sweep:!0,large:!1},{ref:0,mode:"i",x2:2.858,y2:.659,sweep:!0,large:!1},{ref:2,mode:"o",x2:2.253,y2:-.302,large:!1},{ref:3,mode:"o",x2:2.572,y2:-1.839}],text:{x:2.667,y:-.665}},{sets:[0,2,3],x1:.257,y1:2.922,arcs:[{ref:3,mode:"i",x2:-.466,y2:3.612,sweep:!0,large:!1},{ref:0,mode:"i",x2:-1,y2:3,sweep:!0,large:!1},{ref:1,mode:"o",x2:.257,y2:2.922,large:!1}],text:{x:-.403,y:3.178}},{sets:[0,2,4],x1:-1.746,y1:-3.196,arcs:[{ref:2,mode:"i",x2:-.954,y2:-3.015,sweep:!0,large:!1},{ref:3,mode:"o",x2:-1.925,y2:-2.213,sweep:!1,large:!1},{ref:0,mode:"i",x2:-1.746,y2:-3.196,sweep:!0,large:!1}],text:{x:-1.542,y:-2.808}},{sets:[0,3,4],x1:-.495,y1:-3.303,arcs:[{ref:4,mode:"i",x2:1.51,y2:-2.515,sweep:!0,large:!1},{ref:1,mode:"o",x2:.409,y2:-2.236,large:!1},{ref:2,mode:"o",x2:-.954,y2:-3.015,large:!1},{ref:3,mode:"i",x2:-.495,y2:-3.303}],text:{x:.192,y:-2.742}},{sets:[1,2,3],x1:-1.54,y1:2.963,arcs:[{ref:2,mode:"i",x2:-2.7,y2:1.147,sweep:!0,large:!1},{ref:4,mode:"o",x2:-1.645,y2:1.568,large:!1},{ref:0,mode:"o",x2:-1,y2:3,large:!1},{ref:1,mode:"i",x2:-1.54,y2:2.963}],text:{x:-1.767,y:2.106}},{sets:[1,2,4],x1:2.858,y1:.659,arcs:[{ref:2,mode:"i",x2:3.291,y2:1.559,sweep:!0,large:!1},{ref:4,mode:"i",x2:2.544,y2:1.878,sweep:!0,large:!1},{ref:0,mode:"o",x2:2.858,y2:.659,large:!1}],text:{x:2.898,y:1.365}},{sets:[1,3,4],x1:-2.7,y1:1.147,arcs:[{ref:4,mode:"i",x2:-3.579,y2:.673,sweep:!0,large:!1},{ref:1,mode:"i",x2:-3.162,y2:-.024,sweep:!0,large:!1},{ref:2,mode:"o",x2:-2.7,y2:1.147,large:!1}],text:{x:-3.147,y:.599}},{sets:[2,3,4],x1:-3.294,y1:-.549,arcs:[{ref:3,mode:"i",x2:-1.925,y2:-2.213,sweep:!0,large:!1},{ref:0,mode:"o",x2:-2,y2:-1.08,large:!1},{ref:1,mode:"o",x2:-3.162,y2:-.024,large:!1},{ref:2,mode:"i",x2:-3.294,y2:-.549}],text:{x:-2.548,y:-1.029}},{sets:[0,1,2,3],x1:.983,y1:2.049,arcs:[{ref:3,mode:"i",x2:.257,y2:2.922,sweep:!0,large:!1},{ref:1,mode:"i",x2:-1,y2:3,sweep:!0,large:!1},{ref:0,mode:"i",x2:-1.645,y2:1.568,sweep:!0,large:!1},{ref:4,mode:"o",x2:.983,y2:2.049}],text:{x:-.407,y:2.31}},{sets:[0,1,2,4],x1:2.253,y1:-.302,arcs:[{ref:2,mode:"i",x2:2.858,y2:.659,sweep:!0,large:!1},{ref:0,mode:"i",x2:2.544,y2:1.878,sweep:!0,large:!1},{ref:4,mode:"i",x2:.983,y2:2.049,sweep:!0,large:!1},{ref:3,mode:"o",x2:2.253,y2:-.302}],text:{x:2.071,y:1.101}},{sets:[0,1,3,4],x1:1.51,y1:-2.515,arcs:[{ref:4,mode:"i",x2:2.572,y2:-1.839,sweep:!0,large:!1},{ref:3,mode:"i",x2:2.253,y2:-.302,sweep:!0,large:!1},{ref:2,mode:"o",x2:.409,y2:-2.236,sweep:!1,large:!1},{ref:1,mode:"i",x2:1.51,y2:-2.515,sweep:!0}],text:{x:1.687,y:-1.63}},{sets:[0,2,3,4],x1:-2,y1:-1.08,arcs:[{ref:0,mode:"i",x2:-1.925,y2:-2.213,sweep:!0,large:!1},{ref:3,mode:"i",x2:-.954,y2:-3.015,sweep:!0,large:!1},{ref:2,mode:"i",x2:.409,y2:-2.236,sweep:!0,large:!1},{ref:1,mode:"o",x2:-2,y2:-1.08}],text:{x:-1.028,y:-2.108}},{sets:[1,2,3,4],x1:-1.645,y1:1.568,arcs:[{ref:4,mode:"i",x2:-2.7,y2:1.147,sweep:!0,large:!1},{ref:2,mode:"i",x2:-3.162,y2:-.024,sweep:!0,large:!1},{ref:1,mode:"i",x2:-2,y2:-1.08,sweep:!0,large:!1},{ref:0,mode:"o",x2:-1.645,y2:1.568}],text:{x:-2.323,y:.327}},{sets:[0,1,2,3,4],x1:.409,y1:-2.236,arcs:[{ref:2,mode:"i",x2:2.253,y2:-.302,sweep:!0,large:!1},{ref:3,mode:"i",x2:.983,y2:2.049,sweep:!0,large:!1},{ref:4,mode:"i",x2:-1.645,y2:1.568,sweep:!0,large:!1},{ref:0,mode:"i",x2:-2,y2:-1.08,sweep:!0},{ref:1,mode:"i",x2:.409,y2:-2.236,sweep:!0}],text:{x:0,y:0}}],bb:{x:-5.5,y:-6,width:11.6,height:11.8}};function O(e){return"number"==typeof e.rx}const N={maxSets:5,compute:(e,t,n,a)=>A(e.length,n,a)};function A(e,t,n){const a=[w,$,S,E,k,C],r=a[Math.min(a.length-1,e)],s=Math.min(t/r.bb.width,n/r.bb.height),l=s*-r.bb.x+(t-s*r.bb.width)/2,o=s*-r.bb.y+(n-s*r.bb.height)/2,i=e=>l+s*e,c=e=>o+s*e;return{sets:r.sets.map((e=>Object.assign({},e,{cx:i(e.cx),cy:c(e.cy),text:{x:i(e.text.x),y:c(e.text.y)}},O(e)?{rx:e.rx*s,ry:e.ry*s}:{r:e.r*s}))),intersections:r.intersections.map((e=>({text:{x:i(e.text.x),y:c(e.text.y)},x1:i(e.x1),y1:c(e.y1),sets:e.sets,arcs:e.arcs.map((e=>Object.assign({},e,{x2:i(e.x2),y2:c(e.y2)})))})))}}const M={selectionColor:"#ffa500",color:"#000000",hasSelectionColor:"",opacity:1,hasSelectionOpacity:-1,textColor:"#000000",hoverHintColor:"#cccccc",notMemberColor:"#d3d3d3",alternatingBackgroundColor:"rgba(0,0,0,0.05)",valueTextColor:"#000000",strokeColor:"#000000",backgroundColor:"#ffffff",filled:!1},L={selectionColor:"#ffa500",color:"#cccccc",hasSelectionColor:"",opacity:1,hasSelectionOpacity:-1,textColor:"#ffffff",hoverHintColor:"#d9d9d9",notMemberColor:"#666666",alternatingBackgroundColor:"rgba(255, 255, 255, 0.2)",valueTextColor:"#ffffff",strokeColor:"#ffffff",backgroundColor:"#303030",filled:!1},j={selectionColor:"#4c78a8",color:"#4c78a8",hasSelectionColor:"#c9d6e5",opacity:1,hasSelectionOpacity:-1,textColor:"#000000",hoverHintColor:"#cccccc",notMemberColor:"#d3d3d3",alternatingBackgroundColor:"rgba(0,0,0,0.05)",valueTextColor:"#000000",strokeColor:"#000000",backgroundColor:"#ffffff",filled:!0};function T(e){return"vega"===e?j:"dark"===e?L:M}function Z(e,t,n={}){const a=T(t.theme);return Object.assign(e,{queryLegend:null!=t.queries&&t.queries.length>0,theme:"light",padding:20,selection:null,title:"",description:"",fontFamily:"sans-serif",queries:d,exportButtons:!0,className:"",fontSizes:u,classNames:m,style:m,styles:m,toKey:r.I2,tooltips:!0},a,t,n,t.fontSizes?{fontSizes:Object.assign({},u,t.fontSizes)}:m)}function P(e){return Z({barPadding:.3,dotPadding:.7,combinations:h,combinationName:null==e.combinations||(t=e.combinations,Array.isArray(t))||"union"!==e.combinations.type?"Intersection Size":"Union Size",barLabelOffset:2,setNameAxisOffset:"auto",combinationNameAxisOffset:"auto",setName:"Set Size",widthRatios:p,heightRatios:y,setLabelAlignment:"center",numericScale:"linear",bandScale:"band",childrenFactories:m,setAddons:d,combinationAddons:d,setAddonPadding:1,combinationAddonPadding:1,emptySelection:!0},e);var t}function q(e){return e.toLocaleString()}function D(e){return P(e)}function z(e){return Z({valueFormat:q,layout:N},e,{exportButtons:!1!==e.exportButtons&&Object.assign({},!0===e.exportButtons?{}:e.exportButtons,{vega:!1})})}function I(e){return z(e)}function B(e){return Z({numericScale:"linear",barPadding:.3,barLabelOffset:2,combinationName:"Intersection Size",combinationNameAxisOffset:"auto"},e,{exportButtons:!1!==e.exportButtons&&Object.assign({},!0===e.exportButtons?{}:e.exportButtons,{vega:!1})})}function R(e){return B(e)}function F(e,t){const n=e.cloneNode(!0);return n.style.backgroundColor=T(e.dataset.theme).backgroundColor,t&&Array.from(n.querySelectorAll(t)).forEach((e=>e.remove())),(new XMLSerializer).serializeToString(n)}function _(e,{type:t="png",title:n,toRemove:a}){const r=new Blob([F(e,a)],{type:"image/svg+xml;charset=utf-8"}),s=o(e),l=null!=n?n:i(e,s),c=URL.createObjectURL(r);return"svg"===t?(H(c,`${l}.${t}`,e.ownerDocument),URL.revokeObjectURL(c),Promise.resolve()):function(e,t){const n=t.ownerDocument.createElement("canvas"),a=t.getBoundingClientRect();n.width=a.width,n.height=a.height;const r=n.getContext("2d"),s=new Image(n.width,n.height);return new Promise((t=>{s.onload=()=>{r.drawImage(s,0,0);const e=n.toDataURL("image/png");t(e)},s.src=e}))}(c,e).then((n=>{H(n,`${l}.${t}`,e.ownerDocument),URL.revokeObjectURL(c)}))}function H(e,t,n){const a=n.createElement("a");a.href=e,a.style.position="absolute",a.style.left="-10000px",a.style.top="-10000px",a.download=t,n.body.appendChild(a),a.click(),a.remove()}function K(e,{title:t}={}){const n=function(e,t){var n,a,r,s,l;const m=null!==(r=e.getComputedStyle||(null===(a=null===(n=e.ownerDocument)||void 0===n?void 0:n.defaultView)||void 0===a?void 0:a.getComputedStyle))&&void 0!==r?r:window.getComputedStyle,d=o(e),u=null!=t?t:i(e,d),p=Array.from(e.querySelectorAll("[data-upset=sets] [data-cardinality]")).map((e=>({name:e.querySelector(`text.setTextStyle-${d}`).textContent,cardinality:Number.parseInt(e.dataset.cardinality,10)}))).reverse(),y=-Number.parseFloat(e.querySelector(`.sBarTextStyle-${d}`).getAttribute("dx")),h=m(e.querySelector(`.fillPrimary-${d}`)).fill,f=m(e.querySelector(`.fillNotMember-${d}`)).fill,g=m(e.querySelector("text")).fill,x=e.querySelector(`.cChartTextStyle-${d}`).textContent,b=e.querySelector(`.sChartTextStyle-${d}`).textContent,v=Array.from(e.querySelectorAll("[data-upset=cs] [data-cardinality]")).map((e=>({name:e.querySelector(`text.hoverBarTextStyle-${d}`).textContent,cardinality:Number.parseInt(e.dataset.cardinality,10),sets:Array.from(e.querySelectorAll(`.fillPrimary-${d} > title`)).map((e=>e.textContent))}))),w=e=>Number.parseFloat(e.getAttribute("transform").match(/([\d.]+),/)[1]),$=e.querySelector("[data-upset=base]"),S=w($),E=w(e.querySelector("[data-upset=csaxis]")),k=Number.parseFloat($.querySelector("g").firstElementChild.children[1].getAttribute("x2")),C=(O=e.querySelector("[data-upset=setaxis]"),Number.parseFloat(O.getAttribute("transform").match(/,([\d.]+)/)[1]));var O;const N=Number.parseFloat(e.querySelector("defs rect").getAttribute("width")),A=Number.parseFloat(e.querySelector("defs rect").getAttribute("height")),M=Number.parseFloat(e.querySelector(`[data-cardinality] circle.fillPrimary-${d}`).getAttribute("r")),L=null!=e.querySelector("[data-upset=sets-s] [data-cardinality]"),j=null!=e.querySelector("[data-upset=sets-q] [data-cardinality]"),Z=L||j;let P="orange";Z&&(Array.from(e.querySelectorAll(`[data-upset=sets-${L?"s]":"q]:first-of-type"} [data-cardinality]`)).forEach((e=>{const t=p.length-Number.parseInt(e.dataset.i,10)-1;p[t].selection=Number.parseInt(e.dataset.cardinality,10)})),Array.from(e.querySelectorAll(`[data-upset=cs-${L?"s]":"q]:first-of-type"} [data-cardinality]`)).forEach((e=>{const t=Number.parseInt(e.dataset.i,10);v[t].selection=Number.parseInt(e.dataset.cardinality,10)})),P=m(e.querySelector(`[data-upset=sets-${L?"s":"q"}] [data-cardinality]`)).fill);const q=Number.parseInt(null!==(l=null===(s=e.querySelector("[data-upset=cs-ss]"))||void 0===s?void 0:s.dataset.i)&&void 0!==l?l:"-1",10),D=q>=0?{field:"partOf",oneOf:[1,2]}:{field:"partOf",equal:1};return{$schema:"https://vega.github.io/schema/vega-lite/v4.json",title:u,description:c(e,d),datasets:{sets:p,combinations:v.map(((e,t)=>Object.assign({},e,{partOf:q===t?2:1,nsets:[""]}))).concat(v.map((e=>({name:e.name,cardinality:e.cardinality,partOf:0,sets:[""],nsets:p.filter((t=>!e.sets.includes(t.name))).map((e=>e.name))}))))},vconcat:[{hconcat:[{mark:"bar",width:E+N-40,height:C},{width:k,height:C,data:{name:"combinations"},transform:[{filter:D}],layer:[{mark:{type:"bar",tooltip:!0}},{mark:{type:"text",align:"center",baseline:"bottom",dy:-y},encoding:{text:{field:"cardinality",type:"quantitative"}}},Z&&{mark:{type:"bar",fill:P,tooltip:!0},encoding:{y:{field:"selection",type:"quantitative"}}}].filter(Boolean),encoding:{x:{field:"name",type:"ordinal",axis:null,sort:null},y:{field:"cardinality",type:"quantitative",axis:{grid:!1},title:x}}}]},{hconcat:[{width:E,height:A,data:{name:"sets"},layer:[{mark:{type:"bar",tooltip:!0}},{mark:{type:"text",align:"right",baseline:"middle",dx:-y},encoding:{text:{field:"cardinality",type:"quantitative"}}},Z&&{mark:{type:"bar",fill:P,tooltip:!0},encoding:{x:{field:"selection",type:"quantitative"}}}].filter(Boolean),encoding:{y:{field:"name",type:"ordinal",axis:null,sort:null},x:{field:"cardinality",type:"quantitative",title:b,sort:"descending",axis:{grid:!1}}}},{data:{name:"sets"},width:N,height:A,mark:{type:"text",align:"center",baseline:"middle",fontSize:Number.parseInt(m(e.querySelector(`.setTextStyle-${d}`)).fontSize,10)},encoding:{y:{field:"name",type:"ordinal",axis:null,sort:null},text:{field:"name",type:"ordinal"}}},{width:k,height:A,data:{name:"combinations"},transform:[{flatten:["sets"],as:["has_set"]},{flatten:["nsets"],as:["has_not_set"]},{calculate:"datum.has_set+datum.has_not_set",as:"set"}],layer:[{mark:{type:"circle",size:M*M*Math.PI,tooltip:!0},encoding:{color:{field:"partOf",type:"nominal",legend:null,scale:{range:[f,h].concat(q>=0?[P]:[])}},y:{field:"set",type:"ordinal",axis:null,sort:null,scale:{domain:p.map((e=>e.name))}}}},{mark:"rule",transform:[{filter:D},{calculate:"datum.sets[datum.sets.length -1]",as:"set_end"}],encoding:Object.assign({y:{field:"sets[0]",type:"ordinal",axis:null,sort:null},y2:{field:"set_end"}},q<0?{}:{color:{field:"partOf",type:"nominal",legend:null,scale:{range:[h,P]}}})}],encoding:{x:{field:"name",type:"ordinal",axis:null,sort:null}}}]}],config:{padding:S,background:T(e.dataset.theme).backgroundColor,concat:{spacing:0},view:{stroke:null},bar:{fill:h},circle:{opacity:1},rule:{stroke:h,strokeWidth:Number.parseInt(m(e.querySelector("[data-upset=cs] [data-cardinality] line")).strokeWidth,10)},axis:{labelColor:g,labelFontSize:Number.parseInt(m(e.querySelector(`.axisTextStyle-${d}`)).fontSize,10),titleColor:g,titleFontSize:Number.parseInt(m(e.querySelector(`.cChartTextStyle-${d}`)).fontSize,10)},title:{color:g},text:{fill:g,fontSize:Number.parseInt(m(e.querySelector(`.sBarTextStyle-${d}`)).fontSize,10)}}}}(e,t),a=URL.createObjectURL(new Blob([JSON.stringify(n,null,2)],{type:"application/json"}));H(a,`${n.title}.json`,e.ownerDocument),URL.revokeObjectURL(a)}const J=["bandScale","numericScale"].concat(["selectionColor","color","textColor","hoverHintColor","notMemberColor","alternatingBackgroundColor","hasSelectionColor","hasSelectionOpacity","opacity","strokeColor","valueTextColor"],["padding","barPadding","dotPadding","widthRatios","heightRatios"],["fontSizes","combinationName","setName","barLabelOffset","setNameAxisOffset","combinationNameAxisOffset","theme","fontFamily","emptySelection","exportButtons","queryLegend"]);function U(e){var t;const n=D({width:0,height:0,sets:null!==(t=e.sets)&&void 0!==t?t:[],combinations:e.combinations,theme:e.theme}),a={};return J.forEach((t=>{const r=e[t],s=n[t];if("theme"!==t||"light"===r){if(null!=r&&r!==s)if("fontSizes"===t){let e=!0;const n={};f.forEach((t=>{const a=r[t];a!==s[t]&&(n[t]=a,e=!1)})),e||(a[t]=n)}else a[t]=r}else a[t]=r})),a}function G(e,t,n,a,r){return Object.assign({$schema:"https://upset.js.org/schema.1.0.0.json",name:"string"==typeof n.title?n.title:"UpSetJS",description:"string"==typeof n.description?n.description:"",mode:r,author:a,elements:t,attrs:[],props:U(n)},e)}function V(e,t,n,a){return Object.assign({$schema:"https://upset.js.org/schema-static.1.0.0.json",name:"string"==typeof t.title?t.title:"UpSetJS",description:"string"==typeof t.description?t.description:"",mode:a,author:n,props:U(t)},e)}function W(e,t,n=!1,a){var s,l;const o=[],i=new Map;return G((0,r.yn)({sets:e.sets,queries:null!==(l=null===(s=e.queries)||void 0===s?void 0:s.filter((e=>(0,r.AX)(e)||(0,r.DR)(e))))&&void 0!==l?l:[],toElemIndex:e=>i.has(e)?i.get(e):(i.set(e,o.length),o.push(e),o.length-1),selection:e.selection&&(0,r.vK)(e.selection)?e.selection:void 0,combinations:t.cs.v,combinationOptions:Array.isArray(e.combinations)?{}:e.combinations},{compress:n?"yes":"no"}),o,e,void 0,a)}function Q(e,t,n,a){const r=W(t,n,!1,a),s=URL.createObjectURL(new Blob([JSON.stringify(r,null,2)],{type:"application/json"}));H(s,`${r.name}.json`,e.ownerDocument),URL.revokeObjectURL(s)}function X(e,t,n){const a=W(e,t,!0,n);delete a.$schema;const s=l().compressToEncodedURIComponent(JSON.stringify(a)),o=new URL("https://upset.js.org/app/embed.html");if(o.searchParams.set("p",s),o.toString().length<4096)return window.open(o.toString(),"_blank"),!0;const i=function(e,t,n=!1,a){var s,l;return V((0,r.mH)({sets:e.sets,queries:null!==(l=null===(s=e.queries)||void 0===s?void 0:s.filter((e=>(0,r.AX)(e)||(0,r.DR)(e))))&&void 0!==l?l:[],selection:e.selection&&(0,r.vK)(e.selection)?e.selection:void 0,combinations:t.cs.v},{compress:n?"yes":"no"}),e,void 0,a)}(e,t,!0,n);delete i.$schema;const c=l().compressToEncodedURIComponent(JSON.stringify(i));if(o.searchParams.set("p",c),o.toString().length<4096)return window.open(o.toString(),"_blank"),!0;o.searchParams.delete("p");const m=window.open(o.toString(),"_blank");return null==m||m.addEventListener("load",(()=>{null==m||m.postMessage(a,o.origin)})),!1}function Y(...e){return e.filter(Boolean).join(" ")}function ee(e){return`upset-${Math.random().toString(36).slice(4)}`}function te(e){return null!=e&&!Array.isArray(e)}function ne(e,t){const n=(0,r.iv)(e,t);return e=>n(e.elems).intersection}function ae(e,t){if(!e)return se;if("function"==typeof e)return e;if(Array.isArray(e))return ne(e,t);const n=e;if(n.overlap)return n.overlap.bind(n);const a=ne(n.elems,t);return e=>e.overlap?e.overlap(n):a(e)}function re(e){var t;return Array.isArray(e)?`Array(${e.length})`:"function"==typeof e?"?":null===(t=e)||void 0===t?void 0:t.name}function se(){return 0}function le(e){return null==e?10:e.endsWith("pt")?Math.floor(4/3*Number.parseInt(e,10)):Number.parseInt(e,10)}function oe(e){return"linear"===e?r.zy:"log"===e?r.Im:e}function ie(e){return Array.isArray(e)}function ce({transform:e,styleId:t,exportButtons:n,exportChart:r}){if(!n)return null;let s=0;const l=[];return!0!==n&&!1===n.svg||(s+=26,l.push(a.createElement("g",{key:"svg",className:`exportButton-${t}`,onClick:r,"data-type":"svg",transform:`translate(-${s}, 0)`},a.createElement("title",null,"Download SVG Image"),a.createElement("rect",{y:-9,width:26,height:11,rx:2,ry:2}),a.createElement("text",{className:`exportTextStyle-${t}`,x:13},"SVG"))),s+=2),!0!==n&&!1===n.png||(s+=26,l.push(a.createElement("g",{key:"png",className:`exportButton-${t}`,onClick:r,"data-type":"png",transform:`translate(-${s}, 0)`},a.createElement("title",null,"Download PNG Image"),a.createElement("rect",{y:-9,width:26,height:11,rx:2,ry:2}),a.createElement("text",{className:`exportTextStyle-${t}`,x:13},"PNG"))),s+=2),!0!==n&&!1===n.vega||(s+=34,l.push(a.createElement("g",{key:"vega",className:`exportButton-${t}`,onClick:r,"data-type":"vega",transform:`translate(-${s}, 0)`},a.createElement("title",null,"Download VEGA-Lite Specification"),a.createElement("rect",{y:-9,width:34,height:11,rx:2,ry:2}),a.createElement("text",{className:`exportTextStyle-${t}`,x:17},"VEGA"))),s+=2),!0!==n&&!1===n.dump||(s+=34,l.push(a.createElement("g",{key:"dump",className:`exportButton-${t}`,onClick:r,"data-type":"dump",transform:`translate(-${s}, 0)`},a.createElement("title",null,"Download UpSet.js JSON Dump"),a.createElement("rect",{y:-9,width:34,height:11,rx:2,ry:2}),a.createElement("text",{className:`exportTextStyle-${t}`,x:17},"DUMP"))),s+=2),!0!==n&&!1===n.share||(s+=42,l.push(a.createElement("g",{key:"share",className:`exportButton-${t}`,onClick:r,"data-type":"share",transform:`translate(-${s}, 0)`},a.createElement("title",null,"Open a shareable URL"),a.createElement("rect",{y:-9,width:42,height:11,rx:2,ry:2}),a.createElement("text",{className:`exportTextStyle-${t}`,x:21},"SHARE"))),s+=2),a.createElement("g",{className:`exportButtons-${t}`,transform:e},l)}const me=a.memo((function({queries:e,x:t,style:n,data:s}){return a.createElement("text",{transform:`translate(${t},4)`,style:n.styles.legend,className:Y(`legendTextStyle-${n.id}`,n.classNames.legend)},e.map(((e,t)=>{let n=null;return(0,r.DR)(e)?n=e.set.cardinality:(0,r.AX)(e)&&(n=e.elems instanceof Set?e.elems.size:e.elems.length),a.createElement(a.Fragment,{key:e.name},a.createElement("tspan",{className:`fillQ${t}-${s.id}`},"  ⬤ "),a.createElement("tspan",null,e.name,null!=n?`: ${s.sets.format(n)}`:""))})))})),de=a.memo((function({pos:e,spacing:t,tickSizeInner:n,orient:r,name:s,style:l}){const o="top"===r||"left"===r?-1:1;return a.createElement("g",{transform:`translate(0, ${e+.5})`},s&&a.createElement("text",{x:o*t,dy:"0.32em",className:Y(`axisTextStyle-${l.id}`,"right"===r?`startText-${l.id}`:`endText-${l.id}`,l.classNames.axisTick),style:l.styles.axisTick},s),a.createElement("line",{x2:o*n,className:`axisLine-${l.id}`}))})),ue=a.memo((function({pos:e,name:t,spacing:n,orient:r,tickSizeInner:s,style:l}){const o="top"===r||"left"===r?-1:1;return a.createElement("g",{transform:`translate(${e+.5}, 0)`},t&&a.createElement("text",{y:o*n,dy:"top"===r?"0em":"0.71em",className:Y(`axisTextStyle-${l.id}`,l.classNames.axisTick),style:l.styles.axisTick},t),a.createElement("line",{y2:o*s,className:`axisLine-${l.id}`}))}));function pe({scale:e,orient:t,tickSizeInner:n=6,tickSizeOuter:r=6,tickPadding:s=3,size:l,start:o,style:i,transform:c}){const m=Math.max(n,0)+s,d=o,u=l,p="top"===t||"left"===t?-1:1,y="left"===t||"right"===t?de:ue,h=e.ticks().map((e=>"number"==typeof e?{value:e,label:String(e)}:e));return a.createElement("g",{transform:c},h.map((r=>a.createElement(y,{key:r.value,pos:e(r.value),name:r.label,spacing:m,tickSizeInner:n,orient:t,style:i}))),a.createElement("path",{className:`axisLine-${i.id}`,d:"left"===t||"right"===t?r?`M${p*r},${d}H0.5V${u}H${p*r}`:`M0.5,${d}V${u}`:r?`M${d},${p*r}V0.5H${u}V${p*r}`:`M${d},0.5H${u}`}))}const ye=a.memo((function({width:e,text:t,dy:n,x:r,style:s,className:l}){const o=(0,a.useRef)(null),[i,c]=(0,a.useState)("string"==typeof t?[t]:[]);return(0,a.useLayoutEffect)((()=>{c("string"==typeof t?[t]:[])}),[t]),(0,a.useLayoutEffect)((()=>{if(!o.current||o.current.childElementCount>0||"string"!=typeof t)return;const n=o.current.getComputedTextLength(),a=[];let r=e,s=0;const l=o.current.getStartPositionOfChar(0);for(;n>r;){l.x=r;const n=o.current.getCharNumAtPosition(l),i=t.lastIndexOf(" ",n);if(i<s)break;a.push(t.slice(s,i+1)),s=i+1,r=o.current.getEndPositionOfChar(i+1).x+e}a.push(t.slice(s)),c(a)}),[o,t,e]),t?a.createElement("tspan",{ref:o,dy:n,style:s,x:r,className:l},i.length>1?i.map(((e,t)=>a.createElement("tspan",{key:e,x:0,dy:t>0?"1.2em":n},e))):t):null}));var he=a.memo((function({width:e,descriptionWidth:t=e,style:n}){return n.title||n.description?a.createElement("text",null,a.createElement(ye,{text:n.title,width:e,dy:"10px",className:Y(`titleTextStyle-${n.id}`,n.classNames.title),style:n.styles.title}),a.createElement(ye,{x:0,width:t,dy:n.title?"2em":"10px",text:n.description,className:Y(`descTextStyle-${n.id}`,n.classNames.description),style:n.styles.description})):null}));function fe(){}function ge(e){return e?(t,n)=>function(a){return e.call(this,t,a.nativeEvent,n.map((e=>e.createOnHandlerData?e.createOnHandlerData(t):null)))}:fe}function xe(e,t){let n=0,a=0;return r=>{let s=0;return"before"===r.position?(n+=r.size+t,s=-n):(s=e+a+t,a+=r.size+t),s}}function be(e,t,n="fill"){return t?e?Object.assign({[n]:t},e):t?{[n]:t}:void 0:e}var ve=a.memo((function({size:e,style:t,data:n}){const r=xe(e.sets.w+e.labels.w+e.cs.w,e.sets.addonPadding),s=xe(e.cs.h+e.sets.h,e.cs.addonPadding),l="auto"===t.cs.offset?n.cs.labelOffset:t.cs.offset,o="auto"===t.sets.offset?n.sets.labelOffset:t.sets.offset;return a.createElement("g",null,a.createElement(he,{style:t,width:e.cs.x-l-20}),a.createElement("g",{transform:`translate(${e.cs.x},${e.cs.y})`,"data-upset":"csaxis"},a.createElement(pe,{scale:n.cs.y,orient:"left",size:e.cs.h,start:e.cs.h-n.cs.yAxisWidth,style:t}),a.createElement("line",{x1:0,x2:e.cs.w,y1:e.cs.h+1,y2:e.cs.h+1,className:`axisLine-${t.id}`}),a.createElement("text",{className:Y(`cChartTextStyle-${t.id}`,t.classNames.chartLabel),style:t.styles.chartLabel,transform:`translate(${-l}, ${e.cs.h/2})rotate(-90)`},t.cs.name),e.cs.addons.map((e=>{const n=s(e),r=a.createElement("text",{key:e.name,className:Y(`cChartTextStyle-${t.id}`,t.classNames.chartLabel),style:t.styles.chartLabel,transform:`translate(${-l}, ${n+e.size/2})rotate(-90)`},e.name);return e.scale?a.createElement(a.Fragment,{key:e.name},a.createElement(pe,{scale:e.scale,orient:"left",size:e.size,start:0,style:t,transform:`translate(0,${n})`}),r):r}))),a.createElement("g",{transform:`translate(${e.sets.x},${e.sets.y})`,"data-upset":"setaxis"},a.createElement(pe,{scale:n.sets.x,orient:"bottom",size:e.sets.w,start:e.sets.w-n.sets.xAxisWidth,transform:`translate(0, ${e.sets.h})`,style:t}),a.createElement("text",{className:Y(`sChartTextStyle-${t.id}`,t.classNames.chartLabel),style:t.styles.chartLabel,transform:`translate(${e.sets.w/2}, ${e.sets.h+o})`},t.sets.name),e.sets.addons.map((n=>{const s=r(n),l=a.createElement("text",{key:n.name,className:Y(`sChartTextStyle-${t.id}`,t.classNames.chartLabel),style:t.styles.chartLabel,transform:`translate(${s+n.size/2}, ${e.sets.h+o})`},n.name);return n.scale?a.createElement(a.Fragment,{key:n.name},a.createElement(pe,{scale:n.scale,orient:"bottom",size:n.size,start:0,transform:`translate(${s}, ${e.sets.h})`,style:t}),l):l}))))}));const we=a.memo((function({cx:e,r:t,cy:n,name:r,className:s,style:l,fill:o}){return a.createElement("circle",{r:t,cx:e,cy:n,className:s,style:be(l,o)},r&&a.createElement("title",null,r))}));function $e(e,t,n){const a=[n(e)];for(let r=0;r<v.length&&e>t;r++)e-=t,a.push(n(e));return a}const Se=a.memo((function({d:e,h:t,className:n,data:r,size:s,style:l,children:o}){const i=$e(e.cardinality,r.cs.max,r.cs.y),c=xe(s.cs.h+s.sets.h,s.cs.addonPadding);return a.createElement("g",{transform:`translate(${r.cs.x(e)}, 0)`,onMouseEnter:t.onMouseEnter(e,s.cs.addons),onMouseLeave:t.onMouseLeave,onClick:t.onClick(e,s.cs.addons),onContextMenu:t.onContextMenu(e,s.cs.addons),onMouseMove:t.onMouseMove(e,s.cs.addons),className:n,"data-cardinality":e.cardinality},l.tooltips&&a.createElement("title",null,e.name,": ",r.cs.format(e.cardinality)),a.createElement("rect",{y:-s.cs.before,width:r.cs.bandWidth,height:s.sets.h+s.cs.h+s.cs.before+s.cs.after,className:`hoverBar-${l.id}`}),i.map(((t,n)=>{const o=n>0?Math.floor(r.cs.bandWidth*v[n-1]):0;return a.createElement("rect",{key:n,x:o,y:t,height:s.cs.h-t,width:r.cs.bandWidth-2*o,className:Y(`fillPrimary-${l.id}`,n<i.length-1&&`fillOverflow${i.length-1-n}-${l.id}`,l.classNames.bar),style:be(l.styles.bar,e.color)})})),a.createElement("text",{y:i[0]-l.barLabelOffset,x:r.cs.bandWidth/2,style:l.styles.barLabel,className:Y(`cBarTextStyle-${l.id}`,l.classNames.barLabel)},r.cs.format(e.cardinality)),a.createElement("text",{y:-l.barLabelOffset-s.cs.before,x:r.cs.bandWidth/2,style:l.styles.barLabel,className:Y(`hoverBarTextStyle-${l.id}`,l.classNames.barLabel)},e.name),r.sets.v.map(((t,n)=>r.cs.has(e,t)?null:a.createElement(we,{key:r.sets.keys[n],r:r.r,cx:r.cs.cx,cy:r.sets.y(t)+r.sets.cy,name:l.tooltips?e.name:"",style:l.styles.dot,fill:void 0,className:Y(`fillNotMember-${l.id}`,l.classNames.dot)}))),e.sets.size>1&&a.createElement("line",{x1:r.cs.cx,y1:r.sets.y(r.sets.v.find((t=>r.cs.has(e,t))))+r.sets.cy-(r.r-1),x2:r.cs.cx,y2:r.sets.y(r.sets.rv.find((t=>r.cs.has(e,t))))+r.sets.cy+(r.r-1),style:e.color?{stroke:e.color}:void 0,className:`upsetLine-${r.id}`}),r.sets.v.map(((t,n)=>{var s;return r.cs.has(e,t)?a.createElement(we,{key:r.sets.keys[n],r:r.r,cx:r.cs.cx,cy:r.sets.y(t)+r.sets.cy,name:l.tooltips?t.name:"",style:l.styles.dot,fill:null!==(s=t.color)&&void 0!==s?s:e.color,className:Y(`fillPrimary-${l.id}`,l.classNames.dot)}):null})),s.cs.addons.map((t=>a.createElement("g",{key:t.name,transform:`translate(0,${c(t)})`},t.render({set:e,width:r.cs.bandWidth,height:t.size,theme:l.theme})))),o)})),Ee=a.memo((function({d:e,i:t,h:n,className:r,size:s,data:l,style:o,children:i}){const c=$e(e.cardinality,l.sets.max,l.sets.x),m=xe(s.sets.w+s.labels.w+s.cs.w,s.sets.addonPadding),d="center"===o.setLabelAlignment?s.labels.w/2:"left"===o.setLabelAlignment?2:s.labels.w-2;return a.createElement("g",{transform:`translate(0, ${l.sets.y(e)})`,onMouseEnter:n.onMouseEnter(e,s.sets.addons),onMouseLeave:n.onMouseLeave,onClick:n.onClick(e,s.sets.addons),onContextMenu:n.onContextMenu(e,s.sets.addons),onMouseMove:n.onMouseMove(e,s.sets.addons),className:r,"data-cardinality":e.cardinality},o.tooltips&&a.createElement("title",null,e.name,": ",l.sets.format(e.cardinality)),a.createElement("rect",{x:-s.sets.before,width:s.sets.w+s.labels.w+s.cs.w+s.sets.after,height:l.sets.bandWidth,className:`hoverBar-${o.id}`}),t%2==1&&a.createElement("rect",{x:s.sets.w,width:s.labels.w+s.cs.w+s.sets.after,height:l.sets.bandWidth,className:`fillAlternating-${o.id}`}),c.map(((t,n)=>{const r=n>0?Math.floor(l.sets.bandWidth*v[n-1]):0;return a.createElement("rect",{key:n,x:t,y:r,width:s.sets.w-t,height:l.sets.bandWidth-2*r,className:Y(`fillPrimary-${o.id}`,n<c.length-1&&`fillOverflow${c.length-1-n}-${o.id}`,o.classNames.bar),style:be(o.styles.bar,e.color)})})),a.createElement("text",{x:c[0],dx:-o.barLabelOffset,y:l.sets.bandWidth/2,style:o.styles.barLabel,className:Y(`sBarTextStyle-${o.id}`,o.classNames.barLabel)},l.sets.format(e.cardinality)),a.createElement("text",{x:s.sets.w+d,y:l.sets.bandWidth/2,className:Y(`setTextStyle-${o.id}`,o.classNames.setLabel),style:o.styles.setLabel,clipPath:`url(#clip-${s.id})`},e.name),s.sets.addons.map((t=>a.createElement("g",{key:t.name,transform:`translate(${m(t)},0)`},t.render({set:e,width:t.size,height:l.sets.bandWidth,theme:o.theme})))),i)})),ke=a.memo((function({data:e,size:t,style:n,h:r,setChildrenFactory:s,combinationChildrenFactory:l}){return a.createElement("g",{className:r.hasClick?`clickAble-${n.id}`:void 0},a.createElement("g",{transform:`translate(${t.sets.x},${t.sets.y})`,"data-upset":"sets"},e.sets.v.map(((l,o)=>a.createElement(Ee,{key:e.sets.keys[o],d:l,i:o,h:r,className:r.hasClick||r.hasHover?`interactive-${n.id}`:void 0,data:e,style:n,size:t},s&&s(l))))),a.createElement("g",{transform:`translate(${t.cs.x},${t.cs.y})`,"data-upset":"cs"},e.cs.v.map(((s,o)=>a.createElement(Se,{key:e.cs.keys[o],d:s,h:r,className:r.hasClick||r.hasHover?`interactive-${n.id}`:void 0,data:e,style:n,size:t},l&&l(s))))))}));function Ce({data:e,size:t,style:n,elemOverlap:r,secondary:s,tooltip:l,suffix:o,transform:i,empty:c,combinationAddons:m}){const d=e.cs.bandWidth,u=t.cs.h+t.sets.h,p=t.cs.h,y=Y(`fill${o}`,!l&&`pnone-${n.id}`,n.classNames.bar);return a.createElement("g",{transform:i,"data-upset":s?"cs-q":"cs-s"},e.cs.v.map(((o,i)=>{const h=e.cs.x(o),f=e.cs.keys[i];if(c&&!s)return a.createElement("rect",{key:f,x:h,y:p,height:0,width:d,className:y,style:be(n.styles.bar,n.selectionColor?void 0:o.color)},l&&a.createElement("title",null));const g=r(o);if(0===g)return null;const x=$e(g,e.cs.max,e.cs.y),b=l&&a.createElement("title",null,`${o.name} ∩ ${l}: ${g}`),w=s?a.createElement("path",{key:f,transform:`translate(${h}, ${x[0]})`,d:`M0,-1 l${d},0 l0,2 l${-d},0 L-${e.triangleSize},-${e.triangleSize} L-${e.triangleSize},${e.triangleSize} Z`,className:y,"data-i":i,"data-cardinality":g,style:be(void 0,n.selectionColor?void 0:o.color)},b):x.map(((t,r)=>{const s=r>0?Math.floor(e.cs.bandWidth*v[r-1]):0;return a.createElement("rect",{key:r,x:h+s,y:t,height:p-t,width:d-2*s,"data-i":r>0?null:i,"data-cardinality":r>0?null:g,className:Y(y,r<x.length-1&&`fillOverflow${x.length-1-r}-${n.id}`),style:be(n.styles.bar,n.selectionColor?void 0:o.color)},b)})),$=xe(u,t.cs.addonPadding),S=m.map((e=>{const t=$(e),r=e.render({set:o,width:d,height:e.size,theme:n.theme});return r?a.createElement("g",{key:e.name,transform:`translate(${h},${t})`},r):null})).filter(Boolean);return 0===S.length?w:a.createElement("g",{key:f},w,S)})))}function Oe({data:e,size:t,style:n,elemOverlap:r,suffix:s,secondary:l,empty:o,tooltip:i,setAddons:c,transform:m}){const d=t.sets.w,u=t.sets.w+t.labels.w+t.cs.w,p=e.sets.bandWidth,y=Y(`fill${s}`,!i&&` pnone-${n.id}`,n.classNames.bar);return a.createElement("g",{transform:m,"data-upset":l?"sets-q":"sets-s"},e.sets.v.map(((s,m)=>{const h=e.sets.y(s),f=e.sets.keys[m];if(o&&!l)return a.createElement("rect",{key:f,x:d,y:h,width:0,height:p,className:y,style:be(n.styles.bar,n.selectionColor?void 0:s.color)},n.tooltips&&i&&a.createElement("title",null));const g=r(s);if(0===g)return null;const x=$e(g,e.sets.max,e.sets.x),b=n.tooltips&&i&&a.createElement("title",null,`${s.name} ∩ ${i}: ${g}`),w=l?a.createElement("path",{key:f,transform:`translate(${x[0]}, ${h+p})`,d:`M1,0 l0,${-p} l-2,0 l0,${p} L-${e.triangleSize},${e.triangleSize} L${e.triangleSize},${e.triangleSize} Z`,"data-i":m,"data-cardinality":g,className:y,style:be(void 0,n.selectionColor?void 0:s.color)},b):x.map(((t,r)=>{const l=r>0?Math.floor(e.sets.bandWidth*v[r-1]):0;return a.createElement("rect",{key:r,"data-i":r>0?null:m,"data-cardinality":r>0?null:g,x:t,y:h+l,width:d-t,height:p-2*l,className:Y(y,r<x.length-1&&`fillOverflow${x.length-1-r}-${n.id}`),style:be(n.styles.bar,n.selectionColor?void 0:s.color)},b)})),$=xe(u,t.sets.addonPadding),S=c.map((e=>{const t=$(e),r=e.render({set:s,width:e.size,height:p,theme:n.theme});return r?a.createElement("g",{key:e.name,transform:`translate(${t},${h})`},r):null})).filter(Boolean);return 0===S.length?w:a.createElement("g",{key:f},w,S)})))}const Ne=[];var Ae=a.memo((function({size:e,data:t,style:n,hasHover:s,secondary:l,queries:o}){const i=e.sets.addons.some((e=>null!=e.renderQuery))||e.cs.addons.some((e=>null!=e.renderQuery)),c=(0,a.useMemo)((()=>o.map((e=>Object.assign(Object.assign({},e),{overlap:(0,r.l2)(e,"intersection",t.toElemKey),elemOverlap:i?(0,r.qm)(e,"intersection",t.toElemKey):null})))),[o,i,t.toElemKey]);function m(e,t,n,a,r){return Object.assign(Object.assign({},e),{render:s=>{const l=a(s.set);return e.renderQuery?e.renderQuery(Object.assign({query:t,overlap:l,index:n,secondary:r},s)):null}})}return a.createElement("g",{className:s&&!l?`pnone-${n.id}`:void 0},a.createElement("g",{transform:`translate(${e.sets.x},${e.sets.y})`},c.map(((r,o)=>a.createElement(Oe,{key:r.name,data:t,size:e,style:n,elemOverlap:r.overlap,suffix:`Q${o}-${t.id}`,secondary:l||o>0,tooltip:s&&!(l||o>0)?void 0:r.name,setAddons:0===e.sets.addons.length?Ne:e.sets.addons.map(((e,t)=>m(e,r,t,r.elemOverlap,l||t>0)))})))),a.createElement("g",{transform:`translate(${e.cs.x},${e.cs.y})`},c.map(((r,o)=>a.createElement(Ce,{key:r.name,data:t,size:e,style:n,elemOverlap:r.overlap,suffix:`Q${o}-${t.id}`,secondary:l||o>0,tooltip:s&&!(l||o>0)?void 0:r.name,combinationAddons:0===e.cs.addons.length?Ne:e.cs.addons.map(((e,t)=>m(e,r,t,r.elemOverlap,l||t>0)))})))))}));function Me({data:e,size:t,style:n,selection:r}){if(!r||"set"!==r.type||!e.sets.keys.includes(e.toKey(r)))return null;const s=r;return a.createElement("rect",{y:e.sets.y(s),width:t.labels.w+t.cs.w+t.sets.after,height:e.sets.bandWidth,className:`selectionHint-${n.id}`})}function Le({data:e,size:t,style:n,selection:r}){const s=e.sets.bandWidth/2,l=e.cs.cx,o=e.r,i=t.sets.h+t.sets.after,c=e.cs.bandWidth;if(!r||"set"===r.type||!e.cs)return null;const m=r,d=e.cs.keys.indexOf(e.toKey(m));return d<0?null:a.createElement("g",{transform:`translate(${t.labels.w+e.cs.x(m)}, 0)`,"data-upset":"cs-ss","data-i":d},a.createElement("rect",{width:c,height:i,className:`selectionHint-${n.id}`}),m.sets.size>1&&a.createElement("line",{x1:l,y1:e.sets.y(e.sets.v.find((t=>e.cs.has(m,t))))+s-(e.r-1),x2:l,y2:e.sets.y(e.sets.rv.find((t=>e.cs.has(m,t))))+s+(e.r-1),className:`upsetSelectionLine-${e.id}`,style:be(void 0,n.selectionColor?void 0:m.color,"stroke")}),e.sets.v.filter((t=>e.cs.has(m,t))).map((t=>a.createElement(we,{key:e.toKey(t),r:1.1*o,cx:l,cy:e.sets.y(t)+s,name:n.tooltips?t.name:"",className:Y(`fillSelection-${n.id}`,`pnone-${n.id}`,n.classNames.dot),style:be(n.styles.dot,n.selectionColor?void 0:t.color)}))))}const je=[];function Te({size:e,data:t,style:n,selection:s,hasHover:l}){const o=n.emptySelection,i=ae(s,t.toElemKey),c=re(s),m=e.sets.addons.some((e=>null!=e.renderSelection))||e.cs.addons.some((e=>null!=e.renderSelection)),d=s&&"function"!=typeof s&&m?function(e,t){const n=(0,r.l4)(e,t);return e=>n(e.elems).intersection}(Array.isArray(s)?s:s.elems,t.toElemKey):null;function u(e){return Object.assign(Object.assign({},e),{render:t=>{const a=d?d(t.set):null;return e.renderSelection?e.renderSelection(Object.assign({selection:s,selectionColor:n.selectionColor||t.set.color||"orange",overlap:a},t)):null}})}return a.createElement("g",{className:l?`pnone-${n.id}`:void 0},(s||o)&&a.createElement(Ce,{data:t,size:e,style:n,transform:`translate(${e.cs.x},${e.cs.y})`,empty:o&&!s,elemOverlap:i,suffix:`Selection-${n.id}`,tooltip:l?void 0:c,combinationAddons:0===e.cs.addons.length?je:e.cs.addons.map(u)}),(s||o)&&a.createElement(Oe,{data:t,size:e,style:n,transform:`translate(${e.sets.x},${e.sets.y})`,empty:o&&!s,elemOverlap:i,suffix:`Selection-${n.id}`,tooltip:l?void 0:c,setAddons:0===e.sets.addons.length?je:e.sets.addons.map(u)}),a.createElement("g",{transform:`translate(${e.labels.x},${e.labels.y})`},te(s)&&a.createElement(Me,{data:t,size:e,style:n,selection:s}),te(s)&&a.createElement(Le,{data:t,size:e,style:n,selection:s})))}function Ze(e,t="font-size"){return e?`${t}: ${e};`:""}function Pe(e,t,n,a){const r=[];t.hasSelectionColor&&r.push(`fill: ${t.hasSelectionColor};`);const s=null!=t.hasSelectionOpacity&&t.hasSelectionOpacity>=0;return s&&r.push(`fill-opacity: ${t.hasSelectionOpacity};`),{p:Ze,root:`\n  .root-${e} {\n    ${Ze(n,"font-family")}\n  }\n  `,text:`\n  .titleTextStyle-${e} {\n    fill: ${t.textColor};\n    ${Ze(a.title)}\n  }\n  .descTextStyle-${e} {\n    fill: ${t.textColor};\n    ${Ze(a.description)}\n  }\n\n  .legendTextStyle-${e} {\n    fill: ${t.textColor};\n    ${Ze(a.legend)}\n    text-anchor: middle;\n    dominant-baseline: hanging;\n    pointer-events: none;\n  }\n  `,hasSFill:r.join(" "),hasSStroke:r.join(" ").replace("fill:","stroke:").replace("fill-","stroke-"),fill:`\n  .fillPrimary-${e} { fill: ${t.color}; fill-opacity: ${t.opacity}; }\n  .fillOverflow1-${e} { fill-opacity: ${t.opacity*b[0]}; }\n  .fillOverflow2-${e} { fill-opacity: ${t.opacity*b[1]}; }\n  ${r.length>0?`.root-${e}[data-selection] .fillPrimary-${e} { ${r.join(" ")} }`:""}\n  ${s?`\n      .root-${e}[data-selection] .fillOverflow1-${e} { fill-opacity: ${t.opacity*b[0]}; }\n      .root-${e}[data-selection] .fillOverflow2-${e} { fill-opacity: ${t.opacity*b[1]}; }`:""}\n  ${t.selectionColor?`.fillSelection-${e} { fill: ${t.selectionColor}; }`:""}\n  .fillTransparent-${e} { fill: transparent; }\n\n  .selectionHint-${e} {\n    fill: transparent;\n    pointer-events: none;\n    ${Ze(t.selectionColor,"stroke")}\n  }\n  .clickAble-${e} {\n    cursor: pointer;\n  }\n\n  .startText-${e} {\n    text-anchor: start;\n  }\n  .endText-${e} {\n    text-anchor: end;\n  }\n  .pnone-${e} {\n    pointer-events: none;\n  }`,export:`\n  .exportTextStyle-${e} {\n    fill: ${t.textColor};\n    ${Ze(a.exportLabel)}\n  }\n  .exportButtons-${e} {\n    text-anchor: middle;\n  }\n  .exportButton-${e} {\n    cursor: pointer;\n    opacity: 0.5;\n  }\n  .exportButton-${e}:hover {\n    opacity: 1;\n  }\n  .exportButton-${e} > rect {\n    fill: none;\n    stroke: ${t.textColor};\n  }\n  `}}function qe(e){const t=e.onClick;return(0,a.useMemo)((()=>({hasClick:null!=t,hasHover:null!=e.onHover,onClick:ge(t),onMouseEnter:ge(e.onHover),onContextMenu:ge(e.onContextMenu),onMouseLeave:e.onHover?t=>e.onHover(null,t.nativeEvent,[]):void 0,onMouseMove:ge(e.onMouseMove),reset:e=>t?t(null,e.nativeEvent,[]):null})),[t,e.onHover,e.onContextMenu,e.onMouseMove])}const De=a.forwardRef((function(e,t){var n;const s=D(e),{selection:l=null,queries:o=[],fontSizes:i}=s,c=(0,a.useMemo)((()=>s.id?s.id:ee((s.fontFamily,i.axisTick,i.barLabel,i.chartLabel,i.legend,i.setLabel,i.title,i.exportLabel,i.description,s.textColor,s.hoverHintColor,s.color,s.hasSelectionColor,s.selectionColor,s.notMemberColor,s.alternatingBackgroundColor,s.opacity,s.hasSelectionOpacity))),[s.id,s.fontFamily,i.axisTick,i.barLabel,i.chartLabel,i.legend,i.setLabel,i.title,i.exportLabel,i.description,s.textColor,s.hoverHintColor,s.color,s.hasSelectionColor,s.selectionColor,s.notMemberColor,s.alternatingBackgroundColor,s.opacity,s.hasSelectionOpacity]),m=(0,a.useMemo)((()=>function(e,t,n,a,r,s,l,o,i,c,m,d,u,p,y){return{theme:e,styles:t,classNames:n,cs:{name:a,offset:r},sets:{name:s,offset:l},emptySelection:m,id:o,barLabelOffset:i,selectionColor:c,title:d,description:u,tooltips:p,setLabelAlignment:y}}(s.theme,s.styles,s.classNames,s.combinationName,s.combinationNameAxisOffset,s.setName,s.setNameAxisOffset,c,s.barLabelOffset,s.selectionColor,s.emptySelection,s.title,s.description,s.tooltips,s.setLabelAlignment)),[s.theme,s.styles,s.classNames,s.barLabelOffset,s.combinationName,s.combinationNameAxisOffset,s.setName,s.setNameAxisOffset,c,s.selectionColor,s.emptySelection,s.title,s.description,s.tooltips,s.setLabelAlignment]),d=(0,a.useMemo)((()=>function(e,t,n,a,r,s,l,o,i,c,m){const d=l.reduce(((e,t)=>e+("before"===t.position?t.size+c:0)),0),u=l.reduce(((e,t)=>e+("before"!==t.position?t.size+c:0)),0),p=o.reduce(((e,t)=>e+("before"===t.position?t.size+c:0)),0),y=o.reduce(((e,t)=>e+("before"!==t.position?t.size+c:0)),0),h=t-2*n-20-y-p,f=e-2*n-d-u,g=r[0]>1?r[0]:f*r[0],x=r[1]>1?r[1]:f*r[1],b=s[0]>1?s[0]:h*s[0];return{id:i||ee(),cs:{before:p,after:y,x:d+g+x,y:p,w:f-g-x,h:b,addons:o,addonPadding:m},labels:{x:d+g,y:p+b,w:x,h:h-b},sets:{before:d,after:u,x:d,y:p+b,w:g,h:h-b,addons:l,addonPadding:c},padding:a,legend:{x:e/2},margin:n,w:e,h:t}}(s.width,s.height,s.padding,s.barPadding,s.widthRatios,s.heightRatios,s.setAddons,s.combinationAddons,s.id,s.setAddonPadding,s.combinationAddonPadding)),[s.width,s.height,s.padding,s.barPadding,s.widthRatios,s.heightRatios,s.setAddons,s.combinationAddons,s.id,s.setAddonPadding,s.combinationAddonPadding]),u=(0,a.useMemo)((()=>function(e,t,n,a,s,l,o,i,c,m,d,u,p,y,f){var g;const x=oe(a),b="band"===(v=s)?r.DE:v;var v;const w=ie(t)?t:(0,r.Qv)(e,Object.assign({toElemKey:u},h,t)),$=b(w.map(d),n.cs.w,n.padding),S=w.reduce(((e,t)=>Math.max(e,t.cardinality)),0),E=null!=f?f:S,k=E>S?0:l,C=x(E,[n.cs.h,k],{orientation:"vertical",fontSizeHint:c}),O=e=>Math.floor(l/1.4*.7*e.length),N=e=>O(C.tickFormat()(e)),A=e.reduce(((e,t)=>Math.max(e,t.cardinality)),0),M=null!=y?y:A,L=N(M);let j=N(E);for(const e of m){if(!e.scale)continue;const t=e.scale.ticks(3),n=e.scale.tickFormat();for(const e of t){const t="number"==typeof e?n(e):null!==(g=e.label)&&void 0!==g?g:n(e.value),a=O(t);a>j&&(j=a)}}const T=M>A?0:L,Z=x(M,[n.sets.w,T],{orientation:"horizontal",fontSizeHint:c}),P=e.map(d),q=b(P.slice().reverse(),n.sets.h,n.padding),D=Math.min(q.bandwidth(),$.bandwidth())/2*o,z=Math.max(2,Math.min(q.bandwidth(),$.bandwidth())/2*i);return{id:p||ee(),r:D,triangleSize:z,sets:{v:e,keys:P,rv:e.slice().reverse(),x:Z,xAxisWidth:n.sets.w-T,y:e=>q(d(e)),max:M,bandWidth:q.bandwidth(),cy:q.bandwidth()/2+n.cs.h,format:Z.tickFormat(),labelOffset:l+9+2},cs:{v:w,keys:w.map(d),x:e=>$(d(e)),max:E,y:C,yAxisWidth:n.cs.h-k,cx:$.bandwidth()/2,bandWidth:$.bandwidth(),format:C.tickFormat(),has:(e,t)=>{const n=d(t);return Array.from(e.sets).some((e=>d(e)===n))},labelOffset:j+9+6},toKey:d,toElemKey:u}}(s.sets,s.combinations,d,s.numericScale,s.bandScale,s.barLabelOffset+le(i.barLabel),s.dotPadding,s.barPadding,le(i.axisTick),s.combinationAddons,s.toKey,s.toElemKey,s.id,s.setMaxScale,s.combinationMaxScale)),[s.sets,s.combinations,d,s.numericScale,s.bandScale,s.barLabelOffset,i.barLabel,s.dotPadding,s.barPadding,i.axisTick,s.combinationAddons,s.toKey,s.toElemKey,s.id,s.setMaxScale,s.combinationMaxScale]),p=Pe(c,s,s.fontFamily,i),y=qe(s),f=`\n  ${p.root}\n  ${p.text}\n\n  .axisTextStyle-${c} {\n    fill: ${s.textColor};\n    ${p.p(i.axisTick)}\n    text-anchor: middle;\n  }\n  .barTextStyle-${c} {\n    fill: ${s.textColor};\n    ${p.p(i.barLabel)}\n  }\n  .cBarTextStyle-${c} {\n    fill: ${s.textColor};\n    ${p.p(i.barLabel)}\n    text-anchor: middle;\n  }\n  .sBarTextStyle-${c} {\n    fill: ${s.textColor};\n    ${p.p(i.barLabel)}\n    text-anchor: end;\n    dominant-baseline: central;\n  }\n  .hoverBarTextStyle-${c} {\n    ${p.p(i.barLabel)}\n    fill: ${s.hoverHintColor};\n    display: none;\n    text-anchor: middle;\n  }\n  .setTextStyle-${c} {\n    fill: ${s.textColor};\n    ${p.p(i.setLabel)}\n    text-anchor: ${function(e){var t;return null!==(t={left:"start",center:"middle",right:"end"}[e])&&void 0!==t?t:"middle"}(s.setLabelAlignment)};\n    dominant-baseline: central;\n  }\n  .cChartTextStyle-${c} {\n    fill: ${s.textColor};\n    ${p.p(i.chartLabel)}\n    text-anchor: middle;\n  }\n  .sChartTextStyle-${c} {\n    fill: ${s.textColor};\n    ${p.p(i.chartLabel)}\n    text-anchor: middle;\n    dominant-baseline: hanging;\n  }\n\n  ${p.fill}\n  .fillNotMember-${c} { fill: ${s.notMemberColor}; }\n  .fillAlternating-${c} { fill: ${s.alternatingBackgroundColor||"transparent"}; }\n\n  .axisLine-${c} {\n    fill: none;\n    stroke: ${s.textColor};\n  }\n  .hoverBar-${c} {\n    fill: transparent;\n  }\n\n  .interactive-${c}:hover > .hoverBar-${c} {\n    stroke: ${s.hoverHintColor};\n  }\n  .interactive-${c}:hover > .hoverBarTextStyle-${c} {\n    display: unset;\n  }\n\n  ${p.export}\n\n  .upsetLine-${u.id} {\n    stroke-width: ${.6*u.r};\n    stroke: ${s.color};\n    stroke-opacity: ${s.opacity};\n  }\n  ${p.hasSStroke?`.root-${c}[data-selection] .upsetLine-${u.id} { ${p.hasSStroke} }`:""}\n\n  .upsetSelectionLine-${u.id} {\n    stroke-width: ${.6*u.r*1.1};\n    ${p.p(s.selectionColor,"stroke")}\n    pointer-events: none;\n  }\n\n  ${o.map(((e,t)=>`.fillQ${t}-${u.id} {\n    fill: ${e.color};\n  }`)).join("\n")}\n  `,g=(0,a.useCallback)((t=>{const n=t.currentTarget.closest("svg"),a=t.currentTarget.dataset.type||"png";switch(a){case"vega":K(n);break;case"dump":Q(n,e,u);break;case"share":X(e,u);break;case"svg":case"png":_(n,{type:a,toRemove:`.${t.currentTarget.getAttribute("class")}`})}}),[u,e]),x=re(l);return a.createElement("svg",{id:s.id,className:Y(`root-${c}`,s.className),style:s.style,width:s.width,height:s.height,ref:t,viewBox:`0 0 ${s.width} ${s.height}`,"data-theme":null!==(n=s.theme)&&void 0!==n?n:"light","data-selection":x||void 0},a.createElement("style",null,f),a.createElement("defs",null,a.createElement("clipPath",{id:`clip-${d.id}`},a.createElement("rect",{x:d.sets.w,y:0,width:d.labels.w,height:d.sets.h}))),s.queryLegend&&a.createElement(me,{queries:o,x:d.legend.x,style:m,data:u}),a.createElement(ce,{transform:`translate(${d.w-2},${d.h-3})`,styleId:c,exportButtons:s.exportButtons,exportChart:g}),a.createElement("g",{transform:`translate(${s.padding},${s.padding})`,"data-upset":"base"},s.onClick&&a.createElement("rect",{width:d.cs.x,height:d.sets.y,onClick:y.reset,className:`fillTransparent-${c}`}),a.createElement(ve,{size:d,style:m,data:u}),a.createElement(ke,{size:d,style:m,data:u,h:y,setChildrenFactory:s.setChildrenFactory,combinationChildrenFactory:s.combinationChildrenFactory}),a.createElement(Te,{size:d,style:m,data:u,hasHover:y.hasHover,selection:l}),a.createElement(Ae,{size:d,style:m,data:u,hasHover:y.hasHover,queries:o,secondary:null!=s.onHover||null!=l})),e.children)}));function ze({rules:e,style:t,size:n,p:r,data:s,tRef:l,children:o,exportChart:i,selectionName:c,h:m}){var d,u;return a.createElement("svg",{id:r.id,className:Y(`root-${t.id}`,r.className),style:r.style,width:r.width,height:r.height,ref:l,viewBox:`0 0 ${r.width} ${r.height}`,"data-theme":null!==(d=r.theme)&&void 0!==d?d:"light","data-selection":c||void 0},a.createElement("style",null,e),r.onClick&&a.createElement("rect",{width:n.w,height:n.h,onClick:m.reset,className:`fillTransparent-${t.id}`}),r.queryLegend&&a.createElement(me,{queries:null!==(u=r.queries)&&void 0!==u?u:[],x:n.legend.x,style:t,data:s}),a.createElement(ce,{transform:`translate(${n.w-2},${n.h-3})`,styleId:t.id,exportButtons:r.exportButtons,exportChart:i}),a.createElement("g",{transform:`translate(${r.padding},${r.padding})`,"data-upset":"base"},o),r.children)}function Ie(e){var t;if(e.v>=1||e.v<=0)return null;const n=Math.round(10*e.v)/100;return a.createElement("defs",null,a.createElement("pattern",{id:e.id,width:"1",height:"0.1",patternContentUnits:"objectBoundingBox",patternTransform:`rotate(${null!==(t=e.rotate)&&void 0!==t?t:0})`},e.bgFilled&&a.createElement("rect",{x:"0",y:"0",width:"1",height:"0.1",style:{fill:e.bgFill},className:`fillPrimary-${e.styleId}`}),a.createElement("rect",{x:"0",y:"0",width:"1",height:n,className:`fill${e.suffix}`,style:e.fill?{fill:e.fill}:void 0})))}function Be({slice:e,d:t,i:n,data:r,style:s,elemOverlap:l,selected:o,selectionName:i,h:c,queries:m,size:d,fill:u,qs:p}){const y=function(e,t,n=0){return e.path?e.path:`M ${e.x1-n},${e.y1-n} ${e.arcs.map((e=>{const a=t[e.ref].l,r=O(a)?a.rx:a.r,s=O(a)?a.ry:a.r,l=O(a)?a.rotation:0;return`A ${r-n} ${s-n} ${l} ${e.large?1:0} ${e.sweep?1:0} ${e.x2-n} ${e.y2-n}`})).join(" ")}`}(e,r.sets.d),h=function(e,t){return e.text.x===t.cx?0:e.text.x>t.cx?e.text.y<=t.cy?60:-60:e.text.y<=t.cy?-60:60}(e,d.area),f=l?l(t):0,g=f===t.cardinality&&t.cardinality>0||o,x=Y(`arc-${s.id}`,0===f&&!o&&`${u?"fillPrimary":"arcP"}-${s.id}`,g&&`fillSelection-${s.id}`,s.classNames.set),b=`upset-${s.id}-${n}`,v=null!=l||null!=c.onMouseLeave,w=p.map((e=>e(t))),{title:$,tooltip:S}=function(e,t,n,r,s,l,o,i){const c=o.format(e.cardinality),m=n?`${e.name} ∩ ${n}`:e.name,d=n?`${o.format(t)}/${c}`:c;if(0===s.length)return{tooltip:`${m}: ${d}`,title:"set"===e.type?a.createElement(a.Fragment,null,a.createElement("tspan",{dy:"-0.6em"},e.name),a.createElement("tspan",{x:i,dy:"1.2em"},d)):d};if(1===s.length&&!r&&!n)return{tooltip:`${e.name} ∩ ${l[0].name}: ${o.format(s[0])}/${c}`,title:"set"===e.type?a.createElement(a.Fragment,null,a.createElement("tspan",{dy:"-0.6em"},e.name),a.createElement("tspan",{x:i,dy:"1.2em"},`${o.format(s[0])}/${c}`)):`${o.format(s[0])}/${c}`};const u=a.createElement("tspan",{x:i,dy:"1.2em"},l.map(((e,t)=>a.createElement(a.Fragment,{key:e.name},a.createElement("tspan",{className:`fillQ${t}-${o.id}`},"⬤"),a.createElement("tspan",null,` ${o.format(s[t])}/${c}${t<l.length-1?" ":""}`)))));return{tooltip:`${m}: ${d}\n${l.map(((t,n)=>`${e.name} ∩ ${t.name}: ${o.format(s[n])}/${c}`)).join("\n")}`,title:"set"===e.type?a.createElement(a.Fragment,null,a.createElement("tspan",{dy:"-1.2em"},e.name),a.createElement("tspan",{x:i,dy:"1.2em"},d),u):a.createElement(a.Fragment,null,a.createElement("tspan",{dy:"-0.6em"},d),u)}}(t,f,i,v,w,m,r,e.text.x);return a.createElement("g",null,a.createElement(Ie,{id:b,v:0===f?0:f/t.cardinality,suffix:`Selection-${s.id}`,rotate:h,bgFill:t.color,bgFilled:null!=t.color||u,fill:s.selectionColor?void 0:t.color,styleId:s.id}),a.createElement("path",{onMouseEnter:c.onMouseEnter(t,[]),onMouseLeave:c.onMouseLeave,onClick:c.onClick(t,[]),onContextMenu:c.onContextMenu(t,[]),onMouseMove:c.onMouseMove(t,[]),d:y,className:x,style:be(s.styles.set,f>0&&f<t.cardinality?`url(#${b})`:g&&s.selectionColor?void 0:t.color)},s.tooltips&&a.createElement("title",null,S)),a.createElement("text",{x:e.text.x,y:e.text.y,className:Y(`${"set"===t.type?"set":"value"}TextStyle-${s.id}`,`pnone-${s.id}`)},$))}function Re(e,t,n,a){const r=t-2*n,s=e-2*n,l=Math.min(s,r)/2;return{id:a||ee(),legend:{x:e/2},area:{w:s,h:r,cx:s/2,cy:r/2,r:l},margin:n,w:e,h:t}}function Fe(e,t,n){return(0,a.useCallback)((a=>{const r=a.currentTarget.closest("svg"),s=a.currentTarget.dataset.type||"png";switch(s){case"dump":Q(r,t,e,n);break;case"share":X(t,e,n);break;case"svg":case"png":_(r,{type:s,toRemove:`.${a.currentTarget.getAttribute("class")}`})}}),[e,t,n])}const _e=a.forwardRef((function(e,t){const n=I(e),{selection:s=null,queries:l=[],fontSizes:o}=n,i=function(e){const{selection:t=null,queries:n=[],fontSizes:s}=e,l=(0,a.useMemo)((()=>e.id?e.id:ee((e.fontFamily,s.valueLabel,s.legend,s.setLabel,s.title,s.exportLabel,s.description,e.textColor,e.color,e.hasSelectionColor,e.strokeColor,e.valueTextColor,e.selectionColor,e.opacity,e.hasSelectionOpacity))),[e.id,e.fontFamily,s.valueLabel,s.legend,s.setLabel,s.title,s.exportLabel,s.description,e.textColor,e.color,e.hasSelectionColor,e.strokeColor,e.valueTextColor,e.selectionColor,e.opacity,e.hasSelectionOpacity]),o=(0,a.useMemo)((()=>function(e,t,n,a,r,s,l,o){return{theme:e,styles:t,classNames:n,id:a,selectionColor:r,title:s,description:l,tooltips:o}}(e.theme,e.styles,e.classNames,l,e.selectionColor,e.title,e.description,e.tooltips)),[e.theme,e.styles,e.classNames,l,e.selectionColor,e.title,e.description,e.tooltips]),i=(0,a.useMemo)((()=>Re(e.width,e.height,e.padding,e.id)),[e.width,e.height,e.padding,e.id]),c=qe(e),m=null!=t&&te(t)?e.toKey(t):null,d=null==t?null:ae(t,e.toElemKey),u=re(t),p=a.useMemo((()=>n.map((t=>(0,r.l2)(t,"intersection",e.toElemKey)))),[n,e.toElemKey]),y=Pe(l,e,e.fontFamily,s);return{styleId:l,size:i,style:o,h:c,selectionKey:m,selectionName:u,selectionOverlap:d,qs:p,rulesHelper:y}}(n),{size:c,style:m,rulesHelper:d}=i,u=(0,a.useMemo)((()=>function(e,t,n,a,s,l,o,i){const c=e.length>a.maxSets?e.slice(0,a.maxSets):e,{cs:m,setKeys:d,csKeys:u}=function(e,t,n,a={min:1}){const s=e.map(t);let l=[];if(ie(n)){const s=new Map(n.map((e=>[Array.from(e.sets).map(t).sort().join("#"),e]))),o=e.map((e=>({type:"set",cardinality:0,elems:[],name:e.name,s:e})));l=(0,r.Qv)(o,Object.assign({type:"distinctIntersection",empty:!0,order:["degree:asc","group:asc"]},a)).map((e=>{const n=Array.from(e.sets).map((e=>t(e.s))).sort().join("#");return s.has(n)?s.get(n):{name:e.name,cardinality:0,degree:e.degree,elems:[],sets:new Set(Array.from(e.sets).map((e=>e.s))),type:"distinctIntersection"}}))}else l=(0,r.Qv)(e,Object.assign({type:"distinctIntersection",empty:!0,order:["degree:asc","group:asc"]},a,null!=n?n:{}));const o=l.map(t);return{cs:l,setKeys:s,csKeys:o}}(c,l,t),p=a.compute(c,m,n.area.w,n.area.h);return{id:i||ee(),sets:{d:p.sets.map(((e,t)=>({v:c[t],l:e,key:d[t]}))),v:c,format:s},format:s,cs:{d:p.intersections.map(((e,t)=>({v:m[t],l:e,key:u[t]}))),v:m,has:(e,t)=>{const n=l(t);return Array.from(e.sets).some((e=>l(e)===n))}},toKey:l,toElemKey:o}}(n.sets,n.combinations,c,n.layout,n.valueFormat,n.toKey,n.toElemKey,n.id)),[n.sets,n.combinations,c,n.valueFormat,n.toKey,n.toElemKey,n.id,n.layout]),p=`\n  ${d.root}\n  ${d.text}\n\n  .valueTextStyle-${m.id} {\n    fill: ${n.valueTextColor};\n    ${d.p(o.valueLabel)}\n    text-anchor: middle;\n    dominant-baseline: central;\n  }\n  .setTextStyle-${m.id} {\n    fill: ${n.textColor};\n    ${d.p(o.setLabel)}\n    text-anchor: middle;\n  }\n\n  .topText-${m.id} {\n    dominant-baseline: hanging;\n  }\n\n  .stroke-circle-${m.id} {\n    fill: none;\n    stroke: ${n.strokeColor};\n  }\n\n  .arc-${m.id} {\n    fill-rule: evenodd;\n  }\n  .arcP-${m.id} {\n    fill: transparent;\n    fill-opacity: ${n.opacity};\n  }\n  ${d.fill}\n  ${d.export}\n\n  ${d.hasSFill?`.root-${m.id}[data-selection] .arcP-${m.id} { ${d.hasSFill} }`:""}\n\n  ${l.map(((e,t)=>`.fillQ${t}-${u.id} {\n    fill: ${e.color};\n  }`)).join("\n")}\n  `,y=Fe(u,n,"venn"),h=u.sets.d.reduce(((e,t)=>Math.min(e,t.l.cx-(O(t.l)?t.l.rx:t.l.r))),c.area.w);return a.createElement(ze,{rules:p,style:m,selectionName:i.selectionName,size:c,p:n,data:u,tRef:t,h:i.h,exportChart:y},a.createElement(he,{style:m,width:h}),a.createElement("g",{className:Y(n.onClick&&`clickAble-${m.id}`)},u.sets.d.map(((e,t)=>a.createElement("text",{key:e.key,x:e.l.text.x,y:e.l.text.y,onClick:i.h.onClick(u.sets.v[t],[]),onMouseEnter:i.h.onMouseEnter(u.sets.v[t],[]),onMouseLeave:i.h.onMouseLeave,onContextMenu:i.h.onContextMenu(u.sets.v[t],[]),onMouseMove:i.h.onMouseMove(u.sets.v[t],[]),className:Y(`setTextStyle-${m.id}`,`${e.l.align}Text-${m.id}`,`${e.l.verticalAlign}Text-${m.id}`)},u.sets.v[t].name)))),a.createElement("g",{className:Y(n.onClick&&`clickAble-${m.id}`)},u.cs.d.map(((e,t)=>a.createElement(Be,{key:e.key,d:e.v,i:t,slice:e.l,size:c,style:m,data:u,fill:n.filled,h:i.h,selectionName:i.selectionName,selected:i.selectionKey===e.key||(0,r.DM)(s)&&u.cs.has(e.v,s),elemOverlap:i.selectionOverlap,queries:l,qs:i.qs})))),a.createElement("g",null,u.sets.d.map((e=>O(e.l)?a.createElement("ellipse",{key:e.key,rx:e.l.rx,ry:e.l.ry,transform:`translate(${e.l.cx},${e.l.cy})rotate(${e.l.rotation})`,className:Y(`stroke-circle-${m.id}`,m.classNames.set),style:m.styles.set}):a.createElement("circle",{key:e.key,cx:e.l.cx,cy:e.l.cy,r:e.l.r,className:Y(`stroke-circle-${m.id}`,m.classNames.set),style:m.styles.set})))))})),He=a.memo((function({d:e,i:t,h:n,className:r,data:s,style:l}){const o=s.cs.l[t],i=s.cs.scale(e.cardinality),c=(s.cell-s.cs.bandWidth)/2;return a.createElement("g",{transform:`translate(${o.x}, ${o.y})`,onMouseEnter:n.onMouseEnter(e,[]),onMouseLeave:n.onMouseLeave,onClick:n.onClick(e,[]),onContextMenu:n.onContextMenu(e,[]),onMouseMove:n.onMouseMove(e,[]),className:r,"data-cardinality":e.cardinality},l.tooltips&&a.createElement("title",null,e.name,": ",s.sets.format(e.cardinality)),a.createElement("rect",{width:s.cell,height:s.cell,className:`fillTransparent-${l.id}`}),a.createElement("rect",{x:c,y:i,height:s.cell-i,width:s.cs.bandWidth,className:Y(`fillPrimary-${l.id}`,l.classNames.bar),style:be(l.styles.bar,e.color)}),a.createElement("text",{y:i-l.barLabelOffset,x:s.cell/2,style:l.styles.barLabel,className:Y(`barTextStyle-${l.id}`,l.classNames.barLabel)},s.sets.format(e.cardinality)))}));function Ke(e,t,n,a){const r=e*t,s=e*n;return[a.x.map((t=>`M ${t*e},0 l0,${r}`)),a.y.map((t=>`M 0,${t*e} l${s},0`))].flat().join(" ")}var Je=a.memo((function({data:e,style:t,size:n,h:r}){const s="auto"===t.cs.offset?e.cs.labelOffset:t.cs.offset;return a.createElement("g",null,a.createElement("g",{transform:`translate(${n.w-s-2}, ${n.h-e.cell-50})`},a.createElement(pe,{scale:e.cs.scale,orient:"left",size:e.cell,start:e.cs.barLabelFontSize,style:t}),a.createElement("text",{className:Y(`cChartTextStyle-${t.id}`,t.classNames.chartLabel),style:t.styles.chartLabel,transform:`translate(${-s}, ${e.cell})rotate(-90)`},t.cs.name)),a.createElement("g",null,e.sets.l.map(((n,s)=>{const l=e.sets.v[s],o=l.name;return a.createElement("g",{key:o,onClick:r.onClick(l,[]),onMouseEnter:r.onMouseEnter(l,[]),onMouseLeave:r.onMouseLeave,onContextMenu:r.onContextMenu(l,[]),onMouseMove:r.onMouseMove(l,[]),className:Y(r.hasClick&&`clickAble-${t.id}`)},n.text.map(((e,r)=>a.createElement("text",{key:r,transform:`translate(${e.x},${e.y})${n.hor?"":"rotate(-90)"}`,className:Y(`setTextStyle-${t.id}`)},o))))})),e.sets.l.map(((n,r)=>{const s=e.sets.v[r].name;return a.createElement(a.Fragment,{key:s},n.notText.map(((e,r)=>a.createElement("text",{key:r,transform:`translate(${e.x},${e.y})${n.hor?"":"rotate(-90)"}`,className:Y(`setTextStyle-${t.id}`,`not-${t.id}`)},s))))}))),a.createElement("g",{className:Y(r.hasClick&&`clickAble-${t.id}`)},e.cs.v.map(((n,s)=>a.createElement(He,{key:e.cs.keys[s],d:n,i:s,h:r,style:t,data:e})))),a.createElement("g",{transform:`translate(${e.grid.x}, ${e.grid.y})`},e.grid.levels.map(((n,r)=>a.createElement("path",{key:r,d:Ke(e.cell,e.grid.vCells,e.grid.hCells,n),className:`gridStyle-${t.id} gridStyle-${t.id}-${r}`})))))}));function Ue({data:e,style:t,elemOverlap:n,secondary:r,tooltip:s,suffix:l,empty:o}){const i=e.cs.bandWidth,c=(e.cell-i)/2,m=Y(`fill${l}`,!s&&`pnone-${t.id}`,t.classNames.bar);return a.createElement("g",{"data-upset":r?"cs-q":"cs-s"},e.cs.v.map(((l,d)=>{const u=e.cs.l[d],p=e.cs.keys[d];if(o&&!r)return a.createElement("rect",{key:p,x:u.x+c,y:u.y+e.cell,height:0,width:i,className:m,style:be(t.styles.bar,t.selectionColor?void 0:l.color)},s&&a.createElement("title",null));const y=n(l);if(0===y)return null;const h=e.cs.scale(y),f=s&&a.createElement("title",null,`${l.name} ∩ ${s}: ${y}`);return r?a.createElement("path",{key:p,transform:`translate(${u.x+c}, ${u.y+h})`,d:`M0,-1 l${i},0 l0,2 l${-i},0 L-${e.triangleSize},-${e.triangleSize} L-${e.triangleSize},${e.triangleSize} Z`,className:m,"data-i":d,"data-cardinality":y,style:be(void 0,t.selectionColor?void 0:l.color)},f):a.createElement("rect",{key:p,x:u.x+c,y:u.y+h,height:e.cell-h,"data-i":d,"data-cardinality":y,width:i,className:m,style:be(t.styles.bar,t.selectionColor?void 0:l.color)},f)})))}var Ge=a.memo((function({data:e,style:t,hasHover:n,secondary:s,queries:l}){const o=(0,a.useMemo)((()=>l.map((t=>Object.assign(Object.assign({},t),{overlap:(0,r.l2)(t,"intersection",e.toElemKey)})))),[l,e.toElemKey]);return a.createElement("g",{className:n&&!s?`pnone-${t.id}`:void 0},o.map(((r,l)=>a.createElement(Ue,{key:r.name,data:e,style:t,elemOverlap:r.overlap,suffix:`Q${l}-${e.id}`,secondary:s||l>0,tooltip:n&&!(s||l>0)?void 0:r.name}))))}));function Ve({data:e,style:t,selection:n,hasHover:r}){const s=t.emptySelection,l=ae(n,e.toElemKey),o=re(n);return a.createElement("g",{className:r?`pnone-${t.id}`:void 0},(n||s)&&a.createElement(Ue,{data:e,style:t,empty:s&&!n,elemOverlap:l,suffix:`Selection-${t.id}`,tooltip:r?void 0:o}))}function We(e,t){return Array(e).fill(0).map(((e,n)=>t(n)))}function Qe(e){const t=Array(Math.pow(2,e)).fill(0);We(e,(e=>{const n=Math.pow(2,e);for(let e=0;e<t.length;e+=n)t[e]++}));const n=We(Math.max(e,1),(()=>[]));return t.forEach(((e,t)=>{const a=Math.max(0,e-1);n[a].push(t)})),n[n.length-1].push(t.length),n}function Xe(e,t){const n=Math.ceil(e/2),a=Math.floor(e/2),r=Math.pow(2,n),s=Math.pow(2,a),l=Math.floor(Math.min((t.width-t.labelHeight*a)/r,(t.height-t.labelHeight*n)/s)),o=(t.width-r*l-t.labelHeight*a)/2,i=(t.height-s*l-t.labelHeight*n)/2;return{xOffset:o,horizontalSets:n,yOffset:i,verticalSets:a,cell:l,xBefore:o+Math.ceil(a/2)*t.labelHeight,yBefore:i+Math.ceil(n/2)*t.labelHeight,hCells:r,vCells:s}}const Ye=a.forwardRef((function(e,t){const n=R(e),{queries:s=[],fontSizes:l,selection:o=null}=n,i=(0,a.useMemo)((()=>n.id?n.id:ee((n.fontFamily,l.axisTick,l.barLabel,l.legend,l.setLabel,l.title,l.exportLabel,l.description,n.textColor,n.color,n.hasSelectionColor,n.strokeColor,n.selectionColor,n.opacity,n.hasSelectionOpacity))),[n.id,n.fontFamily,l.axisTick,l.barLabel,l.legend,l.setLabel,l.title,l.exportLabel,l.description,n.textColor,n.color,n.hasSelectionColor,n.strokeColor,n.selectionColor,n.opacity,n.hasSelectionOpacity]),c=(0,a.useMemo)((()=>function(e,t,n,a,r,s,l,o,i,c,m,d){return{theme:e,styles:t,classNames:n,emptySelection:i,id:s,barLabelOffset:l,selectionColor:o,title:c,description:m,tooltips:d,cs:{name:a,offset:r}}}(n.theme,n.styles,n.classNames,n.combinationName,n.combinationNameAxisOffset,i,n.barLabelOffset,n.selectionColor,n.emptySelection,n.title,n.description,n.tooltips)),[n.theme,n.styles,n.classNames,n.combinationName,n.combinationNameAxisOffset,i,n.barLabelOffset,n.selectionColor,n.emptySelection,n.title,n.description,n.tooltips]),m=(0,a.useMemo)((()=>Re(n.width,n.height,n.padding,n.id)),[n.width,n.height,n.padding,n.id]),d=(0,a.useMemo)((()=>function(e,t,n,a,s,l,o,i,c,m,d,u){const p=oe(a),y=e.map(c),h=ie(t)?t:(0,r.Qv)(e,Object.assign({type:"distinctIntersection"},null!=t?t:{})),f=h.map(c),g=(e,t)=>{const n=c(t);return Array.from(e.sets).some((e=>c(e)===n))},x=Math.ceil(1.2*o),b=function(e,t,n,a){const{xBefore:r,yBefore:s,cell:l,hCells:o,vCells:i,horizontalSets:c,verticalSets:m}=Xe(e.length,a),d=function(e,t){const{xOffset:n,yOffset:a,cell:r,xBefore:s,yBefore:l,hCells:o,vCells:i}=Xe(e,t),c=t.width-n,m=t.height-a;return We(e,(e=>{const d=Math.floor(e/2),u=e%2==0,p=Math.pow(2,d),y=(u?o:i)/p/2,h=u?s:l,f=[{v:!0,x:h+y*r*.5},{v:!1,x:h+y*r*1.5}];for(let e=1;e<=d;e++){const t=y*Math.pow(2,e)*r,n=f.length-1;f.push(...f.map(((e,a)=>({v:f[n-a].v,x:e.x+t}))))}const g=d%2==1,x=Math.floor(d/2);let b=0;return b=g?(u?m:c)-t.labelHeight*(.5+x):(u?a:n)+t.labelHeight*(.5+x),u?{hor:!0,span:y,text:f.filter((e=>e.v)).map((e=>({x:e.x,y:b}))),notText:f.filter((e=>!e.v)).map((e=>({x:e.x,y:b})))}:{hor:!1,span:y,text:f.filter((e=>e.v)).map((e=>({x:b,y:e.x}))),notText:f.filter((e=>!e.v)).map((e=>({x:b,y:e.x})))}}))}(e.length,a),u=function(e,t,n,a){return e.map(((e,r)=>{const s=Math.floor(r/2),l=r%2==0,o=Math.pow(2,s),i=(l?t:n)/o/2;return(t,[n,r])=>a(t,e)?[n,r]:i>1?l?[i-1-n+i,r]:[n,i-1-r+i]:l?[n+i,r]:[n,r+i]}))}(e,o,i,n),p=t.map((e=>{const[t,n]=u.reduceRight(((t,n)=>n(e,t)),[0,0]);return{x:r+t*l,y:s+n*l}})),y=Qe(c),h=Qe(m);return{s:d,c:p,cell:l,grid:{x:r,y:s,hCells:o,vCells:i,levels:y.map(((e,t)=>({x:e,y:t<h.length?h[t]:[]})))}}}(e,h,g,{width:n.area.w,height:n.area.h,labelHeight:x}),v=null!=u?u:h.reduce(((e,t)=>Math.max(e,t.cardinality)),0),w=p(v,[b.cell,s],{orientation:"vertical",fontSizeHint:i}),$=Math.round(b.cell*(1-l)),S=Math.min(Math.max(2,$/2*l),5),E=(k=v,Math.floor(s/1.4*.7*w.tickFormat()(k).length));var k;return{id:d||ee(),grid:b.grid,sets:{keys:y,l:b.s,v:e,labelHeight:x,format:w.tickFormat()},triangleSize:S,cell:b.cell,cs:{keys:f,l:b.c,v:h,barLabelFontSize:s,has:g,scale:w,bandWidth:$,labelOffset:E+9+6},toKey:c,toElemKey:m}}(n.sets,n.combinations,m,n.numericScale,n.barLabelOffset+le(l.barLabel),n.barPadding,le(l.setLabel),le(l.axisTick),n.toKey,n.toElemKey,n.id,n.combinationMaxScale)),[n.sets,n.combinations,m,n.numericScale,n.barLabelOffset,l.barLabel,n.barPadding,l.axisTick,l.setLabel,n.toKey,n.toElemKey,n.id,n.combinationMaxScale]),u=qe(n),p=re(o),y=Pe(i,n,n.fontFamily,l),h=`\n  ${y.root}\n  ${y.text}\n\n  .axisTextStyle-${i} {\n    fill: ${n.textColor};\n    ${y.p(l.axisTick)}\n    text-anchor: end;\n  }\n  .barTextStyle-${i} {\n    fill: ${n.textColor};\n    ${y.p(l.barLabel)}\n    text-anchor: middle;\n  }\n  .setTextStyle-${c.id} {\n    fill: ${n.textColor};\n    ${y.p(l.setLabel)}\n    text-anchor: middle;\n    dominant-baseline: central;\n  }\n  .cChartTextStyle-${i} {\n    fill: ${n.textColor};\n    ${y.p(l.chartLabel)}\n  }\n\n  .not-${c.id} {\n    text-decoration: overline;\n  }\n\n  .axisLine-${i} {\n    fill: none;\n    stroke: ${n.textColor};\n  }\n\n  .gridStyle-${c.id} {\n    fill: none;\n    stroke: ${n.strokeColor};\n    stroke-linecap: round;\n  }\n  .gridStyle-${c.id}-1 {\n    stroke-width: 2;\n  }\n  .gridStyle-${c.id}-2 {\n    stroke-width: 3;\n  }\n\n  ${y.fill}\n  ${y.export}\n\n  ${s.map(((e,t)=>`.fillQ${t}-${d.id} {\n    fill: ${e.color};\n  }`)).join("\n")}\n  `,f=Fe(d,n,"kmap"),g=d.sets.l.reduce(((e,t)=>Math.min(e,t.text[0].x-d.sets.labelHeight)),m.area.w);return a.createElement(ze,{rules:h,style:c,size:m,p:n,data:d,tRef:t,selectionName:p,h:u,exportChart:f},a.createElement(he,{style:c,width:g}),a.createElement(Je,{style:c,data:d,h:u,size:m}),a.createElement(Ve,{style:c,data:d,hasHover:u.hasHover,selection:o}),a.createElement(Ge,{style:c,data:d,hasHover:u.hasHover,queries:s,secondary:u.hasHover||null!=o}))}));function et(e){var t,n,a,r;const s=null!==(t=e.color)&&void 0!==t?t:"#A6A8AB",l=null!==(n=e.secondaryColor)&&void 0!==n?n:"#E1E2E3",o=Object.assign({},e),i=null!==(a=e.background)&&void 0!==a?a:"#F4F4F4";return delete o.color,delete o.secondaryColor,delete o.background,i&&(o.style=Object.assign({background:i},null!==(r=o.style)&&void 0!==r?r:{})),{color:s,secondary:l,rest:o}}const tt=a.memo(a.forwardRef((function(e,t){const{color:n,secondary:r,rest:s}=et(e),l=[10,20,35,60,65,80,90],o=[50,30,15];return a.createElement("svg",Object.assign({viewBox:"0 0 300 200",ref:t},s),l.map(((e,t)=>a.createElement("rect",{key:t,x:85+30*t,y:e,width:20,height:100-e,fill:n}))),o.map(((e,t)=>a.createElement("rect",{key:t,x:e,y:110+30*t,width:75-e,height:20,fill:n}))),l.map(((e,t)=>o.map(((e,s)=>{const l=s===2-t||3===t&&s>0||4===t&&1!==s||5===t&&s<2||6===t;return a.createElement("circle",{key:`${t}x${s}`,cx:85+30*t+10,cy:110+30*s+10,r:10,fill:l?n:r})})))),a.createElement("rect",{x:"182",y:"150",width:"6",height:"30",fill:n}),a.createElement("rect",{x:"212",y:"120",width:"6",height:"60",fill:n}),a.createElement("rect",{x:"242",y:"120",width:"6",height:"30",fill:n}),a.createElement("rect",{x:"272",y:"120",width:"6",height:"60",fill:n}))}))),nt=a.memo(a.forwardRef((function(e,t){const{color:n,secondary:r,rest:s}=et(e),l=A(3,280,3180);return a.createElement("svg",Object.assign({viewBox:"0 0 300 200",ref:t},s),l.sets.map(((e,t)=>a.createElement("circle",{key:t,cx:e.cx,cy:e.cy+10,r:e.r,fill:r}))),l.sets.map(((e,t)=>a.createElement("circle",{key:t,cx:e.cx,cy:e.cy+10,r:e.r,stroke:n,fill:"none"}))))}))),at=a.memo(a.forwardRef((function(e,t){const{rest:n,color:r,secondary:s}=et(e),{xBefore:l,yBefore:o,cell:i,hCells:c,vCells:m}=Xe(2,{width:270,height:170,labelHeight:20}),d=c*i,u=m*i;return a.createElement("svg",Object.assign({viewBox:"0 0 300 200",ref:t,fontFamily:"sans-serif"},n),a.createElement("g",{transform:`translate(${l+10},${o+10})`},a.createElement("text",{x:.5*i,y:-3,fill:r,textAnchor:"middle"},"A"),a.createElement("text",{x:1.5*i,y:-3,fill:r,textAnchor:"middle",style:{textDecoration:"overline"}},"A"),a.createElement("text",{x:-3,y:.5*i,fill:r,textAnchor:"end",dominantBaseline:"central"},"B"),a.createElement("text",{x:-3,y:1.5*i,fill:r,textAnchor:"end",dominantBaseline:"central",style:{textDecoration:"overline"}},"B"),a.createElement("rect",{x:.1*i,y:i*(1-.9),height:.9*i,width:.8*i,fill:s}),a.createElement("rect",{x:1.1*i,y:.5*i,height:.5*i,width:.8*i,fill:s}),a.createElement("rect",{x:.1*i,y:1.74*i,height:.26*i,width:.8*i,fill:s}),a.createElement("rect",{x:1.1*i,y:1.25*i,height:.75*i,width:.8*i,fill:s}),a.createElement("path",{d:`M0,0 l${d},0 l0,${u} l${-d},0 l0,${-u} M${d/2},0 l0,${u} M0,${u/2} l${d},0`,fill:"none",stroke:r})))}))),rt=1/180*Math.PI;function st(e,t,n,a){return{x:e+Math.cos(a*rt)*n,y:t+Math.sin(a*rt)*n}}function lt(e,t){return{maxSets:1/0,compute(n,a,r,s){const l=a.map((e=>({sets:Array.from(e.sets).map((e=>e.name)),size:e.cardinality}))),o=e(l,Object.assign({},{width:r,height:s,distinct:!0},null!=t?t:{})),i=o.filter((e=>1===e.data.sets.length)),c=new Map(n.map(((e,t)=>[e.name,t]))),m=i.map((e=>e.circles[0])),d=function(e){const t=e.reduce(((e,t)=>e+t.x),0),n=e.reduce(((e,t)=>e+t.y),0);return{x:t/e.length,y:n/e.length}}(m),u=e=>({x2:e.p1.x,y2:e.p1.y,cx:e.circle.x,cy:e.circle.y,sweep:!0,large:e.width>e.circle.radius,ref:m.findIndex((t=>Math.abs(t.x-e.circle.x)<.05&&Math.abs(t.y-e.circle.y)<.05)),mode:"i"});return{sets:i.map((e=>{const t=e.circles[0],n=function(e,t){const n=e.x-t.x,a=e.y-t.y;return Math.atan2(a,n)/rt}(t,d);return{cx:t.x,cy:t.y,r:t.radius,align:n>90?"end":"start",verticalAlign:"bottom",text:st(t.x,t.y,1.1*t.radius,n)}})),intersections:o.map((e=>{const t=e.arcs,n={x:e.text.x,y:e.text.y};if(0===t.length)return{sets:e.data.sets.map((e=>c.get(e))),text:n,x1:0,y1:0,arcs:[]};if(1===t.length){const t=e.arcs[0].circle;return{sets:e.data.sets.map((e=>c.get(e))),text:n,x1:e.arcs[0].p2.x,y1:t.y-t.radius,arcs:[u(e.arcs[0]),Object.assign(u(e.arcs[0]),{y2:t.y-t.radius})],path:e.distinctPath||e.path}}return{sets:e.data.sets.map((e=>c.get(e))),text:n,x1:e.arcs[0].p2.x,y1:e.arcs[0].p2.y,arcs:e.arcs.map((e=>u(e))),path:e.distinctPath||e.path}}))}}}}var ot=Object.freeze({__proto__:null,widthRatios:function(e){return null==e||Array.isArray(e)&&e.length>=2&&e.every((e=>"number"==typeof e))},heightRatios:function(e){return null==e||Array.isArray(e)&&e.length>=1&&e.every((e=>"number"==typeof e))},setLabelAlignment:function(e){return null==e||"left"===e||"center"===e||"right"===e},sets:function(e){return Array.isArray(e)&&e.every(r.DM)},combinations:function(e){return null==e||Array.isArray(e)&&e.every(r.sm)||(0,r.IZ)(e)},selection:function(e){return null==e||Array.isArray(e)||(0,r.vK)(e)},onHover:function(e){return null==e||"function"==typeof e},onClick:function(e){return null==e||"function"==typeof e},onContextMenu:function(e){return null==e||"function"==typeof e},onMouseMove:function(e){return null==e||"function"==typeof e},queries:function(e){return!e||Array.isArray(e)&&e.every(r.H6)},stringOrFalse:function(e){return null==e||"string"==typeof e||!1===e},theme:function(e){return null==e||"light"===e||"dark"===e||"vega"===e},classNames:function(e){return null==e||Object.keys(e).every((t=>g.includes(t)&&"string"==typeof e[t]))},fontSizes:function(e){return null==e||Object.keys(e).every((t=>f.includes(t)&&"string"==typeof e[t]))},numericScale:function(e){return null==e||"linear"===e||"log"===e||"function"==typeof e},bandScale:function(e){return null==e||"band"===e||"function"==typeof e},axisOffset:function(e){return null==e||"auto"===e||"number"==typeof e},style:function(e){return null==e||"object"==typeof e},styles:function(e){return null==e||Object.keys(e).every((e=>g.includes(e)))},exportButtons:function(e){return null==e||"boolean"==typeof e||Object.keys(e).every((t=>x.includes(t)&&"boolean"==typeof e[t]))}});const it=De},2674:(e,t,n)=>{"use strict";function a(e){return e instanceof Set?e.size:e.length}function r(e,t){const n=t?new Set((e instanceof Set?Array.from(e):e).map(t)):e instanceof Set?e:new Set(e),r=n.size,s={setA:r,setB:r,union:r,intersection:r};return l=>{if(l===e)return s;let o=0;l.forEach((e=>{(t&&n.has(t(e))||!t&&n.has(e))&&o++}));const i=a(l);return{setA:r,setB:i,intersection:o,union:r+i-o}}}function s(e,t,n){if(a(e)<a(t)||e instanceof Set)return r(e,n)(t);const s=r(t,n)(e);return Object.assign({},s,{setA:s.setB,setB:s.setA})}function l(e,t){const n=t?new Set((e instanceof Set?Array.from(e):e).map(t)):e instanceof Set?e:new Set(e),a=Array.isArray(e)?e:Array.from(e),r={setA:a,setB:a,union:a,intersection:a};return s=>{if(s===e)return r;const l=[],o=a.slice();return s.forEach((e=>{t&&n.has(t(e))||!t&&n.has(e)?l.push(e):o.push(e)})),{setA:a,setB:Array.isArray(s)?s:Array.from(s),intersection:l,union:o}}}function o(e,t,n){if(a(e)<a(t)||e instanceof Set)return l(e,n)(t);const r=l(t,n)(e);return Object.assign({},r,{setA:r.setB,setB:r.setA})}function i(e,t){const n=e instanceof Set?Array.from(e):e,a=t?new Set(n.map(t)):e instanceof Set?e:new Set(e);return r=>{if(r===e)return n;const s=[];return r.forEach((e=>{(t&&a.has(t(e))||!t&&a.has(e))&&s.push(e)})),s}}function c(e){return Array.isArray(e.elems)}function m(e){return"function"==typeof e.overlap}function d(e){return null!=e.set}function u(e,t,n){if(m(e))return e.overlap;if(d(e)&&e.set.overlap)return e.set.overlap;const a=r(c(e)?e.elems:e.set.elems,n);return n=>n.overlap&&c(e)&&Array.isArray(e.elems)?n.overlap(e.elems):n.overlap&&d(e)?n.overlap(e.set):a(n.elems)[t]}function p(e,t,n){if(m(e))return()=>null;if("intersection"===t){const t=i(c(e)?e.elems:e.set.elems,n);return e=>t(e.elems)}const a=l(c(e)?e.elems:e.set.elems,n);return e=>a(e.elems)[t]}function y(e){return null!=e&&"number"==typeof e.cardinality&&"string"==typeof e.name&&Array.isArray(e.elems)}function h(e){return y(e)&&"set"===e.type}function f(e){const t=e;return y(e)&&["composite","union","intersection","distinctIntersection"].includes(t.type)&&t.sets instanceof Set&&"number"==typeof t.degree}function g(e){return h(e)||f(e)}function x(e){const t=e;return null!=e&&(null==t.type||["intersection","union"].includes(t.type))}function b(e){const t=e;return null!=e&&"string"==typeof t.name&&"string"==typeof t.color&&(c(t)||d(t)||m(t))}function v(e,t){return e.name.localeCompare(t.name)}function w(e,t){return t.cardinality-e.cardinality}function $(e,t){return e.degree-t.degree}function S(e){return(t,n)=>e.reduce(((e,a)=>0===e?a(t,n):e),0)}function E(e){return(t,n)=>-e(t,n)}function k(e){return(t,n)=>{const a=e=>e<0?Number.POSITIVE_INFINITY:e;return a(e.findIndex((e=>t.sets.has(e))))-a(e.findIndex((e=>n.sets.has(e))))}}function C(e,t=/[∩∪&|]/){const n=new Map(e.map((e=>[e.name,e])));return e=>e.name.split(t).map((e=>n.get(e.trim())))}function O(e,t,n={}){let a=t;return n.order&&(a=a.sort(function(e,t){if(!t)return v;const n=Array.isArray(t)?t:[t];return 0===n.length?v:S(n.map((t=>{switch(t){case"cardinality":case"cardinality:desc":return w;case"cardinality:asc":return E(w);case"name:desc":return E(v);case"degree":case"degree:asc":return $;case"degree:desc":return E($);case"group":case"group:asc":return k(e);case"group:desc":return E(k(e));default:return v}})))}(e,n.order))),null!=n.limit?a.slice(0,n.limit):a}function N(e,t,n){const a=n(e);return Object.assign({type:t,cardinality:e.elems.length,sets:new Set(a),degree:a.length},e)}function A(e,t,n){return e.map((e=>N(e,t,n)))}n.d(t,{tB:()=>N,Cb:()=>A,jM:()=>I,Yb:()=>R,DE:()=>Q,M0:()=>V,Y2:()=>W,_P:()=>ye,RT:()=>ue,ks:()=>C,B5:()=>ve,Qv:()=>z,Xz:()=>m,AX:()=>c,IZ:()=>x,DM:()=>h,sm:()=>f,vK:()=>g,DR:()=>d,H6:()=>b,zy:()=>se,Im:()=>me,ou:()=>j,lu:()=>L,qm:()=>p,l2:()=>u,Yd:()=>i,qs:()=>o,l4:()=>l,WO:()=>s,iv:()=>r,yn:()=>he,nz:()=>de,I2:()=>F,mH:()=>ge});const M={distinctIntersection:" ∩ ",intersection:" ∩ ",union:" ∪ ",composite:","};function L(e){if(!e)return[255,255,255];const t=e.match(/#([\da-f]{2})([\da-f]{2})([\da-f]{2})/i);if(t)return[Number.parseInt(t[1],16),Number.parseInt(t[2],16),Number.parseInt(t[3],16)];const n=e.match(/\(([\d]+)[, ]([\d]+)[, ]([\d]+)\)/i);return n?[Number.parseInt(n[1],10),Number.parseInt(n[2],10),Number.parseInt(n[3],10)]:[255,255,255]}function j(e){if(1===e.length)return e[0];if(e.every((e=>null==e)))return;const t=e.map(L),n=Math.floor(t.reduce(((e,t)=>e+t[0]),0)/t.length),a=Math.floor(t.reduce(((e,t)=>e+t[1]),0)/t.length),r=Math.floor(t.reduce(((e,t)=>e+t[2]),0)/t.length);return`#${n.toString(16)}${a.toString(16)}${r.toString(16)}`}function T(e,t,n){const a=Array.from(e).sort(((e,n)=>t.get(e)-t.get(n)));return 1===a.length?a[0].name:`(${a.map((e=>e.name)).join(n)})`}function Z(e,t,n,a,r){return{type:0===n.size?"composite":e,elems:a,color:r(Array.from(n).map((e=>e.color))),sets:n,name:t,cardinality:a.length,degree:n.size}}function P(e,t,n,a,r,s,l){const o=new Set(e.sets);t.sets.forEach((e=>o.add(e)));const i=T(o,r,M[s]);if(0===e.cardinality||0===t.cardinality)return Z(s,i,o,[],l);let c=e,m=t;e.cardinality>t.cardinality&&(c=t,m=e);const d=new Set,u=n.get(m),p=[],y=c.elems.length;for(let e=0;e<y;e++){const t=c.elems[e],n=a(t);u.has(n)&&(d.add(n),p.push(t))}const h=Z(s,i,o,p,l);return n.set(h,d),h}function q(e,t,n,a,r,s,l){const o=new Set(e.sets);t.sets.forEach((e=>o.add(e)));const i=T(o,r,M[s]);if(0===e.cardinality){const e=Z(s,i,o,t.elems,l);return n.set(e,n.get(t)),e}if(0===t.cardinality){const t=Z(s,i,o,e.elems,l);return n.set(t,n.get(e)),t}let c=e,m=t;e.cardinality>t.cardinality&&(c=t,m=e);const d=new Set(n.get(m)),u=n.get(m),p=m.elems.slice();c.elems.forEach((e=>{const t=a(e);u.has(t)||(d.add(t),p.push(e))}));const y=Z(s,i,o,p,l);return n.set(y,d),y}function D(e,t,n,a,r,s){if("number"==typeof t)return{type:"composite",elems:[],color:s?s([]):void 0,sets:new Set,name:"()",cardinality:t,overlap(e){return e===this||g(e)&&e.name===this.name&&e.cardinality===this.cardinality?this.cardinality:0},degree:0};if(Array.isArray(t))return Z(e,"()",new Set,t,s);const l=Array.from(a.values()),o=n.filter((e=>{const t=r(e);return l.every((e=>!e.has(t)))}));return Z(e,"()",new Set,o,s)}function z(e,t={}){const{type:n="intersection",min:a=0,max:r=1/0,empty:s=!1,elems:l=[],notPartOfAnySet:o,toElemKey:i,mergeColors:c=j}=t,m=[],d=new Map(e.map(((e,t)=>[e,t]))),u=new Map(e.map((e=>[e,i?new Set(e.elems.map(i)):new Set(e.elems)]))),p=i?null:u,y=i?u:null,h="union"===n?q:P;function f(t){if(t.degree<a||t.degree>r||0===t.cardinality&&!s)return;if("distinctIntersection"!==n)return void m.push(t);const l=e.filter((e=>!t.sets.has(e))),o=i?t.elems.filter((e=>{const t=i(e);return l.every((e=>!y.get(e).has(t)))})):t.elems.filter((e=>l.every((t=>!p.get(t).has(e)))));if(o.length===t.cardinality)return void m.push(t);const d=Z(n,t.name,t.sets,o,c);(0!==d.cardinality||s)&&m.push(d)}function g(e,t,a,l){if(t>r)return;const o=e.length;for(let r=0;r<o;r++){const i=e[r],m=[];for(let t=r+1;t<o;t++){const r=e[t],o=h(i,r,a,l,d,n,c);f(o),("union"===n||o.cardinality>0||s)&&m.push(o)}m.length>1&&g(m,t+1,a,l)}}a<=0&&f(i?D(n,o,l,y,i,c):D(n,o,l,p,(e=>e),c));const x=e.map((e=>{const t=Z(n,e.name,new Set([e]),e.elems,c);return u.set(t,u.get(e)),f(t),t}));return i?g(x,2,y,i):g(x,2,p,(e=>e)),O(e,m,t)}function I(e){return Object.assign({type:"set",cardinality:e.elems.length},e)}function B(e,t={}){let n=e;if(t.order){const e=function(e){if(!e)return v;switch(e){case"cardinality":case"cardinality:desc":return S([w,v]);case"cardinality:asc":return S([E(w),v]);case"name:desc":return E(v);default:return v}}(t.order);n=n.slice().sort(e)}return null!=t.limit?n.slice(0,t.limit):n}function R(e,t={}){return B(e.map(I),t)}function F(e){return`${e.name}:${e.type}#${e.cardinality}`}function _(e){return 0===e.sets.size}function H(e,t,n=F){const a={done:null,aKey:"",bKey:"",aIsSet:!1,bIsSet:!1,toKey:n};return e===t?(a.done=e.cardinality,a):0===e.cardinality||0===t.cardinality?(a.done=0,a):(a.aKey=n(e),a.bKey=n(t),a.aKey===a.bKey?(a.done=e.cardinality,a):(a.aIsSet=h(e),a.bIsSet=h(t),!a.aIsSet&&_(e)||!a.bIsSet&&_(t)?(a.done=0,a):a))}function K(e,t){return!(t.bIsSet||!t.aIsSet)&&Array.from(e.sets).map(t.toKey).includes(t.aKey)}function J(e,t){return!(!t.bIsSet||t.aIsSet)&&Array.from(e.sets).map(t.toKey).includes(t.bKey)}function U(e,t=F){return e.map((e=>{const n=Array.from(e.sets).map(t).sort();return{key:n.join("&"),s:n,sets:new Set(n),degree:e.degree,cardinality:e.cardinality}}))}function G(e,t,n){const a=new Set;if(n.aIsSet)a.add(n.aKey);else for(const t of Array.from(e.sets))a.add(n.toKey(t));if(n.bIsSet)a.add(n.bKey);else for(const e of Array.from(t.sets))a.add(n.toKey(e));return Array.from(a).sort().join("&")}function V(e,t,n={}){var a,r,s;const l="function"==typeof t?t:e=>e.sets,o=null!==(a="function"!=typeof t?t:n)&&void 0!==a?a:{},i=null!==(r=o.type)&&void 0!==r?r:"intersection",c=null!==(s=o.joiner)&&void 0!==s?s:M[i],m=[],d=new Map;let u=null;function p(e){return this===e?this.cardinality:null==u?0:u(this,e)}const y=e.map((e=>{const t=l(e),n=t.map((e=>{if(d.has(e))return d.get(e);const t={cardinality:0,elems:[],name:e,type:"set",overlap:p};return m.push(t),d.set(t.name,t),t}));if("distinctIntersection"===i)for(const t of n)t.cardinality+=e.cardinality;else if(1===t.length)Object.assign(n[0],{cardinality:e.cardinality},e);else if("intersection"===i)for(const t of n)t.cardinality=Math.max(t.cardinality,e.cardinality);else if("union"===i)for(const t of n)t.cardinality=Math.min(t.cardinality,e.cardinality);const a=t.join(c);return Object.assign({type:i,elems:[],name:a,overlap:p},e,{cardinality:e.cardinality,degree:t.length,sets:new Set(n)})})),h=B(m,{order:o.setOrder}),f=O(h,y,{order:o.combinationOrder});switch(i){case"distinctIntersection":u=function(e,t=F){const n=new Map;for(const a of U(e,t))for(const e of a.s)n.has(e)?n.get(e).push(a):n.set(e,[a]);return(e,a)=>{const r=H(e,a,t);if(null!=r.done)return r.done;if(!r.aIsSet&&!r.bIsSet)return 0;if(r.aIsSet&&!r.bIsSet)return K(a,r)?a.cardinality:0;if(!r.aIsSet&&r.bIsSet)return J(e,r)?e.cardinality:0;const s=n.get(r.aKey),l=n.get(r.bKey);return s&&l?s.length<l.length?s.reduce(((e,t)=>e+(t.sets.has(r.bKey)?t.cardinality:0)),0):l.reduce(((e,t)=>e+(t.sets.has(r.aKey)?t.cardinality:0)),0):0}}(f,o.toKey);break;case"union":u=function(e,t=F){const n=new Map(U(e,t).map((e=>[e.key,e.cardinality])));return(e,a)=>{const r=H(e,a,t);if(null!=r.done)return r.done;if(r.aIsSet&&!r.bIsSet&&K(a,r))return e.cardinality;if(!r.aIsSet&&r.bIsSet&&J(e,r))return a.cardinality;const s=G(e,a,r);return n.has(s)?e.cardinality+a.cardinality-n.get(s):0}}(f,o.toKey);break;default:u=function(e,t=F){const n=new Map(U(e,t).map((e=>[e.key,e.cardinality])));return(e,a)=>{const r=H(e,a,t);if(null!=r.done)return r.done;if(r.aIsSet&&!r.bIsSet&&K(a,r))return a.cardinality;if(!r.aIsSet&&r.bIsSet&&J(e,r))return e.cardinality;const s=G(e,a,r);return n.has(s)?n.get(s):0}}(f,o.toKey)}return{sets:h,combinations:f}}function W(e,t,n={}){var a;const r="function"==typeof t?t:e=>e.sets,s=null!==(a="function"!=typeof t?t:n)&&void 0!==a?a:{},l=new Map;return e.forEach((e=>{r(e).forEach((t=>{const n=String(t);l.has(n)?l.get(n).push(e):l.set(n,[e])}))})),B(Array.from(l).map((([e,t])=>({type:"set",elems:t,name:String(e),cardinality:t.length}))),s)}const Q=(e,t,n)=>{const a=e.length+n,r=t/Math.max(1,a),s=t-r*e.length,l=new Map(e.map(((e,t)=>[e,t]))),o=r/(1+n),i=e=>{const t=l.get(e);if(null!=t)return s+r*t};return i.bandwidth=()=>o,i};function X(e,t,n=1){for(let a=0;a<e.length-n;a+=n){const n=e[a],r=e[a+1];if(n<r){if(n+t[a]/2>r-t[a+1]/2)return!0}else{const e=n-t[a]/2;if(r+t[a+1]/2>e)return!0}}return!1}function Y(e,t,n,a,r){let s=e[e.length-1];if(!s.label)for(let t=e.length-2;t>0;--t)if(e[t].label){s=e[t];break}if(s.value<t){const l=n(s.value),o=n(t);if(l<o)l+a(s.value)/2<o-a(t)/2&&e.push({value:t,label:r(t)});else{const n=l-a(s.value)/2;o+a(t)/2<n&&e.push({value:t,label:r(t)})}}return e}function ee(e,t=String,n=1){return e.map(((e,a)=>({value:e,label:1===n||a%n==0?t(e):void 0})))}function te(e,t,n,a,r){const s=e.map((e=>t(e))),l=e.map((e=>n(e)));return X(s,l)&&X(s,l,2)?null:Y(ee(e,r),a,t,n,r)}function ne(e){return e.toLocaleString()}function ae(e,t=1){const n=[];for(let a=0;a<=e;a+=t)n.push(a);return n}function re(e,t,n,a){if(t<=0)return[];const r=function(e,t=11){const n=Math.max(0,Math.floor(Math.log10(e)-.5)),a=Math.pow(10,n),r=[1,2,5],s=r.map((e=>e*a));n>0&&s.unshift(r[r.length-1]*Math.pow(10,n-1)),s.push(r[0]*Math.pow(10,n+1));const l=Math.ceil(e/t);return s.filter((t=>t>=l&&t<=e))}(e,t);for(let t=0;t<r.length;t++){const s=te(ae(e,r[t]),n,a,e,ne);if(s)return s}return ee([0,e],ne)}const se=(e,t,n)=>{const a=t[1]-t[0],r=e,s=e=>{const n=Math.max(0,Math.min(e,r))/r;return t[0]+n*a};return s.ticks=(t=10)=>{if("vertical"===n.orientation){const a=Math.ceil(1.4*n.fontSizeHint);return re(e,t+1,s,(()=>a))}const a=n.fontSizeHint/1.4;return re(e,t+1,s,(e=>Math.ceil(ne(e).length*a)))},s.tickFormat=()=>ne,s};function le(e){const t=["","k","M","G"],n=Math.max(0,Math.min(Math.floor(Math.log10(e)/3),t.length-1));return`${(Math.round(e/Math.pow(10,3*n-1))/10).toLocaleString()}${t[n]}`}function oe(e,t){const n=[],a=Math.pow(10,t);for(let t=1;t<=e;t*=a)n.push(t);return n}function ie(e,t){const n=[];for(let a=1,r=0;a<=e;a*=10,r++){n.push({value:a,label:1===t||r%t==0?le(a):void 0});for(let r=a+a;r<10*a&&r<e;r+=a*t)n.push({value:r})}return n}function ce(e,t,n,a){if(t<=0)return[];for(const t of[1,2,5])if(te(oe(e,t),n,a,e,le))return Y(ie(e,t),e,n,a,le);return ee([0,e],le)}const me=(e,t,n)=>{const a=t[1]-t[0],r=e<1?1:Math.log10(e),s=e=>{const n=Math.max(0,Math.min(e,r)),s=n<=1?0:Math.log10(n)/r;return t[0]+s*a};return s.ticks=(t=10)=>{if("vertical"===n.orientation){const a=Math.ceil(1.4*n.fontSizeHint);return ce(e,t+1,s,(()=>a))}const a=n.fontSizeHint/1.4;return ce(e,t+1,s,(e=>Math.ceil(le(e).length*a)))},s.tickFormat=()=>le,s};function de(e,t,{sortAble:n,compress:a="auto"}={}){if(0===e.length)return[];const r=e.map((e=>t(e)));if("no"===a)return r;n&&r.sort(((e,t)=>e-t));const s=function(e){if(0===e.length)return"";const t=[];let n=0;const a=a=>(a===n+1?t.push(e[n].toString()):a===n+2&&a<10?t.push(`${e[n]},${e[n+1]}`):t.push(`${e[n]}+${a-n-1}`),a);for(let t=1;t<e.length;t++){const r=e[t-1]+1;e[t]!==r&&(n=a(t),n=t)}return a(e.length),t.join(",")}(r),l=JSON.stringify(r).length,o=s.length+2;return o<.6*l||l-o>50||"yes"===a&&o<l?s:r}function ue(e,t){return"string"==typeof e?0===e.length?[]:e.split(",").map((e=>{if(e.includes("+")){const[n,a]=e.split("+").map((e=>Number.parseInt(e,10)));return t.slice(n,n+a+1)}return t[Number.parseInt(e,10)]})).flat():e.map((e=>t[e]))}function pe(e,t){return t.color&&(e.color=t.color),e}function ye(e,t,n={}){const a=e.sets.map((e=>I(Object.assign(Object.assign({},e),{elems:ue(e.elems,t)})))),r=e.combinations?e.combinations.map((e=>N(Object.assign(Object.assign({},e),{elems:ue(e.elems,t)}),e.type,(e=>e.sets.map((e=>a[e])))))):z(a,Object.assign({type:"intersection",elems:t,toElemKey:n.toElemKey},null!==(s=e.combinationOptions)&&void 0!==s?s:{}));var s;function l(e){return"set"===e.type?a[e.index]:r[e.index]}return{sets:a,combinations:r,selection:e.selection?"string"==typeof e.selection||Array.isArray(e.selection)?ue(e.selection,t):l(e.selection):void 0,queries:e.queries.map((e=>e.set?{name:e.name,color:e.color,set:l(e.set)}:{name:e.name,color:e.color,elems:ue(e.elems,t)}))}}function he(e,t={}){var n;const a=Object.assign({sortAble:!0},t),r=null!==(n=t.toKey)&&void 0!==n?n:F,s=new Map(e.sets.map(((e,t)=>[r(e),t]))),l=new Map(e.combinations.map(((e,t)=>[r(e),t]))),o=t=>{if("set"===t.type)return{type:t.type,index:s.get(r(t))};const n=l.get(r(t));return null==n||n<0?de(t.elems,e.toElemIndex,a):{type:t.type,index:n}},i=e.sets.map(((e,t)=>({key:r(e),i:t})));return{sets:e.sets.map((t=>pe({name:t.name,cardinality:t.cardinality,elems:de(t.elems,e.toElemIndex,a)},t))),combinations:"no"===t.compress?e.combinations.map((t=>{const n=new Set(Array.from(t.sets).map(r));return pe({name:t.name,type:t.type,cardinality:t.cardinality,degree:t.degree,sets:i.filter((({key:e})=>n.has(e))).map((({i:e})=>e)),elems:de(t.elems,e.toElemIndex,a)},t)})):void 0,combinationOptions:e.combinationOptions,selection:e.selection?Array.isArray(e.selection)?de(e.selection,e.toElemIndex,a):o(e.selection):void 0,queries:e.queries.map((t=>{const n=d(t)?o(t.set):de(Array.from(t.elems),e.toElemIndex,a);return{name:t.name,color:t.color,set:"string"==typeof n||Array.isArray(n)?void 0:n,elems:"string"==typeof n||Array.isArray(n)?n:void 0}}))}}function fe(e,t){return 1===e.length?e[0].name:`(${e.map((e=>e.name)).join(M[t])})`}function ge(e,t={}){var n;const a=null!==(n=t.toKey)&&void 0!==n?n:F,s=new Map(e.sets.map(((e,t)=>[a(e),t]))),l=new Map(e.combinations.map(((e,t)=>[a(e),t]))),o=t=>{if(g(t)){if("set"===t.type)return{type:t.type,index:s.get(a(t))};const e=l.get(a(t));if(null!=e&&e>=0)return{type:t.type,index:e}}const n=r(g(t)?t.elems:t);return e.sets.map((e=>n(e.elems).intersection)).concat(e.combinations.map((e=>n(e.elems).intersection)))},i=new Map(e.sets.map(((e,t)=>[a(e),t]))),c=function(e,t,{toElemKey:n,what:a="intersection",compress:s="auto"}={}){const l=e.concat(t),o=l.map(((e,t)=>{const s=function(e){if(e.overlap)return e.overlap;const t=r(e.elems,n);return n=>n.overlap?n.overlap(e):t(n.elems)[a]}(e),o=[];for(let e=t+1;e<l.length;e++)o.push(s(l[e]));return o}));if(o.pop(),"no"===s)return o;const i=function(e){return 0===e.length?"":`${e.length};${function(e){if(0===e.length)return"";const t=[];let n=e[0],a=1;for(let r=1;r<e.length;r++){const s=e[r];s===n?a++:(a>1?t.push(`${n}=${a-1}`):0===n?t.push(""):t.push(n.toString()),n=s,a=1)}return a>1?t.push(`${n}=${a}`):0===n?t.push(""):t.push(n.toString()),t.join(",")}(e.flat())}`}(o);if("yes"===s)return i;const c=JSON.stringify(o).length;return i.length+2<.6*c?i:o}(e.sets,e.combinations,t),m="yes"===t.compress;return{sets:m?e.sets.map((e=>({n:e.name,cc:e.color,c:e.cardinality}))):e.sets.map((e=>pe({name:e.name,cardinality:e.cardinality},e))),combinations:m?e.combinations.map((t=>{const n=Array.from(t.sets).map((e=>i.get(a(e)))).sort(((e,t)=>e-t)),r={c:t.cardinality,s:n.reduce(((e,t)=>e+Math.pow(2,t)),0)};return t.name!==fe(n.map((t=>e.sets[t])),t.type)&&(r.n=t.name),"intersection"!==t.type&&(r.type=t.type[0]),t.color&&(r.cc=t.color),r})):e.combinations.map((e=>pe({name:e.name,cardinality:e.cardinality,type:e.type,sets:Array.from(e.sets).map((e=>i.get(a(e)))).sort(((e,t)=>e-t))},e))),overlaps:c,selection:e.selection?o(e.selection):void 0,queries:e.queries.map((t=>{if(d(t)){const e=o(t.set);return Array.isArray(e)?{name:t.name,color:t.color,overlaps:e}:{name:t.name,color:t.color,set:e}}const n=r(t.elems),a=e.sets.map((e=>n(e.elems).intersection)).concat(e.combinations.map((e=>n(e.elems).intersection)));return{name:t.name,color:t.color,overlaps:a}}))}}function xe(e){return"number"==typeof e.c}function be(e){return"number"==typeof e.c}function ve(e,t={}){var n;const a=null!==(n=t.toKey)&&void 0!==n?n:F;let r=()=>0;function s(e){return e.overlap=t=>r(e,t),e}const l=e.sets.map((e=>s({name:be(e)?e.n:e.name,cardinality:be(e)?e.c:e.cardinality,type:"set",elems:[]}))),o=e.combinations.map((e=>{var t,n;const a=xe(e)?(r=e.s,l.filter(((e,t)=>{const n=Math.pow(2,t);return(r&n)===n}))):e.sets.map((e=>l[e]));var r;const o={i:"intersection",u:"union",c:"composite",d:"distinctIntersection"}[(null!==(t=e.type)&&void 0!==t?t:"i")[0]];return s({name:xe(e)?null!==(n=e.n)&&void 0!==n?n:fe(a,o):e.name,cardinality:xe(e)?e.c:e.cardinality,type:o,degree:a.length,sets:new Set(a),elems:[]})})),{setIndex:i,combinationIndex:c,compute:m}=function(e,t,n,a=F){const r="string"==typeof e?function(e){if(0===e.length)return[];const[t,n]=e.split(";"),a=Number.parseInt(t,10),r=0===(s=n).length?[]:s.split(",").map((e=>{if(""===e)return 0;if(e.includes("=")){const[t,n]=e.split("=").map((e=>Number.parseInt(e,10)));return Array(n+1).fill(t)}return Number.parseInt(e,10)})).flat();var s;const l=[];let o=0;for(let e=a;e>0;e--)l.push(r.slice(o,o+e)),o+=e;return l}(e):e,s=new Map(t.map(((e,t)=>[a(e),t]))),l=new Map(n.map(((e,n)=>[a(e),n+t.length])));return{setIndex:s,compute:(e,t)=>{if(e===t)return e.cardinality;const n=a(e),o=a(t),i=s.has(n)?s.get(n):l.get(n),c=s.has(o)?s.get(o):l.get(o);if(i===c)return e.cardinality;const m=Math.min(i,c),d=Math.max(i,c)-m-1;return m<0||m>=r.length||d<0||d>=r[m].length?0:r[m][d]},combinationIndex:l}}(e.overlaps,l,o,a);function d(e){return"set"===e.type?l[e.index]:o[e.index]}function u(e){return t=>{const n=a(t),r=i.has(n)?i.get(n):c.get(n);return null==r||r<0||r>=e.length?0:e[r]}}return r=m,{sets:l,combinations:o,selection:e.selection?Array.isArray(e.selection)?u(e.selection):d(e.selection):void 0,queries:e.queries.map((e=>e.set?{name:e.name,color:e.color,set:d(e.set)}:{name:e.name,color:e.color,overlap:u(e.overlaps)}))}}}}]);