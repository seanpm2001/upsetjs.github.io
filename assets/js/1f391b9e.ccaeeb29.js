/*! For license information please see 1f391b9e.ccaeeb29.js.LICENSE.txt */
"use strict";(globalThis.webpackChunk_upsetjs_docs=globalThis.webpackChunk_upsetjs_docs||[]).push([[3085],{7762:(e,t,n)=>{n.r(t),n.d(t,{default:()=>c});var r=n(9703),a=n(9418),s=n(2129),l=n(9790),o=n(4008),i=n(1229);const c=function(e){const{content:t}=e,{frontMatter:n,metadata:c}=t,{title:m,description:u,wrapperClassName:d,hide_table_of_contents:y}=n,{permalink:f}=c;return r.createElement(a.Z,{title:m,description:u,permalink:f,wrapperClassName:d??i.kM.wrapper.mdxPages,pageClassName:i.kM.page.mdxPage},r.createElement("main",null,r.createElement("div",{className:"container container--fluid"},r.createElement("div",{className:"margin-vert--lg padding-vert--lg"},r.createElement("div",{className:"row"},r.createElement("div",{className:"col col--8 col--offset-2"},r.createElement("div",{className:"container"},r.createElement(s.Zo,{components:l.Z},r.createElement(t,null)))),!y&&t.toc&&r.createElement("div",{className:"col col--2"},r.createElement(o.Z,{toc:t.toc})))))))}},4008:(e,t,n)=>{n.d(t,{Z:()=>c});var r=n(9703),a=n(7084);const s=function(e,t,n){const[a,s]=(0,r.useState)(void 0);(0,r.useEffect)((()=>{function r(){const r=function(){const e=Array.from(document.getElementsByClassName("anchor")),t=e.find((e=>{const{top:t}=e.getBoundingClientRect();return t>=n}));if(t){if(t.getBoundingClientRect().top>=n){return e[e.indexOf(t)-1]??t}return t}return e[e.length-1]}();if(r){let n=0,l=!1;const o=document.getElementsByClassName(e);for(;n<o.length&&!l;){const e=o[n],{href:i}=e,c=decodeURIComponent(i.substring(i.indexOf("#")+1));r.id===c&&(a&&a.classList.remove(t),e.classList.add(t),s(e),l=!0),n+=1}}}return document.addEventListener("scroll",r),document.addEventListener("resize",r),r(),()=>{document.removeEventListener("scroll",r),document.removeEventListener("resize",r)}}))},l="tableOfContents_IZ3I",o="table-of-contents__link";function i(e){let{toc:t,isChild:n}=e;return t.length?r.createElement("ul",{className:n?"":"table-of-contents table-of-contents__left-border"},t.map((e=>r.createElement("li",{key:e.id},r.createElement("a",{href:`#${e.id}`,className:o,dangerouslySetInnerHTML:{__html:e.value}}),r.createElement(i,{isChild:!0,toc:e.children}))))):null}const c=function(e){let{toc:t}=e;return s(o,"table-of-contents__link--active",100),r.createElement("div",{className:(0,a.Z)(l,"thin-scrollbar")},r.createElement(i,{toc:t}))}},944:(e,t,n)=>{n.d(t,{Z:()=>na});var r={};n.r(r),n.d(r,{SET_JOINERS:()=>_,asCombination:()=>z,asCombinations:()=>I,asSet:()=>W,asSets:()=>V,bandScale:()=>ue,extractCombinations:()=>J,extractFromExpression:()=>Q,extractSets:()=>G,fromDump:()=>Ne,fromIndicesArray:()=>Ce,fromSetName:()=>q,fromStaticDump:()=>ze,generateCombinations:()=>D,generateDistinctOverlapFunction:()=>ae,generateIntersectionOverlapFunction:()=>se,generateOverlapFunction:()=>oe,generateOverlapLookup:()=>ce,generateOverlapLookupFunction:()=>me,generateUnionOverlapFunction:()=>le,isCalcQuery:()=>h,isElemQuery:()=>p,isGenerateSetCombinationOptions:()=>E,isSet:()=>$,isSetCombination:()=>w,isSetLike:()=>S,isSetQuery:()=>g,isUpSetQuery:()=>k,linearScale:()=>ve,logScale:()=>Ee,mergeColors:()=>F,parseColor:()=>T,queryElemOverlap:()=>v,queryOverlap:()=>x,setElemIntersectionFactory:()=>f,setElemOverlap:()=>y,setElemOverlapFactory:()=>d,setOverlap:()=>u,setOverlapFactory:()=>m,toDump:()=>Oe,toIndicesArray:()=>ke,toKey:()=>Z,toStaticDump:()=>Le});var a={};n.r(a),n.d(a,{KarnaughMap:()=>_n,KarnaughMapSkeleton:()=>Rn,SET_JOINERS:()=>_,UpSetJS:()=>xn,UpSetJSSkeleton:()=>Hn,VennDiagram:()=>kn,VennDiagramSkeleton:()=>Kn,asCombination:()=>z,asCombinations:()=>I,asSet:()=>W,asSets:()=>V,bandScale:()=>ue,createVennJSAdapter:()=>Un,default:()=>xn,downloadUrl:()=>wt,exportSVG:()=>$t,exportVegaLite:()=>St,extractCombinations:()=>J,extractFromExpression:()=>Q,extractSets:()=>G,fillDefaults:()=>pt,fillDefaultsG:()=>yt,fillKarnaughMapDefaults:()=>vt,fillKarnaughMapDefaultsG:()=>xt,fillVennDiagramDefaults:()=>gt,fillVennDiagramDefaultsG:()=>ht,fromDump:()=>Ne,fromIndicesArray:()=>Ce,fromSetName:()=>q,fromStaticDump:()=>ze,generateCombinations:()=>D,generateDistinctOverlapFunction:()=>ae,generateIntersectionOverlapFunction:()=>se,generateOverlapFunction:()=>oe,generateOverlapLookup:()=>ce,generateOverlapLookupFunction:()=>me,generateUnionOverlapFunction:()=>le,getDefaultTheme:()=>ct,isCalcQuery:()=>h,isElemQuery:()=>p,isEllipse:()=>rt,isGenerateSetCombinationOptions:()=>E,isSet:()=>$,isSetCombination:()=>w,isSetLike:()=>S,isSetQuery:()=>g,isUpSetQuery:()=>k,linearScale:()=>ve,logScale:()=>Ee,mergeColors:()=>F,parseColor:()=>T,propValidators:()=>Vn,queryElemOverlap:()=>v,queryOverlap:()=>x,setElemIntersectionFactory:()=>f,setElemOverlap:()=>y,setElemOverlapFactory:()=>d,setOverlap:()=>u,setOverlapFactory:()=>m,toDump:()=>Oe,toIndicesArray:()=>ke,toKey:()=>Z,toStaticDump:()=>Le,toUpSetJSDump:()=>Ct,toUpSetJSStaticDump:()=>Mt});var s={};n.r(s),n.d(s,{BarChart:()=>dr,Histogram:()=>Er,PieChart:()=>Cr,Scatterplot:()=>wr,createAggregatedGroupSetComposite:()=>vr,createIntervalSetComposite:()=>pr,createSetComposite:()=>ir,fillDefaults:()=>Yn,isAggregatedGroupSetComposite:()=>xr,isIntervalSetComposite:()=>yr,useVegaAggregatedGroupSelection:()=>br,useVegaBinSelection:()=>$r,useVegaIntervalSelection:()=>gr,useVegaMultiSelection:()=>ur});var l={};n.r(l),n.d(l,{Boxplot:()=>Br,Categorical:()=>Wr,boxplotAddon:()=>Hr,boxplotAggregatedAddon:()=>Kr,categoricalAddon:()=>Gr,categoricalAggregatedAddon:()=>Jr,simpleScale:()=>_r});var o={};n.r(o),n.d(o,{colors:()=>ea,elems:()=>Zr,queries:()=>Xr,sets:()=>Yr});var i=n(9703);function c(e){return e instanceof Set?e.size:e.length}function m(e,t){const n=t?new Set((e instanceof Set?Array.from(e):e).map(t)):e instanceof Set?e:new Set(e),r=n.size,a={setA:r,setB:r,union:r,intersection:r};return s=>{if(s===e)return a;let l=0;s.forEach((e=>{(t&&n.has(t(e))||!t&&n.has(e))&&l++}));const o=c(s);return{setA:r,setB:o,intersection:l,union:r+o-l}}}function u(e,t,n){if(c(e)<c(t)||e instanceof Set)return m(e,n)(t);const r=m(t,n)(e);return Object.assign({},r,{setA:r.setB,setB:r.setA})}function d(e,t){const n=t?new Set((e instanceof Set?Array.from(e):e).map(t)):e instanceof Set?e:new Set(e),r=Array.isArray(e)?e:Array.from(e),a={setA:r,setB:r,union:r,intersection:r};return s=>{if(s===e)return a;const l=[],o=r.slice();return s.forEach((e=>{t&&n.has(t(e))||!t&&n.has(e)?l.push(e):o.push(e)})),{setA:r,setB:Array.isArray(s)?s:Array.from(s),intersection:l,union:o}}}function y(e,t,n){if(c(e)<c(t)||e instanceof Set)return d(e,n)(t);const r=d(t,n)(e);return Object.assign({},r,{setA:r.setB,setB:r.setA})}function f(e,t){const n=e instanceof Set?Array.from(e):e,r=t?new Set(n.map(t)):e instanceof Set?e:new Set(e);return a=>{if(a===e)return n;const s=[];return a.forEach((e=>{(t&&r.has(t(e))||!t&&r.has(e))&&s.push(e)})),s}}function p(e){return Array.isArray(e.elems)}function h(e){return"function"==typeof e.overlap}function g(e){return null!=e.set}function x(e,t,n){if(h(e))return e.overlap;if(g(e)&&e.set.overlap)return e.set.overlap;const r=m(p(e)?e.elems:e.set.elems,n);return n=>n.overlap&&p(e)&&Array.isArray(e.elems)?n.overlap(e.elems):n.overlap&&g(e)?n.overlap(e.set):r(n.elems)[t]}function v(e,t,n){if(h(e))return()=>null;if("intersection"===t){const t=f(p(e)?e.elems:e.set.elems,n);return e=>t(e.elems)}const r=d(p(e)?e.elems:e.set.elems,n);return e=>r(e.elems)[t]}function b(e){return null!=e&&"number"==typeof e.cardinality&&"string"==typeof e.name&&Array.isArray(e.elems)}function $(e){return b(e)&&"set"===e.type}function w(e){const t=e;return b(e)&&["composite","union","intersection","distinctIntersection"].includes(t.type)&&t.sets instanceof Set&&"number"==typeof t.degree}function S(e){return $(e)||w(e)}function E(e){const t=e;return null!=e&&(null==t.type||["intersection","union"].includes(t.type))}function k(e){const t=e;return null!=e&&"string"==typeof t.name&&"string"==typeof t.color&&(p(t)||g(t)||h(t))}function C(e,t){return e.name.localeCompare(t.name)}function M(e,t){return t.cardinality-e.cardinality}function N(e,t){return e.degree-t.degree}function O(e){return(t,n)=>e.reduce(((e,r)=>0===e?r(t,n):e),0)}function A(e){return(t,n)=>-e(t,n)}function L(e){return(t,n)=>{const r=e=>e<0?Number.POSITIVE_INFINITY:e;return r(e.findIndex((e=>t.sets.has(e))))-r(e.findIndex((e=>n.sets.has(e))))}}function q(e,t){void 0===t&&(t=/[\u2229\u222a&|]/);const n=new Map(e.map((e=>[e.name,e])));return e=>e.name.split(t).map((e=>n.get(e.trim())))}function j(e,t,n){void 0===n&&(n={});let r=t;return n.order&&(r=r.sort(function(e,t){if(!t)return C;const n=Array.isArray(t)?t:[t];return 0===n.length?C:O(n.map((t=>{switch(t){case"cardinality":case"cardinality:desc":return M;case"cardinality:asc":return A(M);case"name:desc":return A(C);case"degree":case"degree:asc":return N;case"degree:desc":return A(N);case"group":case"group:asc":return L(e);case"group:desc":return A(L(e));default:return C}})))}(e,n.order))),null!=n.limit?r.slice(0,n.limit):r}function z(e,t,n){const r=n(e);return Object.assign({type:t,cardinality:e.elems.length,sets:new Set(r),degree:r.length},e)}function I(e,t,n){return e.map((e=>z(e,t,n)))}const _={distinctIntersection:" \u2229 ",intersection:" \u2229 ",union:" \u222a ",composite:","};function T(e){if(!e)return[255,255,255];const t=e.match(/#([\da-f]{2})([\da-f]{2})([\da-f]{2})/i);if(t)return[Number.parseInt(t[1],16),Number.parseInt(t[2],16),Number.parseInt(t[3],16)];const n=e.match(/\(([\d]+)[, ]([\d]+)[, ]([\d]+)\)/i);return n?[Number.parseInt(n[1],10),Number.parseInt(n[2],10),Number.parseInt(n[3],10)]:[255,255,255]}function F(e){if(1===e.length)return e[0];if(e.every((e=>null==e)))return;const t=e.map(T),n=Math.floor(t.reduce(((e,t)=>e+t[0]),0)/t.length),r=Math.floor(t.reduce(((e,t)=>e+t[1]),0)/t.length),a=Math.floor(t.reduce(((e,t)=>e+t[2]),0)/t.length);return`#${n.toString(16)}${r.toString(16)}${a.toString(16)}`}function B(e,t,n){const r=Array.from(e).sort(((e,n)=>t.get(e)-t.get(n)));return 1===r.length?r[0].name:`(${r.map((e=>e.name)).join(n)})`}function P(e,t,n,r,a){return{type:0===n.size?"composite":e,elems:r,color:a(Array.from(n).map((e=>e.color))),sets:n,name:t,cardinality:r.length,degree:n.size}}function H(e,t,n,r,a,s,l){const o=new Set(e.sets);t.sets.forEach((e=>o.add(e)));const i=B(o,a,_[s]);if(0===e.cardinality||0===t.cardinality)return P(s,i,o,[],l);let c=e,m=t;e.cardinality>t.cardinality&&(c=t,m=e);const u=new Set,d=n.get(m),y=[],f=c.elems.length;for(let h=0;h<f;h++){const e=c.elems[h],t=r(e);d.has(t)&&(u.add(t),y.push(e))}const p=P(s,i,o,y,l);return n.set(p,u),p}function K(e,t,n,r,a,s,l){const o=new Set(e.sets);t.sets.forEach((e=>o.add(e)));const i=B(o,a,_[s]);if(0===e.cardinality){const e=P(s,i,o,t.elems,l);return n.set(e,n.get(t)),e}if(0===t.cardinality){const t=P(s,i,o,e.elems,l);return n.set(t,n.get(e)),t}let c=e,m=t;e.cardinality>t.cardinality&&(c=t,m=e);const u=new Set(n.get(m)),d=n.get(m),y=m.elems.slice();c.elems.forEach((e=>{const t=r(e);d.has(t)||(u.add(t),y.push(e))}));const f=P(s,i,o,y,l);return n.set(f,u),f}function R(e,t,n,r,a,s){if("number"==typeof t)return{type:"composite",elems:[],color:s?s([]):void 0,sets:new Set,name:"()",cardinality:t,overlap(e){return e===this||S(e)&&e.name===this.name&&e.cardinality===this.cardinality?this.cardinality:0},degree:0};if(Array.isArray(t))return P(e,"()",new Set,t,s);const l=Array.from(r.values()),o=n.filter((e=>{const t=a(e);return l.every((e=>!e.has(t)))}));return P(e,"()",new Set,o,s)}function D(e,t){void 0===t&&(t={});const{type:n="intersection",min:r=0,max:a=Number.POSITIVE_INFINITY,empty:s=!1,elems:l=[],notPartOfAnySet:o,toElemKey:i,mergeColors:c=F}=t,m=[],u=new Map(e.map(((e,t)=>[e,t]))),d=new Map(e.map((e=>[e,i?new Set(e.elems.map(i)):new Set(e.elems)]))),y=i?null:d,f=i?d:null,p="union"===n?K:H;function h(t){if(t.degree<r||t.degree>a||0===t.cardinality&&!s)return;if("distinctIntersection"!==n)return void m.push(t);const l=e.filter((e=>!t.sets.has(e)));let o=[];if(i){const e=l.map((e=>f.get(e)));o=t.elems.filter((t=>{const n=i(t);return e.every((e=>!e.has(n)))}))}else{const e=l.map((e=>y.get(e)));o=t.elems.filter((t=>e.every((e=>!e.has(t)))))}if(o.length===t.cardinality)return void m.push(t);const u=P(n,t.name,t.sets,o,c);(0!==u.cardinality||s)&&m.push(u)}function g(e,t,r,l){if(t>a)return;const o=e.length;for(let a=0;a<o;a++){const i=e[a],m=[];for(let t=a+1;t<o;t++){const a=e[t],o=p(i,a,r,l,u,n,c);h(o),("union"===n||o.cardinality>0||s)&&m.push(o)}m.length>1&&g(m,t+1,r,l)}}r<=0&&h(i?R(n,o,l,f,i,c):R(n,o,l,y,(e=>e),c));const x=e.map((e=>{const t=P(n,e.name,new Set([e]),e.elems,c);return d.set(t,d.get(e)),h(t),t}));return i?g(x,2,f,i):g(x,2,y,(e=>e)),j(e,m,t)}function W(e){return Object.assign({type:"set",cardinality:e.elems.length},e)}function U(e,t){void 0===t&&(t={});let n=e;if(t.order){const e=function(e){if(!e)return C;switch(e){case"cardinality":case"cardinality:desc":return O([M,C]);case"cardinality:asc":return O([A(M),C]);case"name:desc":return A(C);default:return C}}(t.order);n=n.slice().sort(e)}return null!=t.limit?n.slice(0,t.limit):n}function V(e,t){return void 0===t&&(t={}),U(e.map(W),t)}function Q(e,t,n){var r,a,s;void 0===n&&(n={});const l="function"==typeof t?t:e=>e.sets,o=null!==(r="function"!=typeof t?t:n)&&void 0!==r?r:{},i=null!==(a=o.type)&&void 0!==a?a:"intersection",c=null!==(s=o.joiner)&&void 0!==s?s:_[i],m=[],u=new Map,d=e.map((e=>{const t=l(e),n=t.map((e=>{if(u.has(e))return u.get(e);const t={cardinality:0,elems:[],name:e,type:"set"};return m.push(t),u.set(t.name,t),t}));if("distinctIntersection"===i)for(const a of n)a.cardinality+=e.cardinality;else if(1===t.length)Object.assign(n[0],{cardinality:e.cardinality},e);else if("intersection"===i)for(const a of n)a.cardinality=Math.max(a.cardinality,e.cardinality);else if("union"===i)for(const a of n)a.cardinality=Math.min(a.cardinality,e.cardinality);const r=t.join(c);return Object.assign({type:i,elems:[],name:r},e,{cardinality:e.cardinality,degree:t.length,sets:new Set(n)})})),y=U(m,{order:o.setOrder});return{sets:y,combinations:j(y,d,{order:o.combinationOrder})}}function G(e,t,n){var r;void 0===n&&(n={});const a="function"==typeof t?t:e=>e.sets,s=null!==(r="function"!=typeof t?t:n)&&void 0!==r?r:{},l=Object.create(null);return e.forEach((e=>{a(e).forEach((t=>{const n="string"==typeof t?t:String(t),r=l[n];null==r?l[n]=[e]:r.push(e)}))})),U(Object.entries(l).map((e=>{let[t,n]=e;return{type:"set",elems:n,name:String(t),cardinality:n.length}})),s)}function J(e,t,n){var r,a,s,l;void 0===n&&(n={});const o="function"==typeof t?t:e=>e.sets,i=null!==(r="function"!=typeof t?t:n)&&void 0!==r?r:{},c=null!==(a=i.type)&&void 0!==a?a:"intersection",m=null!==(s=i.sets)&&void 0!==s?s:G(e,o,{limit:i.setLimit,order:i.setOrder});if("union"===c)return{sets:m,combinations:D(m,{type:"union",limit:i.combinationLimit,order:i.combinationOrder})};const u=Object.create(null);m.forEach(((e,t)=>{u[e.name]=[e,t]}));const d=m.map((e=>e.name)).sort().every(((e,t)=>m[t].name===e))?void 0:(e,t)=>{var n,r,a,s;return(null!==(r=null===(n=u[e])||void 0===n?void 0:n[1])&&void 0!==r?r:-1)-(null!==(s=null===(a=u[t])||void 0===a?void 0:a[1])&&void 0!==s?s:-1)},y=null==i.sets&&null==i.setLimit?null:new Set(m.map((e=>e.name))),f=null!==(l=i.joiner)&&void 0!==l?l:_[c],p=[],h=Object.create(null),g=Array(m.length+1).fill(0).map((e=>[]));function x(e){switch(e.length){case 0:return"()";case 1:return e[0];default:return"("+e.slice().sort(d).join(f)+")"}}function v(e){const t=function(e){switch(e.length){case 0:return"";case 1:return e[0];case 2:return null!=d&&d(e[0],e[1])>0||null==d&&e[1]>e[0]?e[1]+"&"+e[0]:e[0]+"&"+e[1];default:return e.slice().sort(d).join("&")}}(e),n=h[t];if(n)return n;const r={type:c,name:x(e),degree:e.length,sets:new Set(e.map((e=>u[e][0]))),cardinality:0,elems:[]};return h[t]=r,p.push(r),g[r.degree].push(r),r}e.forEach((e=>{let t=o(e);y&&(t=t.filter((e=>y.has(e))));const n=v(t);n.elems.push(e),n.cardinality++}));const b=()=>({sets:m,combinations:j(m,p,{order:i.combinationOrder,limit:i.combinationLimit})});if("distinctIntersection"===c)return b();const $=function(e,t){const n=new Map;return e.slice().reverse().forEach((e=>{0!==e.length&&1!==e[0].degree&&e.forEach((e=>{const r=Array.from(e.sets).map((e=>e.name));for(let a=0;a<r.length;a++){const s=r.slice();s.splice(a,1);const l=t(s);n.has(l)?n.get(l).push(e):n.set(l,[e])}}))})),n}(g,v);function w(e,t,n){var r;t.has(e)||(t.add(e),e.elems.length<1e3?n[0].push(...e.elems):n.push(e.elems),(null!==(r=$.get(e))&&void 0!==r?r:[]).forEach((e=>w(e,t,n))))}return g.slice(1).forEach((e=>{e.forEach((e=>{var t;const n=new Set,r=[e.elems];(null!==(t=$.get(e))&&void 0!==t?t:[]).forEach((e=>{w(e,n,r)}));const a=1===r.length?r[0]:r.flat();Object.assign(e,{elems:a,cardinality:a.length})}))})),b()}function Z(e){return`${e.name}:${e.type}#${e.cardinality}`}function Y(e){return 0===e.sets.size}function X(e,t,n){void 0===n&&(n=Z);const r={done:null,aKey:"",bKey:"",aIsSet:!1,bIsSet:!1,toKey:n};return e===t?(r.done=e.cardinality,r):0===e.cardinality||0===t.cardinality?(r.done=0,r):(r.aKey=n(e),r.bKey=n(t),r.aKey===r.bKey?(r.done=e.cardinality,r):(r.aIsSet=$(e),r.bIsSet=$(t),!r.aIsSet&&Y(e)||!r.bIsSet&&Y(t)?(r.done=0,r):r))}function ee(e,t){return!(t.bIsSet||!t.aIsSet)&&Array.from(e.sets).map(t.toKey).includes(t.aKey)}function te(e,t){return!(!t.bIsSet||t.aIsSet)&&Array.from(e.sets).map(t.toKey).includes(t.bKey)}function ne(e,t){return void 0===t&&(t=Z),e.map((e=>{const n=Array.from(e.sets).map(t).sort();return{key:n.join("&"),s:n,sets:new Set(n),degree:e.degree,cardinality:e.cardinality}}))}function re(e,t,n){const r=new Set;if(n.aIsSet)r.add(n.aKey);else for(const a of Array.from(e.sets))r.add(n.toKey(a));if(n.bIsSet)r.add(n.bKey);else for(const a of Array.from(t.sets))r.add(n.toKey(a));return Array.from(r).sort().join("&")}function ae(e,t,n){void 0===n&&(n=Z);const r=new Map;for(const a of ne(e,n))for(const e of a.s)r.has(e)?r.get(e).push(a):r.set(e,[a]);return(e,a)=>{const s=X(e,a,n);if(null!=s.done)return s.done;if(!s.aIsSet&&!s.bIsSet)return 0;if(s.aIsSet&&!s.bIsSet)return ee(a,s)?a.cardinality:0;if(!s.aIsSet&&s.bIsSet)return te(e,s)?e.cardinality:0;const l=r.get(s.aKey),o=r.get(s.bKey);return l&&o?l.length<o.length?l.reduce(((e,t)=>e+(t.sets.has(s.bKey)?t.cardinality:0)),0):o.reduce(((e,t)=>e+(t.sets.has(s.aKey)?t.cardinality:0)),0):t(e,a)}}function se(e,t,n){void 0===n&&(n=Z);const r=new Map(ne(e,n).map((e=>[e.key,e.cardinality])));return(e,a)=>{const s=X(e,a,n);if(null!=s.done)return s.done;if(s.aIsSet&&!s.bIsSet&&ee(a,s))return a.cardinality;if(!s.aIsSet&&s.bIsSet&&te(e,s))return e.cardinality;const l=re(e,a,s);return r.has(l)?r.get(l):t(e,a)}}function le(e,t,n){void 0===n&&(n=Z);const r=new Map(ne(e,n).map((e=>[e.key,e.cardinality])));return(e,a)=>{const s=X(e,a,n);if(null!=s.done)return s.done;if(s.aIsSet&&!s.bIsSet&&ee(a,s))return e.cardinality;if(!s.aIsSet&&s.bIsSet&&te(e,s))return a.cardinality;const l=re(e,a,s);return r.has(l)?e.cardinality+a.cardinality-r.get(l):t(e,a)}}function oe(e,t,n){if(void 0===n&&(n=Z),0===e.length)return t;const r=e[0].type;if(e.some((e=>e.type!==r)))return t;switch(r){case"union":return le(e,t,n);case"intersection":return se(e,t,n);case"distinctIntersection":return ae(e,t,n)}return t}function ie(e){if(0===e.length)return[];const[t,n]=e.split(";"),r=Number.parseInt(t,10),a=0===(s=n).length?[]:s.split(",").map((e=>{if(""===e)return 0;if(e.includes("=")){const[t,n]=e.split("=").map((e=>Number.parseInt(e,10)));return Array(n+1).fill(t)}return Number.parseInt(e,10)})).flat();var s;const l=[];let o=0;for(let i=r;i>0;i--)l.push(a.slice(o,o+i)),o+=i;return l}function ce(e,t,n){let{toElemKey:r,what:a="intersection",compress:s="auto"}=void 0===n?{}:n;const l=e.concat(t);const o=l.map(((e,t)=>{const n=function(e){if(e.overlap)return e.overlap;const t=m(e.elems,r);return n=>n.overlap?n.overlap(e):t(n.elems)[a]}(e),s=[];for(let r=t+1;r<l.length;r++)s.push(n(l[r]));return s}));if(o.pop(),"no"===s)return o;const i=function(e){return 0===e.length?"":`${e.length};${function(e){if(0===e.length)return"";const t=[];let n=e[0],r=1;for(let a=1;a<e.length;a++){const s=e[a];s===n?r++:(r>1?t.push(`${n}=${r-1}`):0===n?t.push(""):t.push(n.toString()),n=s,r=1)}return r>1?t.push(`${n}=${r}`):0===n?t.push(""):t.push(n.toString()),t.join(",")}(e.flat())}`}(o);if("yes"===s)return i;const c=JSON.stringify(o).length;return i.length+2<.6*c?i:o}function me(e,t,n,r){void 0===r&&(r=Z);const a="string"==typeof e?ie(e):e,s=new Map(t.map(((e,t)=>[r(e),t]))),l=new Map(n.map(((e,n)=>[r(e),n+t.length])));return{setIndex:s,compute:(e,t)=>{if(e===t)return e.cardinality;const n=r(e),o=r(t),i=s.has(n)?s.get(n):l.get(n),c=s.has(o)?s.get(o):l.get(o);if(i===c)return e.cardinality;const m=Math.min(i,c),u=Math.max(i,c)-m-1;return m<0||m>=a.length||u<0||u>=a[m].length?0:a[m][u]},combinationIndex:l}}const ue=(e,t,n)=>{const r=e.length+n,a=t/Math.max(1,r),s=t-a*e.length,l=new Map(e.map(((e,t)=>[e,t]))),o=a/(1+n),i=e=>{const t=l.get(e);if(null!=t)return s+a*t};return i.bandwidth=()=>o,i};function de(e,t,n){void 0===n&&(n=1);for(let r=0;r<e.length-n;r+=n){const n=e[r],a=e[r+1];if(n<a){if(n+t[r]/2>a-t[r+1]/2)return!0}else{const e=n-t[r]/2;if(a+t[r+1]/2>e)return!0}}return!1}function ye(e,t,n,r,a){let s=e[e.length-1];if(!s.label)for(let l=e.length-2;l>0;--l)if(e[l].label){s=e[l];break}if(s.value<t){const l=n(s.value),o=n(t);if(l<o){l+r(s.value)/2<o-r(t)/2&&e.push({value:t,label:a(t)})}else{const n=l-r(s.value)/2;o+r(t)/2<n&&e.push({value:t,label:a(t)})}}return e}function fe(e,t,n){return void 0===t&&(t=String),void 0===n&&(n=1),e.map(((e,r)=>({value:e,label:1===n||r%n==0?t(e):void 0})))}function pe(e,t,n,r,a){const s=e.map((e=>t(e))),l=e.map((e=>n(e)));return de(s,l)&&de(s,l,2)?null:ye(fe(e,a),r,t,n,a)}function he(e){return e.toLocaleString()}function ge(e,t){void 0===t&&(t=1);const n=[];for(let r=0;r<=e;r+=t)n.push(r);return n}function xe(e,t,n,r){if(t<=0)return[];const a=function(e,t){void 0===t&&(t=11);const n=Math.max(0,Math.floor(Math.log10(e)-.5)),r=Math.pow(10,n),a=[1,2,5],s=a.map((e=>e*r));n>0&&s.unshift(a[a.length-1]*Math.pow(10,n-1)),s.push(a[0]*Math.pow(10,n+1));const l=Math.ceil(e/t);return s.filter((t=>t>=l&&t<=e))}(e,t);for(let s=0;s<a.length;s++){const t=pe(ge(e,a[s]),n,r,e,he);if(t)return t}return fe([0,e],he)}const ve=(e,t,n)=>{const r=t[1]-t[0],a=e,s=e=>{const n=Math.max(0,Math.min(e,a))/a;return t[0]+n*r};return s.ticks=function(t){if(void 0===t&&(t=10),"vertical"===n.orientation){const r=Math.ceil(1.4*n.fontSizeHint);return xe(e,t+1,s,(()=>r))}const r=n.fontSizeHint/1.4;return xe(e,t+1,s,(e=>Math.ceil(he(e).length*r)))},s.tickFormat=()=>he,s};function be(e){const t=["","k","M","G"],n=Math.max(0,Math.min(Math.floor(Math.log10(e)/3),t.length-1));return`${(Math.round(e/Math.pow(10,3*n-1))/10).toLocaleString()}${t[n]}`}function $e(e,t){const n=[],r=Math.pow(10,t);for(let a=1;a<=e;a*=r)n.push(a);return n}function we(e,t){const n=[];for(let r=1,a=0;r<=e;r*=10,a++){n.push({value:r,label:1===t||a%t==0?be(r):void 0});for(let a=r+r;a<10*r&&a<e;a+=r*t)n.push({value:a})}return n}function Se(e,t,n,r){if(t<=0)return[];for(const a of[1,2,5]){if(pe($e(e,a),n,r,e,be))return ye(we(e,a),e,n,r,be)}return fe([0,e],be)}const Ee=(e,t,n)=>{const r=t[1]-t[0],a=e<1?1:Math.log10(e),s=e=>{const n=Math.max(0,Math.min(e,a)),s=n<=1?0:Math.log10(n)/a;return t[0]+s*r};return s.ticks=function(t){if(void 0===t&&(t=10),"vertical"===n.orientation){const r=Math.ceil(1.4*n.fontSizeHint);return Se(e,t+1,s,(()=>r))}const r=n.fontSizeHint/1.4;return Se(e,t+1,s,(e=>Math.ceil(be(e).length*r)))},s.tickFormat=()=>be,s};function ke(e,t,n){let{sortAble:r,compress:a="auto"}=void 0===n?{}:n;if(0===e.length)return[];const s=e.map((e=>t(e)));if("no"===a)return s;r&&s.sort(((e,t)=>e-t));const l=function(e){if(0===e.length)return"";const t=[];let n=0;const r=r=>(r===n+1?t.push(e[n].toString()):r===n+2&&r<10?t.push(`${e[n]},${e[n+1]}`):t.push(`${e[n]}+${r-n-1}`),r);for(let a=1;a<e.length;a++){const t=e[a-1]+1;e[a]!==t&&(n=r(a),n=a)}return r(e.length),t.join(",")}(s),o=JSON.stringify(s).length,i=l.length+2;return i<.6*o||o-i>50||"yes"===a&&i<o?l:s}function Ce(e,t){return"string"==typeof e?0===e.length?[]:e.split(",").map((e=>{if(e.includes("+")){const[n,r]=e.split("+").map((e=>Number.parseInt(e,10)));return t.slice(n,n+r+1)}return t[Number.parseInt(e,10)]})).flat():e.map((e=>t[e]))}function Me(e,t){return t.color&&(e.color=t.color),e}function Ne(e,t,n){void 0===n&&(n={});const r=e.sets.map((e=>W(Object.assign(Object.assign({},e),{elems:Ce(e.elems,t)})))),a=e.combinations?e.combinations.map((e=>z(Object.assign(Object.assign({},e),{elems:Ce(e.elems,t)}),e.type,(e=>e.sets.map((e=>r[e])))))):D(r,Object.assign({type:"intersection",elems:t,toElemKey:n.toElemKey},null!==(s=e.combinationOptions)&&void 0!==s?s:{}));var s;function l(e){return"set"===e.type?r[e.index]:a[e.index]}return{sets:r,combinations:a,selection:e.selection?"string"==typeof e.selection||Array.isArray(e.selection)?Ce(e.selection,t):l(e.selection):void 0,queries:e.queries.map((e=>e.set?{name:e.name,color:e.color,set:l(e.set)}:{name:e.name,color:e.color,elems:Ce(e.elems,t)}))}}function Oe(e,t){var n;void 0===t&&(t={});const r=Object.assign({sortAble:!0},t),a=null!==(n=t.toKey)&&void 0!==n?n:Z,s=new Map(e.sets.map(((e,t)=>[a(e),t]))),l=new Map(e.combinations.map(((e,t)=>[a(e),t]))),o=t=>{if("set"===t.type)return{type:t.type,index:s.get(a(t))};const n=l.get(a(t));return null==n||n<0?ke(t.elems,e.toElemIndex,r):{type:t.type,index:n}},i=e.sets.map(((e,t)=>({key:a(e),i:t})));return{sets:e.sets.map((t=>Me({name:t.name,cardinality:t.cardinality,elems:ke(t.elems,e.toElemIndex,r)},t))),combinations:"no"===t.compress?e.combinations.map((t=>{const n=new Set(Array.from(t.sets).map(a));return Me({name:t.name,type:t.type,cardinality:t.cardinality,degree:t.degree,sets:i.filter((e=>{let{key:t}=e;return n.has(t)})).map((e=>{let{i:t}=e;return t})),elems:ke(t.elems,e.toElemIndex,r)},t)})):void 0,combinationOptions:e.combinationOptions,selection:e.selection?Array.isArray(e.selection)?ke(e.selection,e.toElemIndex,r):o(e.selection):void 0,queries:e.queries.map((t=>{const n=g(t)?o(t.set):ke(Array.from(t.elems),e.toElemIndex,r);return{name:t.name,color:t.color,set:"string"==typeof n||Array.isArray(n)?void 0:n,elems:"string"==typeof n||Array.isArray(n)?n:void 0}}))}}function Ae(e,t){return 1===e.length?e[0].name:`(${e.map((e=>e.name)).join(_[t])})`}function Le(e,t){var n;void 0===t&&(t={});const r=null!==(n=t.toKey)&&void 0!==n?n:Z,a=new Map(e.sets.map(((e,t)=>[r(e),t]))),s=new Map(e.combinations.map(((e,t)=>[r(e),t]))),l=t=>{if(S(t)){if("set"===t.type)return{type:t.type,index:a.get(r(t))};const e=s.get(r(t));if(null!=e&&e>=0)return{type:t.type,index:e}}const n=m(S(t)?t.elems:t);return e.sets.map((e=>n(e.elems).intersection)).concat(e.combinations.map((e=>n(e.elems).intersection)))},o=new Map(e.sets.map(((e,t)=>[r(e),t]))),i=ce(e.sets,e.combinations,t),c="yes"===t.compress;return{sets:c?e.sets.map((e=>({n:e.name,cc:e.color,c:e.cardinality}))):e.sets.map((e=>Me({name:e.name,cardinality:e.cardinality},e))),combinations:c?e.combinations.map((t=>{const n=Array.from(t.sets).map((e=>o.get(r(e)))).sort(((e,t)=>e-t)),a={c:t.cardinality,s:n.reduce(((e,t)=>e+Math.pow(2,t)),0)};return t.name!==Ae(n.map((t=>e.sets[t])),t.type)&&(a.n=t.name),"intersection"!==t.type&&(a.type=t.type[0]),t.color&&(a.cc=t.color),a})):e.combinations.map((e=>Me({name:e.name,cardinality:e.cardinality,type:e.type,sets:Array.from(e.sets).map((e=>o.get(r(e)))).sort(((e,t)=>e-t))},e))),overlaps:i,selection:e.selection?l(e.selection):void 0,queries:e.queries.map((t=>{if(g(t)){const e=l(t.set);return Array.isArray(e)?{name:t.name,color:t.color,overlaps:e}:{name:t.name,color:t.color,set:e}}const n=m(t.elems),r=e.sets.map((e=>n(e.elems).intersection)).concat(e.combinations.map((e=>n(e.elems).intersection)));return{name:t.name,color:t.color,overlaps:r}}))}}function qe(e){return"number"==typeof e.c}function je(e){return"number"==typeof e.c}function ze(e,t){var n;void 0===t&&(t={});const r=null!==(n=t.toKey)&&void 0!==n?n:Z;let a=()=>0;function s(e){return e.overlap=t=>a(e,t),e}const l=e.sets.map((e=>s({name:je(e)?e.n:e.name,cardinality:je(e)?e.c:e.cardinality,type:"set",elems:[]}))),o=e.combinations.map((e=>{var t,n;const r=qe(e)?(a=e.s,l.filter(((e,t)=>{const n=Math.pow(2,t);return(a&n)===n}))):e.sets.map((e=>l[e]));var a;const o={i:"intersection",u:"union",c:"composite",d:"distinctIntersection"}[(null!==(t=e.type)&&void 0!==t?t:"i")[0]];return s({name:qe(e)?null!==(n=e.n)&&void 0!==n?n:Ae(r,o):e.name,cardinality:qe(e)?e.c:e.cardinality,type:o,degree:r.length,sets:new Set(r),elems:[]})})),{setIndex:i,combinationIndex:c,compute:m}=me(e.overlaps,l,o,r);function u(e){return"set"===e.type?l[e.index]:o[e.index]}function d(e){return t=>{const n=r(t),a=i.has(n)?i.get(n):c.get(n);return null==a||a<0||a>=e.length?0:e[a]}}return a=m,{sets:l,combinations:o,selection:e.selection?Array.isArray(e.selection)?d(e.selection):u(e.selection):void 0,queries:e.queries.map((e=>e.set?{name:e.name,color:e.color,set:u(e.set)}:{name:e.name,color:e.color,overlap:d(e.overlaps)}))}}var Ie=n(5987),_e=n.n(Ie);function Te(e){return Array.from(e.classList).find((e=>e.startsWith("root-"))).slice("root-".length)}function Fe(e,t){var n,r;return null!==(r=null===(n=e.querySelector(`titleTextStyle-${t}`))||void 0===n?void 0:n.textContent)&&void 0!==r?r:"UpSetJS"}function Be(e,t){var n,r;return null!==(r=null===(n=e.querySelector(`descTextStyle-${t}`))||void 0===n?void 0:n.textContent)&&void 0!==r?r:""}const Pe={},He=[],Ke={setLabel:"16px",axisTick:"10px",chartLabel:"16px",barLabel:"10px",legend:"10px",description:"16px",title:"24px",valueLabel:"12px",exportLabel:"10px"},Re=[.18,.12,.7],De=[.6,.4],We={type:"intersection",order:["cardinality:desc","name:asc"]},Ue=Object.keys(Ke),Ve=["axisTick","bar","barLabel","chartLabel","dot","legend","title","description","setLabel","set","valueLabel"],Qe=["dump","png","share","svg","vega"],Ge=[.7,.4],Je=[.15,.3];var Ze={sets:[],intersections:[],bb:{x:0,y:0,width:10,height:10}},Ye={sets:[{cx:0,cy:0,r:5,text:{x:3.5,y:-4},align:"start",verticalAlign:"bottom"}],intersections:[{sets:[0],x1:0,y1:5,arcs:[{mode:"i",ref:0,x2:0,y2:-5,sweep:!1,large:!1},{mode:"i",ref:0,x2:0,y2:5,sweep:!1,large:!1}],text:{x:0,y:0}}],bb:{x:-5,y:-5,width:10,height:10}},Xe={sets:[{cx:-4,cy:0,r:5,text:{x:-7.5,y:4},align:"end",verticalAlign:"top"},{cx:4,cy:0,r:5,text:{x:7.5,y:-4},align:"start",verticalAlign:"bottom"}],intersections:[{sets:[0],x1:0,y1:-3,arcs:[{mode:"i",ref:0,x2:0,y2:3,sweep:!1,large:!0},{mode:"o",ref:1,x2:0,y2:-3,sweep:!0,large:!1}],text:{x:-4,y:0}},{sets:[1],x1:0,y1:3,arcs:[{mode:"i",ref:1,x2:0,y2:-3,sweep:!1,large:!0},{mode:"o",ref:0,x2:0,y2:3,sweep:!0,large:!1}],text:{x:4,y:0}},{sets:[0,1],x1:0,y1:3,arcs:[{mode:"i",ref:0,x2:0,y2:-3,sweep:!1,large:!1},{mode:"i",ref:1,x2:0,y2:3,sweep:!1,large:!1}],text:{x:0,y:0}}],bb:{x:-9,y:-5,width:18,height:10}},et={sets:[{cx:-3.464,cy:-2,r:5,text:{x:-7,y:-6},align:"end",verticalAlign:"bottom"},{cx:3.464,cy:-2,r:5,text:{x:7,y:-6},align:"start",verticalAlign:"bottom"},{cx:0,cy:4,r:5,text:{x:4,y:7.5},align:"start",verticalAlign:"top"}],intersections:[{sets:[0],x1:-4.855,y1:2.803,arcs:[{mode:"o",ref:2,x2:-1.39,y2:-.803,sweep:!0,large:!1},{mode:"o",ref:1,x2:0,y2:-5.606,sweep:!0,large:!1},{mode:"i",ref:0,x2:-4.855,y2:2.803,sweep:!1,large:!0}],text:{x:-4.216,y:-2.434}},{sets:[1],x1:0,y1:-5.606,arcs:[{mode:"o",ref:0,x2:1.39,y2:-.803,sweep:!0,large:!1},{mode:"o",ref:2,x2:4.855,y2:2.803,sweep:!0,large:!1},{mode:"i",ref:1,x2:0,y2:-5.606,sweep:!1,large:!0}],text:{x:4.216,y:-2.434}},{sets:[2],x1:-4.855,y1:2.803,arcs:[{mode:"o",ref:0,x2:0,y2:1.606,sweep:!1,large:!1},{mode:"o",ref:1,x2:4.855,y2:2.803,sweep:!1,large:!1},{mode:"i",ref:2,x2:-4.855,y2:2.803,sweep:!0,large:!0}],text:{x:0,y:4.869}},{sets:[0,1],x1:0,y1:-5.606,arcs:[{mode:"i",ref:1,x2:-1.39,y2:-.803,sweep:!1,large:!1},{mode:"o",ref:2,x2:1.39,y2:-.803,sweep:!0,large:!1},{mode:"i",ref:0,x2:0,y2:-5.606,sweep:!1,large:!1}],text:{x:0,y:-2.404}},{sets:[0,2],x1:-4.855,y1:2.803,arcs:[{mode:"i",ref:2,x2:-1.39,y2:-.803,sweep:!0,large:!1},{mode:"o",ref:1,x2:0,y2:1.606,sweep:!1,large:!1},{mode:"i",ref:0,x2:-4.855,y2:2.803,sweep:!0,large:!1}],text:{x:-2.082,y:1.202}},{sets:[1,2],x1:4.855,y1:2.803,arcs:[{mode:"i",ref:2,x2:1.39,y2:-.803,sweep:!1,large:!1},{mode:"o",ref:0,x2:0,y2:1.606,sweep:!0,large:!1},{mode:"i",ref:1,x2:4.855,y2:2.803,sweep:!1,large:!1}],text:{x:2.082,y:1.202}},{sets:[0,1,2],x1:1.39,y1:-.803,arcs:[{mode:"i",ref:0,x2:0,y2:1.606,sweep:!0,large:!1},{mode:"i",ref:1,x2:-1.39,y2:-.803,sweep:!0,large:!1},{mode:"i",ref:2,x2:1.39,y2:-.803,sweep:!0,large:!1}],text:{x:0,y:0}}],bb:{x:-8.464,y:-7,width:16.928,height:16}},tt={sets:[{cx:.439,cy:-1.061,rx:2.5,ry:5,rotation:45,text:{x:4.5,y:-4.5},align:"start",verticalAlign:"bottom"},{cx:2.561,cy:1.061,rx:2.5,ry:5,rotation:45,text:{x:4,y:3.75},align:"start",verticalAlign:"top"},{cx:-2.561,cy:1.061,rx:2.5,ry:5,rotation:-45,text:{x:-4,y:3.7},align:"end",verticalAlign:"top"},{cx:-.439,cy:-1.061,rx:2.5,ry:5,rotation:-45,text:{x:-4.5,y:-4.5},align:"end",verticalAlign:"bottom"}],intersections:[{sets:[0],x1:0,y1:-3.94,arcs:[{ref:0,mode:"i",x2:4.328,y2:-2.828,sweep:!0,large:!1},{ref:1,mode:"o",x2:2.179,y2:-1.858,large:!1},{ref:3,mode:"o",x2:0,y2:-3.94,large:!1}],text:{x:2.914,y:-3.536}},{sets:[1],x1:4.328,y1:-2.828,arcs:[{ref:1,mode:"i",x2:0,y2:5.006,sweep:!0,large:!0},{ref:2,mode:"o",x2:1.328,y2:2.828},{ref:3,mode:"o",x2:3.108,y2:-.328},{ref:0,mode:"o",x2:4.328,y2:-2.828}],text:{x:5.036,y:-1.414}},{sets:[2],x1:0,y1:5.006,arcs:[{ref:2,mode:"i",x2:-4.328,y2:-2.828,sweep:!0,large:!0},{ref:3,mode:"o",x2:-3.108,y2:-.328},{ref:0,mode:"o",x2:-1.328,y2:2.828},{ref:1,mode:"o",x2:0,y2:5.006}],text:{x:-5.036,y:-1.414}},{sets:[3],x1:-4.328,y1:-2.828,arcs:[{ref:3,mode:"i",x2:0,y2:-3.94,sweep:!0,large:!1},{ref:0,mode:"o",x2:-2.179,y2:-1.858,large:!1},{ref:2,mode:"o",x2:-4.328,y2:-2.828,large:!1}],text:{x:-2.914,y:-3.536}},{sets:[0,1],x1:4.328,y1:-2.828,arcs:[{ref:1,mode:"i",x2:3.108,y2:-.328,sweep:!0,large:!1},{ref:3,mode:"o",x2:2.179,y2:-1.858,sweep:!1,large:!1},{ref:0,mode:"i",x2:4.328,y2:-2.828,sweep:!0,large:!1}],text:{x:3.205,y:-1.672}},{sets:[0,2],x1:-1.328,y1:2.828,arcs:[{ref:0,mode:"i",x2:-3.108,y2:-.328,sweep:!0,large:!1},{ref:3,mode:"o",x2:-.969,y2:1.755,large:!1},{ref:1,mode:"o",x2:-1.328,y2:2.828,large:!1}],text:{x:-2.212,y:1.591}},{sets:[0,3],x1:0,y1:-3.94,arcs:[{ref:3,mode:"i",x2:2.179,y2:-1.858,sweep:!0,large:!1},{ref:1,mode:"o",x2:0,y2:.188,sweep:!1,large:!1},{ref:2,mode:"o",x2:-2.179,y2:-1.858,sweep:!1,large:!1},{ref:0,mode:"i",x2:0,y2:-3.94,sweep:!0}],text:{x:0,y:-1.87}},{sets:[1,2],x1:1.328,y1:2.828,arcs:[{ref:2,mode:"i",x2:0,y2:5.006,sweep:!0,large:!1},{ref:1,mode:"i",x2:-1.328,y2:2.828,sweep:!0,large:!1},{ref:0,mode:"o",x2:0,y2:2.346,large:!1},{ref:3,mode:"o",x2:1.328,y2:2.828}],text:{x:0,y:3.393}},{sets:[1,3],x1:3.108,y1:-.328,arcs:[{ref:3,mode:"i",x2:1.328,y2:2.828,sweep:!0,large:!1},{ref:2,mode:"o",x2:.969,y2:1.755,large:!1},{ref:1,mode:"i",x2:3.108,y2:-.328,large:!1}],text:{x:2.212,y:1.591}},{sets:[2,3],x1:-3.108,y1:-.328,arcs:[{ref:3,mode:"i",x2:-4.328,y2:-2.828,sweep:!0,large:!1},{ref:2,mode:"i",x2:-2.179,y2:-1.858,sweep:!0,large:!1},{ref:0,mode:"o",x2:-3.108,y2:-.328,large:!1}],text:{x:-3.205,y:-1.672}},{sets:[0,1,2],x1:0,y1:2.346,arcs:[{ref:0,mode:"i",x2:-1.328,y2:2.828,sweep:!0,large:!1},{ref:1,mode:"i",x2:-.969,y2:1.755,sweep:!0,large:!1},{ref:3,mode:"o",x2:0,y2:2.346,large:!1}],text:{x:-.766,y:2.31}},{sets:[0,1,3],x1:2.179,y1:-1.858,arcs:[{ref:3,mode:"i",x2:3.108,y2:-.328,sweep:!0,large:!1},{ref:0,mode:"i",x2:.969,y2:1.755,sweep:!0,large:!1},{ref:2,mode:"o",x2:0,y2:.188,sweep:!1,large:!1},{ref:1,mode:"i",x2:2.179,y2:-1.858,sweep:!0}],text:{x:1.558,y:-.056}},{sets:[0,2,3],x1:-.969,y1:1.755,arcs:[{ref:3,mode:"i",x2:-3.108,y2:-.328,sweep:!0,large:!1},{ref:0,mode:"i",x2:-2.179,y2:-1.858,sweep:!0,large:!1},{ref:2,mode:"i",x2:0,y2:.188,sweep:!0,large:!1},{ref:1,mode:"o",x2:-.969,y2:1.755}],text:{x:-1.558,y:-.056}},{sets:[1,2,3],x1:1.328,y1:2.828,arcs:[{ref:3,mode:"i",x2:0,y2:2.346,sweep:!0,large:!1},{ref:0,mode:"o",x2:.969,y2:1.755,sweep:!1,large:!1},{ref:2,mode:"i",x2:1.328,y2:2.828,sweep:!0,large:!1}],text:{x:.766,y:2.31}},{sets:[0,1,2,3],x1:0,y1:.188,arcs:[{ref:2,mode:"i",x2:.969,y2:1.755,sweep:!0,large:!1},{ref:0,mode:"i",x2:0,y2:2.346,sweep:!0,large:!1},{ref:3,mode:"i",x2:-.969,y2:1.755,sweep:!0,large:!1},{ref:1,mode:"i",x2:0,y2:.188,sweep:!0}],text:{x:0,y:1.43}}],bb:{x:-6.5,y:-5,width:13,height:10}},nt={sets:[{cx:.5,cy:-1,rx:2.5,ry:5,rotation:0,text:{x:2.25,y:-5},align:"start",verticalAlign:"bottom"},{cx:1.106,cy:.167,rx:2.5,ry:5,rotation:72,text:{x:4.5,y:1.5},align:"start",verticalAlign:"top"},{cx:.183,cy:1.103,rx:2.5,ry:5,rotation:144,text:{x:4,y:4},align:"start",verticalAlign:"bottom"},{cx:-.992,cy:.515,rx:2.5,ry:5,rotation:216,text:{x:-4.7,y:2},align:"end",verticalAlign:"bottom"},{cx:-.797,cy:-.785,rx:2.5,ry:5,rotation:288,text:{x:-4,y:-3.6},align:"end",verticalAlign:"bottom"}],intersections:[{sets:[0],x1:-1.653,y1:-3.541,arcs:[{ref:0,mode:"i",x2:2.857,y2:-2.666,sweep:!0,large:!1},{ref:1,mode:"o",x2:2.5,y2:-2.648,large:!1},{ref:3,mode:"o",x2:-.495,y2:-3.303,large:!1},{ref:4,mode:"o",x2:-1.653,y2:-3.541}],text:{x:.5,y:-5}},{sets:[1],x1:2.857,y1:-2.666,arcs:[{ref:1,mode:"i",x2:3.419,y2:1.893,sweep:!0,large:!1},{ref:2,mode:"o",x2:3.291,y2:1.559,large:!1},{ref:4,mode:"o",x2:2.988,y2:-1.492,large:!1},{ref:0,mode:"o",x2:2.857,y2:-2.666}],text:{x:4.91,y:-1.07}},{sets:[2],x1:3.419,y1:1.893,arcs:[{ref:2,mode:"i",x2:-.744,y2:3.837,sweep:!0,large:!1},{ref:3,mode:"o",x2:-.466,y2:3.612,large:!1},{ref:0,mode:"o",x2:2.342,y2:2.381,large:!1},{ref:1,mode:"o",x2:3.419,y2:1.893}],text:{x:2.534,y:4.339}},{sets:[3],x1:-.744,y1:3.837,arcs:[{ref:3,mode:"i",x2:-3.879,y2:.478,sweep:!0,large:!1},{ref:4,mode:"o",x2:-3.579,y2:.673,large:!1},{ref:1,mode:"o",x2:-1.54,y2:2.963,large:!1},{ref:2,mode:"o",x2:-.744,y2:3.837}],text:{x:-3.343,y:3.751}},{sets:[4],x1:-3.879,y1:.478,arcs:[{ref:4,mode:"i",x2:-1.653,y2:-3.541,sweep:!0,large:!1},{ref:0,mode:"o",x2:-1.746,y2:-3.196,large:!1},{ref:2,mode:"o",x2:-3.294,y2:-.549,large:!1},{ref:3,mode:"o",x2:-3.879,y2:.478}],text:{x:-4.601,y:-2.021}},{sets:[0,1],x1:2.5,y1:-2.648,arcs:[{ref:1,mode:"i",x2:2.857,y2:-2.666,sweep:!0,large:!1},{ref:0,mode:"i",x2:2.988,y2:-1.492,sweep:!0,large:!1},{ref:4,mode:"o",x2:2.572,y2:-1.839,large:!1},{ref:3,mode:"o",x2:2.5,y2:-2.648}],text:{x:2.741,y:-2.152}},{sets:[0,2],x1:2.342,y1:2.381,arcs:[{ref:0,mode:"i",x2:-.466,y2:3.612,sweep:!0,large:!1},{ref:3,mode:"o",x2:.257,y2:2.922,large:!1},{ref:1,mode:"o",x2:2.342,y2:2.381,large:!1}],text:{x:.5,y:3.5}},{sets:[0,3],x1:-.495,y1:-3.303,arcs:[{ref:3,mode:"i",x2:2.5,y2:-2.648,sweep:!0,large:!1},{ref:1,mode:"o",x2:1.51,y2:-2.515,large:!1},{ref:4,mode:"o",x2:-.495,y2:-3.303,large:!1}],text:{x:1.653,y:-3.125}},{sets:[0,4],x1:-1.653,y1:-3.541,arcs:[{ref:4,mode:"i",x2:-.495,y2:-3.303,sweep:!0,large:!1},{ref:3,mode:"o",x2:-.954,y2:-3.015,large:!1},{ref:2,mode:"o",x2:-1.746,y2:-3.196,large:!1},{ref:0,mode:"i",x2:-1.653,y2:-3.541}],text:{x:-1.199,y:-3.272}},{sets:[1,2],x1:3.291,y1:1.559,arcs:[{ref:2,mode:"i",x2:3.419,y2:1.893,sweep:!0,large:!1},{ref:1,mode:"i",x2:2.342,y2:2.381,sweep:!0,large:!1},{ref:0,mode:"o",x2:2.544,y2:1.878,large:!1},{ref:4,mode:"o",x2:3.291,y2:1.559}],text:{x:2.894,y:1.942}},{sets:[1,3],x1:-1.54,y1:2.963,arcs:[{ref:1,mode:"i",x2:-3.579,y2:.673,sweep:!0,large:!1},{ref:4,mode:"o",x2:-2.7,y2:1.147,large:!1},{ref:2,mode:"o",x2:-1.54,y2:2.963,large:!1}],text:{x:-3.174,y:1.557}},{sets:[1,4],x1:2.988,y1:-1.492,arcs:[{ref:4,mode:"i",x2:3.291,y2:1.559,sweep:!0,large:!1},{ref:2,mode:"o",x2:2.858,y2:.659,large:!1},{ref:0,mode:"o",x2:2.988,y2:-1.492,large:!1}],text:{x:3.483,y:.606}},{sets:[2,3],x1:-.466,y1:3.612,arcs:[{ref:3,mode:"i",x2:-.744,y2:3.837,sweep:!0,large:!1},{ref:2,mode:"i",x2:-1.54,y2:2.963,sweep:!0,large:!1},{ref:1,mode:"o",x2:-1,y2:3,large:!1},{ref:0,mode:"o",x2:-.466,y2:3.612}],text:{x:-.953,y:3.352}},{sets:[2,4],x1:-3.294,y1:-.549,arcs:[{ref:2,mode:"i",x2:-1.746,y2:-3.196,sweep:!0},{ref:0,mode:"o",x2:-1.925,y2:-2.213},{ref:3,mode:"o",x2:-3.294,y2:-.549}],text:{x:-2.462,y:-2.538}},{sets:[3,4],x1:-3.579,y1:.673,arcs:[{ref:4,mode:"i",x2:-3.879,y2:.478,sweep:!0,large:!1},{ref:3,mode:"i",x2:-3.294,y2:-.549,sweep:!0,large:!1},{ref:2,mode:"o",x2:-3.162,y2:-.024,large:!1},{ref:1,mode:"o",x2:-3.579,y2:.673}],text:{x:-3.483,y:.13}},{sets:[0,1,2],x1:2.544,y1:1.878,arcs:[{ref:0,mode:"i",x2:2.342,y2:2.381,sweep:!0,large:!1},{ref:1,mode:"i",x2:.257,y2:2.922,sweep:!0,large:!1},{ref:3,mode:"o",x2:.983,y2:2.049,large:!1},{ref:4,mode:"o",x2:2.544,y2:1.878}],text:{x:1.457,y:2.331}},{sets:[0,1,3],x1:1.51,y1:-2.515,arcs:[{ref:1,mode:"i",x2:2.5,y2:-2.648,sweep:!0,large:!1},{ref:3,mode:"i",x2:2.572,y2:-1.839,sweep:!0,large:!1},{ref:4,mode:"o",x2:1.51,y2:-2.515,large:!1}],text:{x:2.194,y:-2.334}},{sets:[0,1,4],x1:2.572,y1:-1.839,arcs:[{ref:4,mode:"i",x2:2.988,y2:-1.492,sweep:!0,large:!1},{ref:0,mode:"i",x2:2.858,y2:.659,sweep:!0,large:!1},{ref:2,mode:"o",x2:2.253,y2:-.302,large:!1},{ref:3,mode:"o",x2:2.572,y2:-1.839}],text:{x:2.667,y:-.665}},{sets:[0,2,3],x1:.257,y1:2.922,arcs:[{ref:3,mode:"i",x2:-.466,y2:3.612,sweep:!0,large:!1},{ref:0,mode:"i",x2:-1,y2:3,sweep:!0,large:!1},{ref:1,mode:"o",x2:.257,y2:2.922,large:!1}],text:{x:-.403,y:3.178}},{sets:[0,2,4],x1:-1.746,y1:-3.196,arcs:[{ref:2,mode:"i",x2:-.954,y2:-3.015,sweep:!0,large:!1},{ref:3,mode:"o",x2:-1.925,y2:-2.213,sweep:!1,large:!1},{ref:0,mode:"i",x2:-1.746,y2:-3.196,sweep:!0,large:!1}],text:{x:-1.542,y:-2.808}},{sets:[0,3,4],x1:-.495,y1:-3.303,arcs:[{ref:4,mode:"i",x2:1.51,y2:-2.515,sweep:!0,large:!1},{ref:1,mode:"o",x2:.409,y2:-2.236,large:!1},{ref:2,mode:"o",x2:-.954,y2:-3.015,large:!1},{ref:3,mode:"i",x2:-.495,y2:-3.303}],text:{x:.192,y:-2.742}},{sets:[1,2,3],x1:-1.54,y1:2.963,arcs:[{ref:2,mode:"i",x2:-2.7,y2:1.147,sweep:!0,large:!1},{ref:4,mode:"o",x2:-1.645,y2:1.568,large:!1},{ref:0,mode:"o",x2:-1,y2:3,large:!1},{ref:1,mode:"i",x2:-1.54,y2:2.963}],text:{x:-1.767,y:2.106}},{sets:[1,2,4],x1:2.858,y1:.659,arcs:[{ref:2,mode:"i",x2:3.291,y2:1.559,sweep:!0,large:!1},{ref:4,mode:"i",x2:2.544,y2:1.878,sweep:!0,large:!1},{ref:0,mode:"o",x2:2.858,y2:.659,large:!1}],text:{x:2.898,y:1.365}},{sets:[1,3,4],x1:-2.7,y1:1.147,arcs:[{ref:4,mode:"i",x2:-3.579,y2:.673,sweep:!0,large:!1},{ref:1,mode:"i",x2:-3.162,y2:-.024,sweep:!0,large:!1},{ref:2,mode:"o",x2:-2.7,y2:1.147,large:!1}],text:{x:-3.147,y:.599}},{sets:[2,3,4],x1:-3.294,y1:-.549,arcs:[{ref:3,mode:"i",x2:-1.925,y2:-2.213,sweep:!0,large:!1},{ref:0,mode:"o",x2:-2,y2:-1.08,large:!1},{ref:1,mode:"o",x2:-3.162,y2:-.024,large:!1},{ref:2,mode:"i",x2:-3.294,y2:-.549}],text:{x:-2.548,y:-1.029}},{sets:[0,1,2,3],x1:.983,y1:2.049,arcs:[{ref:3,mode:"i",x2:.257,y2:2.922,sweep:!0,large:!1},{ref:1,mode:"i",x2:-1,y2:3,sweep:!0,large:!1},{ref:0,mode:"i",x2:-1.645,y2:1.568,sweep:!0,large:!1},{ref:4,mode:"o",x2:.983,y2:2.049}],text:{x:-.407,y:2.31}},{sets:[0,1,2,4],x1:2.253,y1:-.302,arcs:[{ref:2,mode:"i",x2:2.858,y2:.659,sweep:!0,large:!1},{ref:0,mode:"i",x2:2.544,y2:1.878,sweep:!0,large:!1},{ref:4,mode:"i",x2:.983,y2:2.049,sweep:!0,large:!1},{ref:3,mode:"o",x2:2.253,y2:-.302}],text:{x:2.071,y:1.101}},{sets:[0,1,3,4],x1:1.51,y1:-2.515,arcs:[{ref:4,mode:"i",x2:2.572,y2:-1.839,sweep:!0,large:!1},{ref:3,mode:"i",x2:2.253,y2:-.302,sweep:!0,large:!1},{ref:2,mode:"o",x2:.409,y2:-2.236,sweep:!1,large:!1},{ref:1,mode:"i",x2:1.51,y2:-2.515,sweep:!0}],text:{x:1.687,y:-1.63}},{sets:[0,2,3,4],x1:-2,y1:-1.08,arcs:[{ref:0,mode:"i",x2:-1.925,y2:-2.213,sweep:!0,large:!1},{ref:3,mode:"i",x2:-.954,y2:-3.015,sweep:!0,large:!1},{ref:2,mode:"i",x2:.409,y2:-2.236,sweep:!0,large:!1},{ref:1,mode:"o",x2:-2,y2:-1.08}],text:{x:-1.028,y:-2.108}},{sets:[1,2,3,4],x1:-1.645,y1:1.568,arcs:[{ref:4,mode:"i",x2:-2.7,y2:1.147,sweep:!0,large:!1},{ref:2,mode:"i",x2:-3.162,y2:-.024,sweep:!0,large:!1},{ref:1,mode:"i",x2:-2,y2:-1.08,sweep:!0,large:!1},{ref:0,mode:"o",x2:-1.645,y2:1.568}],text:{x:-2.323,y:.327}},{sets:[0,1,2,3,4],x1:.409,y1:-2.236,arcs:[{ref:2,mode:"i",x2:2.253,y2:-.302,sweep:!0,large:!1},{ref:3,mode:"i",x2:.983,y2:2.049,sweep:!0,large:!1},{ref:4,mode:"i",x2:-1.645,y2:1.568,sweep:!0,large:!1},{ref:0,mode:"i",x2:-2,y2:-1.08,sweep:!0},{ref:1,mode:"i",x2:.409,y2:-2.236,sweep:!0}],text:{x:0,y:0}}],bb:{x:-5.5,y:-6,width:11.6,height:11.8}};function rt(e){return"number"==typeof e.rx}const at={maxSets:5,compute:(e,t,n,r)=>st(e.length,n,r)};function st(e,t,n){const r=[Ze,Ye,Xe,et,tt,nt],a=r[Math.min(r.length-1,e)],s=Math.min(t/a.bb.width,n/a.bb.height),l=s*-a.bb.x+(t-s*a.bb.width)/2,o=s*-a.bb.y+(n-s*a.bb.height)/2,i=e=>l+s*e,c=e=>o+s*e;return{sets:a.sets.map((e=>Object.assign({},e,{cx:i(e.cx),cy:c(e.cy),text:{x:i(e.text.x),y:c(e.text.y)}},rt(e)?{rx:e.rx*s,ry:e.ry*s}:{r:e.r*s}))),intersections:a.intersections.map((e=>({text:{x:i(e.text.x),y:c(e.text.y)},x1:i(e.x1),y1:c(e.y1),sets:e.sets,arcs:e.arcs.map((e=>Object.assign({},e,{x2:i(e.x2),y2:c(e.y2)})))})))}}const lt={selectionColor:"#ffa500",color:"#000000",hasSelectionColor:"",opacity:1,hasSelectionOpacity:-1,textColor:"#000000",hoverHintColor:"#cccccc",notMemberColor:"#d3d3d3",alternatingBackgroundColor:"rgba(0,0,0,0.05)",valueTextColor:"#000000",strokeColor:"#000000",backgroundColor:"#ffffff",filled:!1},ot={selectionColor:"#ffa500",color:"#cccccc",hasSelectionColor:"",opacity:1,hasSelectionOpacity:-1,textColor:"#ffffff",hoverHintColor:"#d9d9d9",notMemberColor:"#666666",alternatingBackgroundColor:"rgba(255, 255, 255, 0.2)",valueTextColor:"#ffffff",strokeColor:"#ffffff",backgroundColor:"#303030",filled:!1},it={selectionColor:"#4c78a8",color:"#4c78a8",hasSelectionColor:"#c9d6e5",opacity:1,hasSelectionOpacity:-1,textColor:"#000000",hoverHintColor:"#cccccc",notMemberColor:"#d3d3d3",alternatingBackgroundColor:"rgba(0,0,0,0.05)",valueTextColor:"#000000",strokeColor:"#000000",backgroundColor:"#ffffff",filled:!0};function ct(e){return"vega"===e?it:"dark"===e?ot:lt}function mt(e){return Array.isArray(e)}function ut(e){return i.createElement("style",null,e)}function dt(e,t,n){void 0===n&&(n={});const r=ct(t.theme);return Object.assign(e,{queryLegend:null!=t.queries&&t.queries.length>0,theme:"light",padding:20,selection:null,title:"",description:"",fontFamily:"sans-serif",queries:He,exportButtons:!0,className:"",fontSizes:Ke,classNames:Pe,style:Pe,styles:Pe,toKey:Z,tooltips:!0,styleFactory:ut},r,t,n,t.fontSizes?{fontSizes:Object.assign({},Ke,t.fontSizes)}:Pe)}function yt(e){return dt({barPadding:.3,dotPadding:.7,combinations:We,combinationName:null==e.combinations||mt(e.combinations)||"union"!==e.combinations.type?"Intersection Size":"Union Size",barLabelOffset:2,setNameAxisOffset:"auto",combinationNameAxisOffset:"auto",setName:"Set Size",widthRatios:Re,heightRatios:De,setLabelAlignment:"center",numericScale:"linear",bandScale:"band",childrenFactories:Pe,setAddons:He,combinationAddons:He,setAddonPadding:1,combinationAddonPadding:1,emptySelection:!0},e)}function ft(e){return e.toLocaleString()}function pt(e){return yt(e)}function ht(e){return dt({valueFormat:ft,layout:at,setLabelOffsets:He},e,{exportButtons:!1!==e.exportButtons&&Object.assign({},!0===e.exportButtons?{}:e.exportButtons,{vega:!1})})}function gt(e){return ht(e)}function xt(e){return dt({numericScale:"linear",barPadding:.3,barLabelOffset:2,combinationName:"Intersection Size",combinationNameAxisOffset:"auto"},e,{exportButtons:!1!==e.exportButtons&&Object.assign({},!0===e.exportButtons?{}:e.exportButtons,{vega:!1})})}function vt(e){return xt(e)}function bt(e,t){const n=e.cloneNode(!0);return n.style.backgroundColor=ct(e.dataset.theme).backgroundColor,t&&Array.from(n.querySelectorAll(t)).forEach((e=>e.remove())),(new XMLSerializer).serializeToString(n)}function $t(e,t){let{type:n="png",title:r,toRemove:a}=t;const s=new Blob([bt(e,a)],{type:"image/svg+xml;charset=utf-8"}),l=Te(e),o=null!=r?r:Fe(e,l),i=URL.createObjectURL(s);return"svg"===n?(wt(i,`${o}.${n}`,e.ownerDocument),URL.revokeObjectURL(i),Promise.resolve()):function(e,t){const n=t.ownerDocument.createElement("canvas"),r=t.getBoundingClientRect();n.width=r.width,n.height=r.height;const a=n.getContext("2d"),s=new Image(n.width,n.height);return new Promise((t=>{s.onload=()=>{a.drawImage(s,0,0);const e=n.toDataURL("image/png");t(e)},s.src=e}))}(i,e).then((t=>{wt(t,`${o}.${n}`,e.ownerDocument),URL.revokeObjectURL(i)}))}function wt(e,t,n){const r=n.createElement("a");r.href=e,r.style.position="absolute",r.style.left="-10000px",r.style.top="-10000px",r.download=t,n.body.appendChild(r),r.click(),r.remove()}function St(e,t){let{title:n}=void 0===t?{}:t;const r=function(e,t){var n,r,a,s,l;const o=null!==(a=e.getComputedStyle||(null===(r=null===(n=e.ownerDocument)||void 0===n?void 0:n.defaultView)||void 0===r?void 0:r.getComputedStyle))&&void 0!==a?a:window.getComputedStyle,i=Te(e),c=null!=t?t:Fe(e,i),m=Array.from(e.querySelectorAll("[data-upset=sets] [data-cardinality]")).map((e=>({name:e.querySelector(`text.setTextStyle-${i}`).textContent,cardinality:Number.parseInt(e.dataset.cardinality,10)}))).reverse(),u=-Number.parseFloat(e.querySelector(`.sBarTextStyle-${i}`).getAttribute("dx")),d=o(e.querySelector(`.fillPrimary-${i}`)).fill,y=o(e.querySelector(`.fillNotMember-${i}`)).fill,f=o(e.querySelector("text")).fill,p=e.querySelector(`.cChartTextStyle-${i}`).textContent,h=e.querySelector(`.sChartTextStyle-${i}`).textContent,g=Array.from(e.querySelectorAll("[data-upset=cs] [data-cardinality]")).map((e=>({name:e.querySelector(`text.hoverBarTextStyle-${i}`).textContent,cardinality:Number.parseInt(e.dataset.cardinality,10),sets:Array.from(e.querySelectorAll(`.fillPrimary-${i} > title`)).map((e=>e.textContent))}))),x=e=>Number.parseFloat(e.getAttribute("transform").match(/([\d.]+),/)[1]),v=e.querySelector("[data-upset=base]"),b=x(v),$=x(e.querySelector("[data-upset=csaxis]")),w=Number.parseFloat(v.querySelector("g").firstElementChild.children[1].getAttribute("x2")),S=(E=e.querySelector("[data-upset=setaxis]"),Number.parseFloat(E.getAttribute("transform").match(/,([\d.]+)/)[1]));var E;const k=Number.parseFloat(e.querySelector("defs rect").getAttribute("width")),C=Number.parseFloat(e.querySelector("defs rect").getAttribute("height")),M=Number.parseFloat(e.querySelector(`[data-cardinality] circle.fillPrimary-${i}`).getAttribute("r")),N=null!=e.querySelector("[data-upset=sets-s] [data-cardinality]"),O=null!=e.querySelector("[data-upset=sets-q] [data-cardinality]"),A=N||O;let L="orange";A&&(Array.from(e.querySelectorAll(`[data-upset=sets-${N?"s]":"q]:first-of-type"} [data-cardinality]`)).forEach((e=>{const t=m.length-Number.parseInt(e.dataset.i,10)-1;m[t].selection=Number.parseInt(e.dataset.cardinality,10)})),Array.from(e.querySelectorAll(`[data-upset=cs-${N?"s]":"q]:first-of-type"} [data-cardinality]`)).forEach((e=>{const t=Number.parseInt(e.dataset.i,10);g[t].selection=Number.parseInt(e.dataset.cardinality,10)})),L=o(e.querySelector(`[data-upset=sets-${N?"s":"q"}] [data-cardinality]`)).fill);const q=Number.parseInt(null!==(l=null===(s=e.querySelector("[data-upset=cs-ss]"))||void 0===s?void 0:s.dataset.i)&&void 0!==l?l:"-1",10),j=q>=0?{field:"partOf",oneOf:[1,2]}:{field:"partOf",equal:1};return{$schema:"https://vega.github.io/schema/vega-lite/v4.json",title:c,description:Be(e,i),datasets:{sets:m,combinations:g.map(((e,t)=>Object.assign({},e,{partOf:q===t?2:1,nsets:[""]}))).concat(g.map((e=>({name:e.name,cardinality:e.cardinality,partOf:0,sets:[""],nsets:m.filter((t=>!e.sets.includes(t.name))).map((e=>e.name))}))))},vconcat:[{hconcat:[{mark:"bar",width:$+k-40,height:S},{width:w,height:S,data:{name:"combinations"},transform:[{filter:j}],layer:[{mark:{type:"bar",tooltip:!0}},{mark:{type:"text",align:"center",baseline:"bottom",dy:-u},encoding:{text:{field:"cardinality",type:"quantitative"}}},A&&{mark:{type:"bar",fill:L,tooltip:!0},encoding:{y:{field:"selection",type:"quantitative"}}}].filter(Boolean),encoding:{x:{field:"name",type:"ordinal",axis:null,sort:null},y:{field:"cardinality",type:"quantitative",axis:{grid:!1},title:p}}}]},{hconcat:[{width:$,height:C,data:{name:"sets"},layer:[{mark:{type:"bar",tooltip:!0}},{mark:{type:"text",align:"right",baseline:"middle",dx:-u},encoding:{text:{field:"cardinality",type:"quantitative"}}},A&&{mark:{type:"bar",fill:L,tooltip:!0},encoding:{x:{field:"selection",type:"quantitative"}}}].filter(Boolean),encoding:{y:{field:"name",type:"ordinal",axis:null,sort:null},x:{field:"cardinality",type:"quantitative",title:h,sort:"descending",axis:{grid:!1}}}},{data:{name:"sets"},width:k,height:C,mark:{type:"text",align:"center",baseline:"middle",fontSize:Number.parseInt(o(e.querySelector(`.setTextStyle-${i}`)).fontSize,10)},encoding:{y:{field:"name",type:"ordinal",axis:null,sort:null},text:{field:"name",type:"ordinal"}}},{width:w,height:C,data:{name:"combinations"},transform:[{flatten:["sets"],as:["has_set"]},{flatten:["nsets"],as:["has_not_set"]},{calculate:"datum.has_set+datum.has_not_set",as:"set"}],layer:[{mark:{type:"circle",size:M*M*Math.PI,tooltip:!0},encoding:{color:{field:"partOf",type:"nominal",legend:null,scale:{range:[y,d].concat(q>=0?[L]:[])}},y:{field:"set",type:"ordinal",axis:null,sort:null,scale:{domain:m.map((e=>e.name))}}}},{mark:"rule",transform:[{filter:j},{calculate:"datum.sets[datum.sets.length -1]",as:"set_end"}],encoding:Object.assign({y:{field:"sets[0]",type:"ordinal",axis:null,sort:null},y2:{field:"set_end"}},q<0?{}:{color:{field:"partOf",type:"nominal",legend:null,scale:{range:[d,L]}}})}],encoding:{x:{field:"name",type:"ordinal",axis:null,sort:null}}}]}],config:{padding:b,background:ct(e.dataset.theme).backgroundColor,concat:{spacing:0},view:{stroke:null},bar:{fill:d},circle:{opacity:1},rule:{stroke:d,strokeWidth:Number.parseInt(o(e.querySelector("[data-upset=cs] [data-cardinality] line")).strokeWidth,10)},axis:{labelColor:f,labelFontSize:Number.parseInt(o(e.querySelector(`.axisTextStyle-${i}`)).fontSize,10),titleColor:f,titleFontSize:Number.parseInt(o(e.querySelector(`.cChartTextStyle-${i}`)).fontSize,10)},title:{color:f},text:{fill:f,fontSize:Number.parseInt(o(e.querySelector(`.sBarTextStyle-${i}`)).fontSize,10)}}}}(e,n),a=URL.createObjectURL(new Blob([JSON.stringify(r,null,2)],{type:"application/json"}));wt(a,`${r.title}.json`,e.ownerDocument),URL.revokeObjectURL(a)}const Et=["bandScale","numericScale"].concat(["selectionColor","color","textColor","hoverHintColor","notMemberColor","alternatingBackgroundColor","hasSelectionColor","hasSelectionOpacity","opacity","strokeColor","valueTextColor"],["padding","barPadding","dotPadding","widthRatios","heightRatios"],["fontSizes","combinationName","setName","barLabelOffset","setNameAxisOffset","combinationNameAxisOffset","theme","fontFamily","emptySelection","exportButtons","queryLegend"]);function kt(e){var t;const n=pt({width:0,height:0,sets:null!==(t=e.sets)&&void 0!==t?t:[],combinations:e.combinations,theme:e.theme}),r={};return Et.forEach((t=>{const a=e[t],s=n[t];if("theme"!==t||"light"===a){if(null!=a&&a!==s)if("fontSizes"===t){let e=!0;const n={};Ue.forEach((t=>{const r=a[t];r!==s[t]&&(n[t]=r,e=!1)})),e||(r[t]=n)}else r[t]=a}else r[t]=a})),r}function Ct(e,t,n,r,a){return Object.assign({$schema:"https://upset.js.org/schema.1.0.0.json",name:"string"==typeof n.title?n.title:"UpSetJS",description:"string"==typeof n.description?n.description:"",mode:a,author:r,elements:t,attrs:[],props:kt(n)},e)}function Mt(e,t,n,r){return Object.assign({$schema:"https://upset.js.org/schema-static.1.0.0.json",name:"string"==typeof t.title?t.title:"UpSetJS",description:"string"==typeof t.description?t.description:"",mode:r,author:n,props:kt(t)},e)}function Nt(e,t,n,r){var a,s;void 0===n&&(n=!1);const l=[],o=new Map;return Ct(Oe({sets:e.sets,queries:null!==(s=null===(a=e.queries)||void 0===a?void 0:a.filter((e=>p(e)||g(e))))&&void 0!==s?s:[],toElemIndex:e=>o.has(e)?o.get(e):(o.set(e,l.length),l.push(e),l.length-1),selection:e.selection&&S(e.selection)?e.selection:void 0,combinations:t.cs.v,combinationOptions:Array.isArray(e.combinations)?{}:e.combinations},{compress:n?"yes":"no"}),l,e,void 0,r)}function Ot(e,t,n,r){const a=Nt(t,n,!1,r),s=URL.createObjectURL(new Blob([JSON.stringify(a,null,2)],{type:"application/json"}));wt(s,`${a.name}.json`,e.ownerDocument),URL.revokeObjectURL(s)}function At(e,t,n){const r=Nt(e,t,!0,n);delete r.$schema;const a=_e().compressToEncodedURIComponent(JSON.stringify(r)),s=new URL("https://upset.js.org/app/embed.html");if(s.searchParams.set("p",a),s.toString().length<4096)return window.open(s.toString(),"_blank"),!0;const l=function(e,t,n,r){var a,s;return void 0===n&&(n=!1),Mt(Le({sets:e.sets,queries:null!==(s=null===(a=e.queries)||void 0===a?void 0:a.filter((e=>p(e)||g(e))))&&void 0!==s?s:[],selection:e.selection&&S(e.selection)?e.selection:void 0,combinations:t.cs.v},{compress:n?"yes":"no"}),e,void 0,r)}(e,t,!0,n);delete l.$schema;const o=_e().compressToEncodedURIComponent(JSON.stringify(l));if(s.searchParams.set("p",o),s.toString().length<4096)return window.open(s.toString(),"_blank"),!0;s.searchParams.delete("p");const i=window.open(s.toString(),"_blank");return null==i||i.addEventListener("load",(()=>{null==i||i.postMessage(r,s.origin)})),!1}function Lt(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter(Boolean).join(" ")}function qt(e){return`upset-${Math.random().toString(36).slice(4)}`}function jt(e){return null!=e&&!Array.isArray(e)}function zt(e,t){const n=m(e,t);return e=>n(e.elems).intersection}function It(){return-1}function _t(e,t,n){if(!e)return Ft;if("function"==typeof e)return e;if(Array.isArray(e))return zt(e,n);const r=e;if(r.overlap)return r.overlap.bind(r);let a=null;return e=>{if(e.overlap)return e.overlap(r);const s=t(e,r);return s>=0?s:(a||(a=zt(r.elems,n)),a(e))}}function Tt(e){var t;return Array.isArray(e)?`Array(${e.length})`:"function"==typeof e?"?":null===(t=e)||void 0===t?void 0:t.name}function Ft(){return 0}function Bt(e){return null==e?10:e.endsWith("pt")?Math.floor(4/3*Number.parseInt(e,10)):Number.parseInt(e,10)}function Pt(e){return"linear"===e?ve:"log"===e?Ee:e}function Ht(e){return"band"===e?ue:e}function Kt(e){return Array.isArray(e)}function Rt(e){let{transform:t,styleId:n,exportButtons:r,exportChart:a}=e;if(!r)return null;let s=0;const l=[];return!0!==r&&!1===r.svg||(s+=26,l.push(i.createElement("g",{key:"svg",className:`exportButton-${n}`,onClick:a,"data-type":"svg",transform:`translate(-${s}, 0)`},i.createElement("title",null,"Download SVG Image"),i.createElement("rect",{y:-9,width:26,height:11,rx:2,ry:2}),i.createElement("text",{className:`exportTextStyle-${n}`,x:13},"SVG"))),s+=2),!0!==r&&!1===r.png||(s+=26,l.push(i.createElement("g",{key:"png",className:`exportButton-${n}`,onClick:a,"data-type":"png",transform:`translate(-${s}, 0)`},i.createElement("title",null,"Download PNG Image"),i.createElement("rect",{y:-9,width:26,height:11,rx:2,ry:2}),i.createElement("text",{className:`exportTextStyle-${n}`,x:13},"PNG"))),s+=2),!0!==r&&!1===r.vega||(s+=34,l.push(i.createElement("g",{key:"vega",className:`exportButton-${n}`,onClick:a,"data-type":"vega",transform:`translate(-${s}, 0)`},i.createElement("title",null,"Download VEGA-Lite Specification"),i.createElement("rect",{y:-9,width:34,height:11,rx:2,ry:2}),i.createElement("text",{className:`exportTextStyle-${n}`,x:17},"VEGA"))),s+=2),!0!==r&&!1===r.dump||(s+=34,l.push(i.createElement("g",{key:"dump",className:`exportButton-${n}`,onClick:a,"data-type":"dump",transform:`translate(-${s}, 0)`},i.createElement("title",null,"Download UpSet.js JSON Dump"),i.createElement("rect",{y:-9,width:34,height:11,rx:2,ry:2}),i.createElement("text",{className:`exportTextStyle-${n}`,x:17},"DUMP"))),s+=2),!0!==r&&!1===r.share||(s+=42,l.push(i.createElement("g",{key:"share",className:`exportButton-${n}`,onClick:a,"data-type":"share",transform:`translate(-${s}, 0)`},i.createElement("title",null,"Open a shareable URL"),i.createElement("rect",{y:-9,width:42,height:11,rx:2,ry:2}),i.createElement("text",{className:`exportTextStyle-${n}`,x:21},"SHARE"))),s+=2),i.createElement("g",{className:`exportButtons-${n}`,transform:t},l)}const Dt=i.memo((function(e){let{queries:t,x:n,style:r,data:a}=e;return i.createElement("text",{transform:`translate(${n},4)`,style:r.styles.legend,className:Lt(`legendTextStyle-${r.id}`,r.classNames.legend)},t.map(((e,t)=>{let n=null;return g(e)?n=e.set.cardinality:p(e)&&(n=e.elems instanceof Set?e.elems.size:e.elems.length),i.createElement(i.Fragment,{key:e.name},i.createElement("tspan",{className:`fillQ${t}-${a.id}`},"  \u2b24 "),i.createElement("tspan",null,e.name,null!=n?`: ${a.sets.format(n)}`:""))})))})),Wt=i.memo((function(e){let{pos:t,spacing:n,tickSizeInner:r,orient:a,name:s,style:l}=e;const o="top"===a||"left"===a?-1:1;return i.createElement("g",{transform:`translate(0, ${t+.5})`},s&&i.createElement("text",{x:o*n,dy:"0.32em",className:Lt(`axisTextStyle-${l.id}`,"right"===a?`startText-${l.id}`:`endText-${l.id}`,l.classNames.axisTick),style:l.styles.axisTick},s),i.createElement("line",{x2:o*r,className:`axisLine-${l.id}`}))})),Ut=i.memo((function(e){let{pos:t,name:n,spacing:r,orient:a,tickSizeInner:s,style:l}=e;const o="top"===a||"left"===a?-1:1;return i.createElement("g",{transform:`translate(${t+.5}, 0)`},n&&i.createElement("text",{y:o*r,dy:"top"===a?"0em":"0.71em",className:Lt(`axisTextStyle-${l.id}`,l.classNames.axisTick),style:l.styles.axisTick},n),i.createElement("line",{y2:o*s,className:`axisLine-${l.id}`}))}));function Vt(e){let{scale:t,orient:n,tickSizeInner:r=6,tickSizeOuter:a=6,tickPadding:s=3,size:l,start:o,style:c,transform:m}=e;const u=Math.max(r,0)+s,d=o,y=l,f="top"===n||"left"===n?-1:1,p="left"===n||"right"===n?Wt:Ut,h=t.ticks().map((e=>"number"==typeof e?{value:e,label:e.toLocaleString()}:e));return i.createElement("g",{transform:m},h.map((e=>i.createElement(p,{key:e.value,pos:t(e.value),name:e.label,spacing:u,tickSizeInner:r,orient:n,style:c}))),i.createElement("path",{className:`axisLine-${c.id}`,d:"left"===n||"right"===n?a?`M${f*a},${d}H0.5V${y}H${f*a}`:`M0.5,${d}V${y}`:a?`M${d},${f*a}V0.5H${y}V${f*a}`:`M${d},0.5H${y}`}))}const Qt=i.memo((function(e){let{width:t,text:n,dy:r,x:a,style:s,className:l}=e;const o=(0,i.useRef)(null),[c,m]=(0,i.useState)("string"==typeof n?[n]:[]);return(0,i.useLayoutEffect)((()=>{m("string"==typeof n?[n]:[])}),[n]),(0,i.useLayoutEffect)((()=>{if(!o.current||o.current.childElementCount>0||"string"!=typeof n||"function"!=typeof o.current.getComputedTextLength)return;const e=o.current.getComputedTextLength(),r=[];let a=t,s=0;const l=o.current.getStartPositionOfChar(0);for(;e>a;){l.x=a;const e=o.current.getCharNumAtPosition(l),i=n.lastIndexOf(" ",e);if(i<s)break;r.push(n.slice(s,i+1));s=i+1,a=o.current.getEndPositionOfChar(i+1).x+t}r.push(n.slice(s)),m(r)}),[o,n,t]),n?i.createElement("tspan",{ref:o,dy:r,style:s,x:a,className:l},c.length>1?c.map(((e,t)=>i.createElement("tspan",{key:e,x:0,dy:t>0?"1.2em":r},e))):n):null}));var Gt=i.memo((function(e){let{width:t,descriptionWidth:n=t,style:r}=e;return r.title||r.description?i.createElement("text",null,i.createElement(Qt,{text:r.title,width:t,dy:"10px",className:Lt(`titleTextStyle-${r.id}`,r.classNames.title),style:r.styles.title}),i.createElement(Qt,{x:0,width:n,dy:r.title?"2em":"10px",text:r.description,className:Lt(`descTextStyle-${r.id}`,r.classNames.description),style:r.styles.description})):null}));function Jt(){}function Zt(e){return e?(t,n)=>function(r){return e.call(this,t,r.nativeEvent,n.map((e=>e.createOnHandlerData?e.createOnHandlerData(t):null)))}:Jt}function Yt(e,t){let n=0,r=0;return a=>{let s=0;return"before"===a.position?(n+=a.size+t,s=-n):(s=e+r+t,r+=a.size+t),s}}function Xt(e,t,n){return void 0===n&&(n="fill"),t?e?Object.assign({[n]:t},e):t?{[n]:t}:void 0:e}const en=i.memo((function(e){let{size:t,style:n,data:r}=e;const a=Yt(t.sets.w+t.labels.w+t.cs.w,t.sets.addonPadding),s=Yt(t.cs.h+t.sets.h,t.cs.addonPadding),l="auto"===n.cs.offset?r.cs.labelOffset:n.cs.offset,o="auto"===n.sets.offset?r.sets.labelOffset:n.sets.offset;return i.createElement("g",null,i.createElement(Gt,{style:n,width:t.cs.x-l-20}),t.cs.h>0&&i.createElement("g",{transform:`translate(${t.cs.x},${t.cs.y})`,"data-upset":"csaxis"},i.createElement(Vt,{scale:r.cs.y,orient:"left",size:t.cs.h,start:t.cs.h-r.cs.yAxisWidth,style:n}),i.createElement("line",{x1:0,x2:t.cs.w,y1:t.cs.h+1,y2:t.cs.h+1,className:`axisLine-${n.id}`}),i.createElement("text",{className:Lt(`cChartTextStyle-${n.id}`,n.classNames.chartLabel),style:n.styles.chartLabel,transform:`translate(${-l}, ${t.cs.h/2})rotate(-90)`},n.cs.name),t.cs.addons.map((e=>{const t=s(e),r=i.createElement("text",{key:e.name,className:Lt(`cChartTextStyle-${n.id}`,n.classNames.chartLabel),style:n.styles.chartLabel,transform:`translate(${-l}, ${t+e.size/2})rotate(-90)`},e.name);return e.scale?i.createElement(i.Fragment,{key:e.name},i.createElement(Vt,{scale:e.scale,orient:"left",size:e.size,start:0,style:n,transform:`translate(0,${t})`}),r):r}))),t.sets.w>0&&i.createElement("g",{transform:`translate(${t.sets.x},${t.sets.y})`,"data-upset":"setaxis"},i.createElement(Vt,{scale:r.sets.x,orient:"bottom",size:t.sets.w,start:t.sets.w-r.sets.xAxisWidth,transform:`translate(0, ${t.sets.h})`,style:n}),i.createElement("text",{className:Lt(`sChartTextStyle-${n.id}`,n.classNames.chartLabel),style:n.styles.chartLabel,transform:`translate(${t.sets.w/2}, ${t.sets.h+o})`},n.sets.name),t.sets.addons.map((e=>{const r=a(e),s=i.createElement("text",{key:e.name,className:Lt(`sChartTextStyle-${n.id}`,n.classNames.chartLabel),style:n.styles.chartLabel,transform:`translate(${r+e.size/2}, ${t.sets.h+o})`},e.name);return e.scale?i.createElement(i.Fragment,{key:e.name},i.createElement(Vt,{scale:e.scale,orient:"bottom",size:e.size,start:0,transform:`translate(${r}, ${t.sets.h})`,style:n}),s):s}))))})),tn=i.memo((function(e){let{cx:t,r:n,cy:r,name:a,className:s,style:l,fill:o}=e;return i.createElement("circle",{r:n,cx:t,cy:r,className:s,style:Xt(l,o)},a&&i.createElement("title",null,a))}));function nn(e,t,n){const r=[n(e)];for(let a=0;a<Je.length&&e>t;a++)e-=t,r.push(n(e));return r}const rn=i.memo((function(e){let{d:t,h:n,className:r,data:a,size:s,style:l,children:o}=e;const c=nn(t.cardinality,a.cs.max,a.cs.y),m=Yt(s.cs.h+s.sets.h,s.cs.addonPadding);return i.createElement("g",{transform:`translate(${a.cs.x(t)}, 0)`,onMouseEnter:n.onMouseEnter(t,s.cs.addons),onMouseLeave:n.onMouseLeave,onClick:n.onClick(t,s.cs.addons),onContextMenu:n.onContextMenu(t,s.cs.addons),onMouseMove:n.onMouseMove(t,s.cs.addons),className:r,"data-cardinality":t.cardinality},l.tooltips&&i.createElement("title",null,t.name,": ",a.cs.format(t.cardinality)),i.createElement("rect",{y:-s.cs.before,width:a.cs.bandWidth,height:s.sets.h+s.cs.h+s.cs.before+s.cs.after,className:`hoverBar-${l.id}`}),s.cs.h>0&&i.createElement(i.Fragment,null,c.map(((e,n)=>{const r=n>0?Math.floor(a.cs.bandWidth*Je[n-1]):0;return i.createElement("rect",{key:n,x:r,y:e,height:s.cs.h-e,width:a.cs.bandWidth-2*r,className:Lt(`fillPrimary-${l.id}`,n<c.length-1&&`fillOverflow${c.length-1-n}-${l.id}`,l.classNames.bar),style:Xt(l.styles.bar,t.color)})})),i.createElement("text",{y:c[0]-l.barLabelOffset,x:a.cs.bandWidth/2,style:l.styles.barLabel,className:Lt(`cBarTextStyle-${l.id}`,l.classNames.barLabel)},a.cs.format(t.cardinality))),i.createElement("text",{y:-l.barLabelOffset-s.cs.before,x:a.cs.bandWidth/2,style:l.styles.barLabel,className:Lt(`hoverBarTextStyle-${l.id}`,l.classNames.barLabel)},t.name),a.sets.v.map(((e,n)=>a.cs.has(t,e)?null:i.createElement(tn,{key:a.sets.keys[n],r:a.r,cx:a.cs.cx,cy:a.sets.y(e)+a.sets.cy,name:l.tooltips?t.name:"",style:l.styles.dot,fill:void 0,className:Lt(`fillNotMember-${l.id}`,l.classNames.dot)}))),t.sets.size>1&&i.createElement("line",{x1:a.cs.cx,y1:a.sets.y(a.sets.v.find((e=>a.cs.has(t,e))))+a.sets.cy-(a.r-1),x2:a.cs.cx,y2:a.sets.y(a.sets.rv.find((e=>a.cs.has(t,e))))+a.sets.cy+(a.r-1),style:t.color?{stroke:t.color}:void 0,className:`upsetLine-${a.id}`}),a.sets.v.map(((e,n)=>{var r;return a.cs.has(t,e)?i.createElement(tn,{key:a.sets.keys[n],r:a.r,cx:a.cs.cx,cy:a.sets.y(e)+a.sets.cy,name:l.tooltips?e.name:"",style:l.styles.dot,fill:null!==(r=e.color)&&void 0!==r?r:t.color,className:Lt(`fillPrimary-${l.id}`,l.classNames.dot)}):null})),s.cs.addons.map((e=>i.createElement("g",{key:e.name,transform:`translate(0,${m(e)})`},e.render({set:t,width:a.cs.bandWidth,height:e.size,theme:l.theme})))),o)})),an=i.memo((function(e){let{d:t,i:n,h:r,className:a,size:s,data:l,style:o,children:c}=e;const m=nn(t.cardinality,l.sets.max,l.sets.x),u=Yt(s.sets.w+s.labels.w+s.cs.w,s.sets.addonPadding),d="center"===o.setLabelAlignment?s.labels.w/2:"left"===o.setLabelAlignment?2:s.labels.w-2;return i.createElement("g",{transform:`translate(0, ${l.sets.y(t)})`,onMouseEnter:r.onMouseEnter(t,s.sets.addons),onMouseLeave:r.onMouseLeave,onClick:r.onClick(t,s.sets.addons),onContextMenu:r.onContextMenu(t,s.sets.addons),onMouseMove:r.onMouseMove(t,s.sets.addons),className:a,"data-cardinality":t.cardinality},o.tooltips&&i.createElement("title",null,t.name,": ",l.sets.format(t.cardinality)),i.createElement("rect",{x:-s.sets.before,width:s.sets.w+s.labels.w+s.cs.w+s.sets.after,height:l.sets.bandWidth,className:`hoverBar-${o.id}`}),n%2==1&&i.createElement("rect",{x:s.sets.w,width:s.labels.w+s.cs.w+s.sets.after,height:l.sets.bandWidth,className:`fillAlternating-${o.id}`}),s.sets.w>0&&i.createElement(i.Fragment,null,m.map(((e,n)=>{const r=n>0?Math.floor(l.sets.bandWidth*Je[n-1]):0;return i.createElement("rect",{key:n,x:e,y:r,width:s.sets.w-e,height:l.sets.bandWidth-2*r,className:Lt(`fillPrimary-${o.id}`,n<m.length-1&&`fillOverflow${m.length-1-n}-${o.id}`,o.classNames.bar),style:Xt(o.styles.bar,t.color)})})),i.createElement("text",{x:m[0],dx:-o.barLabelOffset,y:l.sets.bandWidth/2,style:o.styles.barLabel,className:Lt(`sBarTextStyle-${o.id}`,o.classNames.barLabel)},l.sets.format(t.cardinality))),i.createElement("text",{x:s.sets.w+d,y:l.sets.bandWidth/2,className:Lt(`setTextStyle-${o.id}`,o.classNames.setLabel),style:o.styles.setLabel,clipPath:`url(#clip-${s.id})`},t.name),s.sets.addons.map((e=>i.createElement("g",{key:e.name,transform:`translate(${u(e)},0)`},e.render({set:t,width:e.size,height:l.sets.bandWidth,theme:o.theme})))),c)})),sn=i.memo((function(e){let{data:t,size:n,style:r,h:a,setChildrenFactory:s,combinationChildrenFactory:l}=e;return i.createElement("g",{className:a.hasClick?`clickAble-${r.id}`:void 0},i.createElement("g",{transform:`translate(${n.sets.x},${n.sets.y})`,"data-upset":"sets"},t.sets.v.map(((e,l)=>i.createElement(an,{key:t.sets.keys[l],d:e,i:l,h:a,className:a.hasClick||a.hasHover?`interactive-${r.id}`:void 0,data:t,style:r,size:n},s&&s(e))))),i.createElement("g",{transform:`translate(${n.cs.x},${n.cs.y})`,"data-upset":"cs"},t.cs.v.map(((e,s)=>i.createElement(rn,{key:t.cs.keys[s],d:e,h:a,className:a.hasClick||a.hasHover?`interactive-${r.id}`:void 0,data:t,style:r,size:n},l&&l(e))))))}));function ln(e){let{data:t,size:n,style:r,elemOverlap:a,secondary:s,tooltip:l,suffix:o,transform:c,empty:m,combinationAddons:u}=e;const d=t.cs.bandWidth,y=n.cs.h+n.sets.h,f=n.cs.h,p=Lt(`fill${o}`,!l&&`pnone-${r.id}`,r.classNames.bar);return i.createElement("g",{transform:c,"data-upset":s?"cs-q":"cs-s"},t.cs.v.map(((e,o)=>{const c=t.cs.x(e),h=t.cs.keys[o];if(m&&!s)return i.createElement("rect",{key:h,x:c,y:f,height:0,width:d,className:p,style:Xt(r.styles.bar,r.selectionColor?void 0:e.color)},l&&i.createElement("title",null));const g=a(e);if(0===g)return null;const x=nn(g,t.cs.max,t.cs.y),v=l&&i.createElement("title",null,`${e.name} \u2229 ${l}: ${g}`),b=s?i.createElement("path",{key:h,transform:`translate(${c}, ${x[0]})`,d:`M0,-1 l${d},0 l0,2 l${-d},0 L-${t.triangleSize},-${t.triangleSize} L-${t.triangleSize},${t.triangleSize} Z`,className:p,"data-i":o,"data-cardinality":g,style:Xt(void 0,r.selectionColor?void 0:e.color)},v):x.map(((n,a)=>{const s=a>0?Math.floor(t.cs.bandWidth*Je[a-1]):0;return i.createElement("rect",{key:a,x:c+s,y:n,height:f-n,width:d-2*s,"data-i":a>0?null:o,"data-cardinality":a>0?null:g,className:Lt(p,a<x.length-1&&`fillOverflow${x.length-1-a}-${r.id}`),style:Xt(r.styles.bar,r.selectionColor?void 0:e.color)},v)})),$=Yt(y,n.cs.addonPadding),w=u.map((t=>{const n=$(t),a=t.render({set:e,width:d,height:t.size,theme:r.theme});return a?i.createElement("g",{key:t.name,transform:`translate(${c},${n})`},a):null})).filter(Boolean);return 0===w.length?b:i.createElement("g",{key:h},b,w)})))}function on(e){let{data:t,size:n,style:r,elemOverlap:a,suffix:s,secondary:l,empty:o,tooltip:c,setAddons:m,transform:u}=e;const d=n.sets.w,y=n.sets.w+n.labels.w+n.cs.w,f=t.sets.bandWidth,p=Lt(`fill${s}`,!c&&` pnone-${r.id}`,r.classNames.bar);return i.createElement("g",{transform:u,"data-upset":l?"sets-q":"sets-s"},t.sets.v.map(((e,s)=>{const u=t.sets.y(e),h=t.sets.keys[s];if(o&&!l)return i.createElement("rect",{key:h,x:d,y:u,width:0,height:f,className:p,style:Xt(r.styles.bar,r.selectionColor?void 0:e.color)},r.tooltips&&c&&i.createElement("title",null));const g=a(e);if(0===g)return null;const x=nn(g,t.sets.max,t.sets.x),v=r.tooltips&&c&&i.createElement("title",null,`${e.name} \u2229 ${c}: ${g}`),b=l?i.createElement("path",{key:h,transform:`translate(${x[0]}, ${u+f})`,d:`M1,0 l0,${-f} l-2,0 l0,${f} L-${t.triangleSize},${t.triangleSize} L${t.triangleSize},${t.triangleSize} Z`,"data-i":s,"data-cardinality":g,className:p,style:Xt(void 0,r.selectionColor?void 0:e.color)},v):x.map(((n,a)=>{const l=a>0?Math.floor(t.sets.bandWidth*Je[a-1]):0;return i.createElement("rect",{key:a,"data-i":a>0?null:s,"data-cardinality":a>0?null:g,x:n,y:u+l,width:d-n,height:f-2*l,className:Lt(p,a<x.length-1&&`fillOverflow${x.length-1-a}-${r.id}`),style:Xt(r.styles.bar,r.selectionColor?void 0:e.color)},v)})),$=Yt(y,n.sets.addonPadding),w=m.map((t=>{const n=$(t),a=t.render({set:e,width:t.size,height:f,theme:r.theme});return a?i.createElement("g",{key:t.name,transform:`translate(${n},${u})`},a):null})).filter(Boolean);return 0===w.length?b:i.createElement("g",{key:h},b,w)})))}const cn=[],mn=i.memo((function(e){let{size:t,data:n,style:r,hasHover:a,secondary:s,queries:l}=e;const o=t.sets.addons.some((e=>null!=e.renderQuery))||t.cs.addons.some((e=>null!=e.renderQuery)),c=(0,i.useMemo)((()=>l.map((e=>Object.assign(Object.assign({},e),{overlap:x(e,"intersection",n.toElemKey),elemOverlap:o?v(e,"intersection",n.toElemKey):null})))),[l,o,n.toElemKey]);function m(e,t,n,r,a){return Object.assign(Object.assign({},e),{render:s=>{const l=r(s.set);return e.renderQuery?e.renderQuery(Object.assign({query:t,overlap:l,index:n,secondary:a},s)):null}})}return i.createElement("g",{className:a&&!s?`pnone-${r.id}`:void 0},i.createElement("g",{transform:`translate(${t.sets.x},${t.sets.y})`},c.map(((e,l)=>i.createElement(on,{key:e.name,data:n,size:t,style:r,elemOverlap:e.overlap,suffix:`Q${l}-${n.id}`,secondary:s||l>0,tooltip:a&&!(s||l>0)?void 0:e.name,setAddons:0===t.sets.addons.length?cn:t.sets.addons.map(((t,n)=>m(t,e,n,e.elemOverlap,s||n>0)))})))),i.createElement("g",{transform:`translate(${t.cs.x},${t.cs.y})`},c.map(((e,l)=>i.createElement(ln,{key:e.name,data:n,size:t,style:r,elemOverlap:e.overlap,suffix:`Q${l}-${n.id}`,secondary:s||l>0,tooltip:a&&!(s||l>0)?void 0:e.name,combinationAddons:0===t.cs.addons.length?cn:t.cs.addons.map(((t,n)=>m(t,e,n,e.elemOverlap,s||n>0)))})))))}));function un(e){let{data:t,size:n,style:r,selection:a}=e;if(!a||"set"!==a.type||!t.sets.keys.includes(t.toKey(a)))return null;const s=a;return i.createElement("rect",{y:t.sets.y(s),width:n.labels.w+n.cs.w+n.sets.after,height:t.sets.bandWidth,className:`selectionHint-${r.id}`})}function dn(e){let{data:t,size:n,style:r,selection:a}=e;const s=t.sets.bandWidth/2,l=t.cs.cx,o=t.r,c=n.sets.h+n.sets.after,m=t.cs.bandWidth;if(!a||"set"===a.type||!t.cs)return null;const u=a,d=t.cs.keys.indexOf(t.toKey(u));return d<0?null:i.createElement("g",{transform:`translate(${n.labels.w+t.cs.x(u)}, 0)`,"data-upset":"cs-ss","data-i":d},i.createElement("rect",{width:m,height:c,className:`selectionHint-${r.id}`}),u.sets.size>1&&i.createElement("line",{x1:l,y1:t.sets.y(t.sets.v.find((e=>t.cs.has(u,e))))+s-(t.r-1),x2:l,y2:t.sets.y(t.sets.rv.find((e=>t.cs.has(u,e))))+s+(t.r-1),className:`upsetSelectionLine-${t.id}`,style:Xt(void 0,r.selectionColor?void 0:u.color,"stroke")}),t.sets.v.filter((e=>t.cs.has(u,e))).map((e=>i.createElement(tn,{key:t.toKey(e),r:1.1*o,cx:l,cy:t.sets.y(e)+s,name:r.tooltips?e.name:"",className:Lt(`fillSelection-${r.id}`,`pnone-${r.id}`,r.classNames.dot),style:Xt(r.styles.dot,r.selectionColor?void 0:e.color)}))))}const yn=[];function fn(e){let{size:t,data:n,style:r,selection:a,hasHover:s}=e;const l=r.emptySelection,o=_t(a,n.overlapGuesser,n.toElemKey),c=Tt(a),m=t.sets.addons.some((e=>null!=e.renderSelection))||t.cs.addons.some((e=>null!=e.renderSelection)),u=a&&"function"!=typeof a&&m?function(e,t){const n=d(e,t);return e=>n(e.elems).intersection}(Array.isArray(a)?a:a.elems,n.toElemKey):null;function y(e){return Object.assign(Object.assign({},e),{render:t=>{const n=u?u(t.set):null;return e.renderSelection?e.renderSelection(Object.assign({selection:a,selectionColor:r.selectionColor||t.set.color||"orange",overlap:n},t)):null}})}return i.createElement("g",{className:s?`pnone-${r.id}`:void 0},(a||l)&&i.createElement(ln,{data:n,size:t,style:r,transform:`translate(${t.cs.x},${t.cs.y})`,empty:l&&!a,elemOverlap:o,suffix:`Selection-${r.id}`,tooltip:s?void 0:c,combinationAddons:0===t.cs.addons.length?yn:t.cs.addons.map(y)}),(a||l)&&i.createElement(on,{data:n,size:t,style:r,transform:`translate(${t.sets.x},${t.sets.y})`,empty:l&&!a,elemOverlap:o,suffix:`Selection-${r.id}`,tooltip:s?void 0:c,setAddons:0===t.sets.addons.length?yn:t.sets.addons.map(y)}),i.createElement("g",{transform:`translate(${t.labels.x},${t.labels.y})`},jt(a)&&i.createElement(un,{data:n,size:t,style:r,selection:a}),jt(a)&&i.createElement(dn,{data:n,size:t,style:r,selection:a})))}function pn(e,t){return void 0===t&&(t="font-size"),e?`${t}: ${e};`:""}function hn(e,t,n,r){const a=[];t.hasSelectionColor&&a.push(`fill: ${t.hasSelectionColor};`);const s=null!=t.hasSelectionOpacity&&t.hasSelectionOpacity>=0;return s&&a.push(`fill-opacity: ${t.hasSelectionOpacity};`),{p:pn,root:`\n  .root-${e} {\n    ${pn(n,"font-family")}\n  }\n  `,text:`\n  .titleTextStyle-${e} {\n    fill: ${t.textColor};\n    ${pn(r.title)}\n  }\n  .descTextStyle-${e} {\n    fill: ${t.textColor};\n    ${pn(r.description)}\n  }\n\n  .legendTextStyle-${e} {\n    fill: ${t.textColor};\n    ${pn(r.legend)}\n    text-anchor: middle;\n    dominant-baseline: hanging;\n    pointer-events: none;\n  }\n  `,hasSFill:a.join(" "),hasSStroke:a.join(" ").replace("fill:","stroke:").replace("fill-","stroke-"),fill:`\n  .fillPrimary-${e} { fill: ${t.color}; fill-opacity: ${t.opacity}; }\n  .fillOverflow1-${e} { fill-opacity: ${t.opacity*Ge[0]}; }\n  .fillOverflow2-${e} { fill-opacity: ${t.opacity*Ge[1]}; }\n  ${a.length>0?`.root-${e}[data-selection] .fillPrimary-${e} { ${a.join(" ")} }`:""}\n  ${s?`\n      .root-${e}[data-selection] .fillOverflow1-${e} { fill-opacity: ${t.opacity*Ge[0]}; }\n      .root-${e}[data-selection] .fillOverflow2-${e} { fill-opacity: ${t.opacity*Ge[1]}; }`:""}\n  ${t.selectionColor?`.fillSelection-${e} { fill: ${t.selectionColor}; }`:""}\n  .fillTransparent-${e} { fill: transparent; }\n\n  .selectionHint-${e} {\n    fill: transparent;\n    pointer-events: none;\n    ${pn(t.selectionColor,"stroke")}\n  }\n  .clickAble-${e} {\n    cursor: pointer;\n  }\n\n  .startText-${e} {\n    text-anchor: start;\n  }\n  .endText-${e} {\n    text-anchor: end;\n  }\n  .pnone-${e} {\n    pointer-events: none;\n  }`,export:`\n  .exportTextStyle-${e} {\n    fill: ${t.textColor};\n    ${pn(r.exportLabel)}\n  }\n  .exportButtons-${e} {\n    text-anchor: middle;\n  }\n  .exportButton-${e} {\n    cursor: pointer;\n    opacity: 0.5;\n  }\n  .exportButton-${e}:hover {\n    opacity: 1;\n  }\n  .exportButton-${e} > rect {\n    fill: none;\n    stroke: ${t.textColor};\n  }\n  `}}function gn(e){const t=e.onClick;return(0,i.useMemo)((()=>({hasClick:null!=t,hasHover:null!=e.onHover,onClick:Zt(t),onMouseEnter:Zt(e.onHover),onContextMenu:Zt(e.onContextMenu),onMouseLeave:e.onHover?t=>e.onHover(null,t.nativeEvent,[]):void 0,onMouseMove:Zt(e.onMouseMove),reset:e=>t?t(null,e.nativeEvent,[]):null})),[t,e.onHover,e.onContextMenu,e.onMouseMove])}const xn=i.forwardRef((function(e,t){var n;const r=pt(e),{selection:a=null,queries:s=[],fontSizes:l}=r,o=(0,i.useMemo)((()=>r.id?r.id:qt((r.fontFamily,l.axisTick,l.barLabel,l.chartLabel,l.legend,l.setLabel,l.title,l.exportLabel,l.description,r.textColor,r.hoverHintColor,r.color,r.hasSelectionColor,r.selectionColor,r.notMemberColor,r.alternatingBackgroundColor,r.opacity,r.hasSelectionOpacity))),[r.id,r.fontFamily,l.axisTick,l.barLabel,l.chartLabel,l.legend,l.setLabel,l.title,l.exportLabel,l.description,r.textColor,r.hoverHintColor,r.color,r.hasSelectionColor,r.selectionColor,r.notMemberColor,r.alternatingBackgroundColor,r.opacity,r.hasSelectionOpacity]),c=(0,i.useMemo)((()=>function(e,t,n,r,a,s,l,o,i,c,m,u,d,y,f){return{theme:e,styles:t,classNames:n,cs:{name:r,offset:a},sets:{name:s,offset:l},emptySelection:m,id:o,barLabelOffset:i,selectionColor:c,title:u,description:d,tooltips:y,setLabelAlignment:f}}(r.theme,r.styles,r.classNames,r.combinationName,r.combinationNameAxisOffset,r.setName,r.setNameAxisOffset,o,r.barLabelOffset,r.selectionColor,r.emptySelection,r.title,r.description,r.tooltips,r.setLabelAlignment)),[r.theme,r.styles,r.classNames,r.barLabelOffset,r.combinationName,r.combinationNameAxisOffset,r.setName,r.setNameAxisOffset,o,r.selectionColor,r.emptySelection,r.title,r.description,r.tooltips,r.setLabelAlignment]),m=(0,i.useMemo)((()=>function(e,t,n,r,a,s,l,o,i,c,m){const u=l.reduce(((e,t)=>e+("before"===t.position?t.size+c:0)),0),d=l.reduce(((e,t)=>e+("before"!==t.position?t.size+c:0)),0),y=o.reduce(((e,t)=>e+("before"===t.position?t.size+c:0)),0),f=o.reduce(((e,t)=>e+("before"!==t.position?t.size+c:0)),0),p=t-2*n-20-f-y,h=e-2*n-u-d,g=a[0]>1?a[0]:h*a[0],x=a[1]>1?a[1]:h*a[1],v=s[0]>1?s[0]:p*s[0];return{id:i||qt(),cs:{before:y,after:f,x:u+g+x,y:y,w:h-g-x,h:v,addons:o,addonPadding:m},labels:{x:u+g,y:y+v,w:x,h:p-v},sets:{before:u,after:d,x:u,y:y+v,w:g,h:p-v,addons:l,addonPadding:c},padding:r,legend:{x:e/2},margin:n,w:e,h:t}}(r.width,r.height,r.padding,r.barPadding,r.widthRatios,r.heightRatios,r.setAddons,r.combinationAddons,r.id,r.setAddonPadding,r.combinationAddonPadding)),[r.width,r.height,r.padding,r.barPadding,r.widthRatios,r.heightRatios,r.setAddons,r.combinationAddons,r.id,r.setAddonPadding,r.combinationAddonPadding]),u=(0,i.useMemo)((()=>function(e,t,n,r,a,s,l,o,i,c,m,u,d,y,f){var p;const h=Pt(r),g=Ht(a),x=Kt(t)?t:D(e,Object.assign({toElemKey:u},We,t)),v=g(x.map(m),n.cs.w,n.padding),b=x.reduce(((e,t)=>Math.max(e,t.cardinality)),0),$=null!=f?f:b,w=$>b?0:s,S=h($,[n.cs.h,w],{orientation:"vertical",fontSizeHint:i}),E=e=>Math.floor(s/1.4*.7*e.length),k=e=>E(S.tickFormat()(e)),C=e.reduce(((e,t)=>Math.max(e,t.cardinality)),0),M=null!=y?y:C,N=k(M);let O=k($);for(const _ of c){if(!_.scale)continue;const e=_.scale.ticks(3),t=_.scale.tickFormat();for(const n of e){const e="number"==typeof n?t(n):null!==(p=n.label)&&void 0!==p?p:t(n.value),r=E(e);r>O&&(O=r)}}const A=M>C?0:N,L=h(M,[n.sets.w,A],{orientation:"horizontal",fontSizeHint:i}),q=e.map(m),j=g(q.slice().reverse(),n.sets.h,n.padding),z=Math.min(j.bandwidth(),v.bandwidth())/2*l,I=Math.max(2,Math.min(j.bandwidth(),v.bandwidth())/2*o);return{id:d||qt(),r:z,triangleSize:I,sets:{v:e,keys:q,rv:e.slice().reverse(),x:L,xAxisWidth:n.sets.w-A,y:e=>j(m(e)),max:M,bandWidth:j.bandwidth(),cy:j.bandwidth()/2+n.cs.h,format:L.tickFormat(),labelOffset:s+9+2},cs:{v:x,keys:x.map(m),x:e=>v(m(e)),max:$,y:S,yAxisWidth:n.cs.h-w,cx:v.bandwidth()/2,bandWidth:v.bandwidth(),format:S.tickFormat(),has:(e,t)=>{const n=m(t);return Array.from(e.sets).some((e=>m(e)===n))},labelOffset:O+9+6},toKey:m,toElemKey:u,overlapGuesser:oe(x,It,m)}}(r.sets,r.combinations,m,r.numericScale,r.bandScale,r.barLabelOffset+Bt(l.barLabel),r.dotPadding,r.barPadding,Bt(l.axisTick),r.combinationAddons,r.toKey,r.toElemKey,r.id,r.setMaxScale,r.combinationMaxScale)),[r.sets,r.combinations,m,r.numericScale,r.bandScale,r.barLabelOffset,l.barLabel,r.dotPadding,r.barPadding,l.axisTick,r.combinationAddons,r.toKey,r.toElemKey,r.id,r.setMaxScale,r.combinationMaxScale]),d=hn(o,r,r.fontFamily,l),y=gn(r),f=`\n  ${d.root}\n  ${d.text}\n\n  .axisTextStyle-${o} {\n    fill: ${r.textColor};\n    ${d.p(l.axisTick)}\n    text-anchor: middle;\n  }\n  .barTextStyle-${o} {\n    fill: ${r.textColor};\n    ${d.p(l.barLabel)}\n  }\n  .cBarTextStyle-${o} {\n    fill: ${r.textColor};\n    ${d.p(l.barLabel)}\n    text-anchor: middle;\n  }\n  .sBarTextStyle-${o} {\n    fill: ${r.textColor};\n    ${d.p(l.barLabel)}\n    text-anchor: end;\n    dominant-baseline: central;\n  }\n  .hoverBarTextStyle-${o} {\n    ${d.p(l.barLabel)}\n    fill: ${r.hoverHintColor};\n    display: none;\n    text-anchor: middle;\n  }\n  .setTextStyle-${o} {\n    fill: ${r.textColor};\n    ${d.p(l.setLabel)}\n    text-anchor: ${function(e){var t;return null!==(t={left:"start",center:"middle",right:"end"}[e])&&void 0!==t?t:"middle"}(r.setLabelAlignment)};\n    dominant-baseline: central;\n  }\n  .cChartTextStyle-${o} {\n    fill: ${r.textColor};\n    ${d.p(l.chartLabel)}\n    text-anchor: middle;\n  }\n  .sChartTextStyle-${o} {\n    fill: ${r.textColor};\n    ${d.p(l.chartLabel)}\n    text-anchor: middle;\n    dominant-baseline: hanging;\n  }\n\n  ${d.fill}\n  .fillNotMember-${o} { fill: ${r.notMemberColor}; }\n  .fillAlternating-${o} { fill: ${r.alternatingBackgroundColor||"transparent"}; }\n\n  .axisLine-${o} {\n    fill: none;\n    stroke: ${r.textColor};\n  }\n  .hoverBar-${o} {\n    fill: transparent;\n  }\n\n  .interactive-${o}:hover > .hoverBar-${o} {\n    stroke: ${r.hoverHintColor};\n  }\n  .interactive-${o}:hover > .hoverBarTextStyle-${o} {\n    display: unset;\n  }\n\n  ${d.export}\n\n  .upsetLine-${u.id} {\n    stroke-width: ${.6*u.r};\n    stroke: ${r.color};\n    stroke-opacity: ${r.opacity};\n  }\n  ${d.hasSStroke?`.root-${o}[data-selection] .upsetLine-${u.id} { ${d.hasSStroke} }`:""}\n\n  .upsetSelectionLine-${u.id} {\n    stroke-width: ${.6*u.r*1.1};\n    ${d.p(r.selectionColor,"stroke")}\n    pointer-events: none;\n  }\n\n  ${s.map(((e,t)=>`.fillQ${t}-${u.id} {\n    fill: ${e.color};\n  }`)).join("\n")}\n  `,p=(0,i.useCallback)((t=>{const n=t.currentTarget.closest("svg"),r=t.currentTarget.dataset.type||"png";switch(r){case"vega":St(n);break;case"dump":Ot(n,e,u);break;case"share":At(e,u);break;case"svg":case"png":$t(n,{type:r,toRemove:`.${t.currentTarget.getAttribute("class")}`})}}),[u,e]),h=Tt(a);return i.createElement("svg",{id:r.id,className:Lt(`root-${o}`,r.className),style:r.style,width:r.width,height:r.height,ref:t,viewBox:`0 0 ${r.width} ${r.height}`,"data-theme":null!==(n=r.theme)&&void 0!==n?n:"light","data-selection":h||void 0},r.styleFactory(f),i.createElement("defs",null,i.createElement("clipPath",{id:`clip-${m.id}`},i.createElement("rect",{x:m.sets.w,y:0,width:m.labels.w,height:m.sets.h}))),r.queryLegend&&i.createElement(Dt,{queries:s,x:m.legend.x,style:c,data:u}),i.createElement(Rt,{transform:`translate(${m.w-2},${m.h-3})`,styleId:o,exportButtons:r.exportButtons,exportChart:p}),i.createElement("g",{transform:`translate(${r.padding},${r.padding})`,"data-upset":"base"},r.onClick&&i.createElement("rect",{width:m.cs.x,height:m.sets.y,onClick:y.reset,className:`fillTransparent-${o}`}),i.createElement(en,{size:m,style:c,data:u}),i.createElement(sn,{size:m,style:c,data:u,h:y,setChildrenFactory:r.setChildrenFactory,combinationChildrenFactory:r.combinationChildrenFactory}),i.createElement(fn,{size:m,style:c,data:u,hasHover:y.hasHover,selection:a}),i.createElement(mn,{size:m,style:c,data:u,hasHover:y.hasHover,queries:s,secondary:null!=r.onHover||null!=a})),e.children)}));function vn(e){let{rules:t,style:n,size:r,p:a,data:s,tRef:l,children:o,exportChart:c,selectionName:m,h:u}=e;var d,y;return i.createElement("svg",{id:a.id,className:Lt(`root-${n.id}`,a.className),style:a.style,width:a.width,height:a.height,ref:l,viewBox:`0 0 ${a.width} ${a.height}`,"data-theme":null!==(d=a.theme)&&void 0!==d?d:"light","data-selection":m||void 0},a.styleFactory(t),a.onClick&&i.createElement("rect",{width:r.w,height:r.h,onClick:u.reset,className:`fillTransparent-${n.id}`}),a.queryLegend&&i.createElement(Dt,{queries:null!==(y=a.queries)&&void 0!==y?y:[],x:r.legend.x,style:n,data:s}),i.createElement(Rt,{transform:`translate(${r.w-2},${r.h-3})`,styleId:n.id,exportButtons:a.exportButtons,exportChart:c}),i.createElement("g",{transform:`translate(${a.padding},${a.padding})`,"data-upset":"base"},o),a.children)}function bn(e){var t;if(e.v>=1||e.v<=0)return null;const n=Math.round(10*e.v)/100;return i.createElement("defs",null,i.createElement("pattern",{id:e.id,width:"1",height:"0.1",patternContentUnits:"objectBoundingBox",patternTransform:`rotate(${null!==(t=e.rotate)&&void 0!==t?t:0})`},e.bgFilled&&i.createElement("rect",{x:"0",y:"0",width:"1",height:"0.1",style:{fill:e.bgFill},className:`fillPrimary-${e.styleId}`}),i.createElement("rect",{x:"0",y:"0",width:"1",height:n,className:`fill${e.suffix}`,style:e.fill?{fill:e.fill}:void 0})))}function $n(e){let{slice:t,d:n,i:r,data:a,style:s,elemOverlap:l,selected:o,selectionName:c,h:m,queries:u,size:d,fill:y,qs:f}=e;const p=function(e,t,n){return void 0===n&&(n=0),e.path?e.path:`M ${e.x1-n},${e.y1-n} ${e.arcs.map((e=>{const r=t[e.ref].l,a=rt(r)?r.rx:r.r,s=rt(r)?r.ry:r.r,l=rt(r)?r.rotation:0;return`A ${a-n} ${s-n} ${l} ${e.large?1:0} ${e.sweep?1:0} ${e.x2-n} ${e.y2-n}`})).join(" ")}`}(t,a.sets.d),h=function(e,t){return e.text.x===t.cx?0:e.text.x>t.cx?e.text.y<=t.cy?60:-60:e.text.y<=t.cy?-60:60}(t,d.area),g=l?l(n):0,x=g===n.cardinality&&n.cardinality>0||o,v=Lt(`arc-${s.id}`,0===g&&!o&&`${y?"fillPrimary":"arcP"}-${s.id}`,x&&`fillSelection-${s.id}`,s.classNames.set),b=`upset-${s.id}-${r}`,$=null!=l||null!=m.onMouseLeave,w=f.map((e=>e(n))),{title:S,tooltip:E}=function(e,t,n,r,a,s,l,o){const c=l.format(e.cardinality),m=n?`${e.name} \u2229 ${n}`:e.name,u=n?`${l.format(t)}/${c}`:c;if(0===a.length)return{tooltip:`${m}: ${u}`,title:"set"===e.type?i.createElement(i.Fragment,null,i.createElement("tspan",{dy:"-0.6em"},e.name),i.createElement("tspan",{x:o,dy:"1.2em"},u)):u};if(1===a.length&&!r&&!n)return{tooltip:`${e.name} \u2229 ${s[0].name}: ${l.format(a[0])}/${c}`,title:"set"===e.type?i.createElement(i.Fragment,null,i.createElement("tspan",{dy:"-0.6em"},e.name),i.createElement("tspan",{x:o,dy:"1.2em"},`${l.format(a[0])}/${c}`)):`${l.format(a[0])}/${c}`};const d=i.createElement("tspan",{x:o,dy:"1.2em"},s.map(((e,t)=>i.createElement(i.Fragment,{key:e.name},i.createElement("tspan",{className:`fillQ${t}-${l.id}`},"\u2b24"),i.createElement("tspan",null,` ${l.format(a[t])}/${c}${t<s.length-1?" ":""}`)))));return{tooltip:`${m}: ${u}\n${s.map(((t,n)=>`${e.name} \u2229 ${t.name}: ${l.format(a[n])}/${c}`)).join("\n")}`,title:"set"===e.type?i.createElement(i.Fragment,null,i.createElement("tspan",{dy:"-1.2em"},e.name),i.createElement("tspan",{x:o,dy:"1.2em"},u),d):i.createElement(i.Fragment,null,i.createElement("tspan",{dy:"-0.6em"},u),d)}}(n,g,c,$,w,u,a,t.text.x);return i.createElement("g",null,i.createElement(bn,{id:b,v:0===g?0:g/n.cardinality,suffix:`Selection-${s.id}`,rotate:h,bgFill:n.color,bgFilled:null!=n.color||y,fill:s.selectionColor?void 0:n.color,styleId:s.id}),i.createElement("path",{onMouseEnter:m.onMouseEnter(n,[]),onMouseLeave:m.onMouseLeave,onClick:m.onClick(n,[]),onContextMenu:m.onContextMenu(n,[]),onMouseMove:m.onMouseMove(n,[]),d:p,className:v,style:Xt(s.styles.set,g>0&&g<n.cardinality?`url(#${b})`:x&&s.selectionColor?void 0:n.color)},s.tooltips&&i.createElement("title",null,E)),i.createElement("text",{x:t.text.x,y:t.text.y,className:Lt(`${"set"===n.type?"set":"value"}TextStyle-${s.id}`,`pnone-${s.id}`,"set"===n.type?s.classNames.setLabel:s.classNames.valueLabel)},S))}function wn(e,t,n,r,a,s,l,o,i){const c=e.length>r.maxSets?e.slice(0,r.maxSets):e,{cs:m,setKeys:u,csKeys:d}=function(e,t,n,r){void 0===r&&(r={min:1});const a=e.map(t);let s=[];if(Kt(n)){const a=new Map(n.map((e=>[Array.from(e.sets).map(t).sort().join("#"),e])));s=D(e.map((e=>({type:"set",cardinality:0,elems:[],name:e.name,s:e}))),Object.assign({type:"distinctIntersection",empty:!0,order:["degree:asc","group:asc"]},r)).map((e=>{const n=Array.from(e.sets).map((e=>t(e.s))).sort().join("#");return a.has(n)?a.get(n):{name:e.name,cardinality:0,degree:e.degree,elems:[],sets:new Set(Array.from(e.sets).map((e=>e.s))),type:"distinctIntersection"}}))}else s=D(e,Object.assign({type:"distinctIntersection",empty:!0,order:["degree:asc","group:asc"]},r,null!=n?n:{}));const l=s.map(t);return{cs:s,setKeys:a,csKeys:l}}(c,s,t),y=r.compute(c,m,n.area.w,n.area.h);return{id:o||qt(),sets:{d:y.sets.map(((e,t)=>({v:c[t],l:e,key:u[t],offset:null!=i&&t<i.length?i[t]:{x:0,y:0}}))),v:c,format:a},format:a,cs:{d:y.intersections.map(((e,t)=>({v:m[t],l:e,key:d[t]}))),v:m,has:(e,t)=>{const n=s(t);return Array.from(e.sets).some((e=>s(e)===n))}},toKey:s,toElemKey:l,overlapGuesser:ae(m,It,s)}}function Sn(e,t,n,r){const a=t-2*n,s=e-2*n,l=Math.min(s,a)/2;return{id:r||qt(),legend:{x:e/2},area:{w:s,h:a,cx:s/2,cy:a/2,r:l},margin:n,w:e,h:t}}function En(e,t,n){return(0,i.useCallback)((r=>{const a=r.currentTarget.closest("svg"),s=r.currentTarget.dataset.type||"png";switch(s){case"dump":Ot(a,t,e,n);break;case"share":At(t,e,n);break;case"svg":case"png":$t(a,{type:s,toRemove:`.${r.currentTarget.getAttribute("class")}`})}}),[e,t,n])}const kn=i.forwardRef((function(e,t){const n=gt(e),{selection:r=null,queries:a=[],fontSizes:s}=n,l=function(e){const{queries:t=[],fontSizes:n}=e,r=(0,i.useMemo)((()=>e.id?e.id:qt((e.fontFamily,n.valueLabel,n.legend,n.setLabel,n.title,n.exportLabel,n.description,e.textColor,e.color,e.hasSelectionColor,e.strokeColor,e.valueTextColor,e.selectionColor,e.opacity,e.hasSelectionOpacity))),[e.id,e.fontFamily,n.valueLabel,n.legend,n.setLabel,n.title,n.exportLabel,n.description,e.textColor,e.color,e.hasSelectionColor,e.strokeColor,e.valueTextColor,e.selectionColor,e.opacity,e.hasSelectionOpacity]),a=(0,i.useMemo)((()=>function(e,t,n,r,a,s,l,o){return{theme:e,styles:t,classNames:n,id:r,selectionColor:a,title:s,description:l,tooltips:o}}(e.theme,e.styles,e.classNames,r,e.selectionColor,e.title,e.description,e.tooltips)),[e.theme,e.styles,e.classNames,r,e.selectionColor,e.title,e.description,e.tooltips]),s=(0,i.useMemo)((()=>Sn(e.width,e.height,e.padding,e.id)),[e.width,e.height,e.padding,e.id]),l=gn(e),o=i.useMemo((()=>t.map((t=>x(t,"intersection",e.toElemKey)))),[t,e.toElemKey]),c=hn(r,e,e.fontFamily,n);return{styleId:r,size:s,style:a,h:l,qs:o,rulesHelper:c}}(n),{size:o,style:c,rulesHelper:m}=l,u=(0,i.useMemo)((()=>wn(n.sets,n.combinations,o,n.layout,n.valueFormat,n.toKey,n.toElemKey,n.id,n.setLabelOffsets)),[n.sets,n.combinations,o,n.valueFormat,n.toKey,n.toElemKey,n.id,n.layout,n.setLabelOffsets]),d=null!=r&&S(r)?n.toKey(r):null,y=null==r?null:_t(r,u.overlapGuesser,u.toElemKey),f=Tt(r),p=`\n  ${m.root}\n  ${m.text}\n\n  .valueTextStyle-${c.id} {\n    fill: ${n.valueTextColor};\n    ${m.p(s.valueLabel)}\n    text-anchor: middle;\n    dominant-baseline: central;\n  }\n  .setTextStyle-${c.id} {\n    fill: ${n.textColor};\n    ${m.p(s.setLabel)}\n    text-anchor: middle;\n  }\n\n  .topText-${c.id} {\n    dominant-baseline: hanging;\n  }\n\n  .stroke-circle-${c.id} {\n    fill: none;\n    stroke: ${n.strokeColor};\n  }\n\n  .arc-${c.id} {\n    fill-rule: evenodd;\n  }\n  .arcP-${c.id} {\n    fill: transparent;\n    fill-opacity: ${n.opacity};\n  }\n  ${m.fill}\n  ${m.export}\n\n  ${m.hasSFill?`.root-${c.id}[data-selection] .arcP-${c.id} { ${m.hasSFill} }`:""}\n\n  ${a.map(((e,t)=>`.fillQ${t}-${u.id} {\n    fill: ${e.color};\n  }`)).join("\n")}\n  `,h=En(u,n,"venn"),g=u.sets.d.reduce(((e,t)=>Math.min(e,t.l.cx-(rt(t.l)?t.l.rx:t.l.r))),o.area.w);return i.createElement(vn,{rules:p,style:c,selectionName:f,size:o,p:n,data:u,tRef:t,h:l.h,exportChart:h},i.createElement(Gt,{style:c,width:g}),i.createElement("g",{className:Lt(n.onClick&&`clickAble-${c.id}`)},u.sets.d.map(((e,t)=>i.createElement("text",{key:e.key,x:e.l.text.x+e.offset.x,y:e.l.text.y+e.offset.y,onClick:l.h.onClick(u.sets.v[t],[]),onMouseEnter:l.h.onMouseEnter(u.sets.v[t],[]),onMouseLeave:l.h.onMouseLeave,onContextMenu:l.h.onContextMenu(u.sets.v[t],[]),onMouseMove:l.h.onMouseMove(u.sets.v[t],[]),className:Lt(`setTextStyle-${c.id}`,`${e.l.align}Text-${c.id}`,`${e.l.verticalAlign}Text-${c.id}`,c.classNames.setLabel)},c.tooltips&&i.createElement("title",null,u.sets.v[t].name,": ",u.format(u.sets.v[t].cardinality)),u.sets.v[t].name)))),i.createElement("g",{className:Lt(n.onClick&&`clickAble-${c.id}`)},u.cs.d.map(((e,t)=>i.createElement($n,{key:e.key,d:e.v,i:t,slice:e.l,size:o,style:c,data:u,fill:n.filled,h:l.h,selectionName:f,selected:d===e.key||$(r)&&u.cs.has(e.v,r),elemOverlap:y,queries:a,qs:l.qs})))),i.createElement("g",null,u.sets.d.map((e=>rt(e.l)?i.createElement("ellipse",{key:e.key,rx:e.l.rx,ry:e.l.ry,transform:`translate(${e.l.cx},${e.l.cy})rotate(${e.l.rotation})`,className:Lt(`stroke-circle-${c.id}`,c.classNames.set),style:c.styles.set}):i.createElement("circle",{key:e.key,cx:e.l.cx,cy:e.l.cy,r:e.l.r,className:Lt(`stroke-circle-${c.id}`,c.classNames.set),style:c.styles.set})))))})),Cn=i.memo((function(e){let{d:t,i:n,h:r,className:a,data:s,style:l}=e;const o=s.cs.l[n],c=s.cs.scale(t.cardinality),m=(s.cell-s.cs.bandWidth)/2;return i.createElement("g",{transform:`translate(${o.x}, ${o.y})`,onMouseEnter:r.onMouseEnter(t,[]),onMouseLeave:r.onMouseLeave,onClick:r.onClick(t,[]),onContextMenu:r.onContextMenu(t,[]),onMouseMove:r.onMouseMove(t,[]),className:a,"data-cardinality":t.cardinality},l.tooltips&&i.createElement("title",null,t.name,": ",s.sets.format(t.cardinality)),i.createElement("rect",{width:s.cell,height:s.cell,className:`fillTransparent-${l.id}`}),i.createElement("rect",{x:m,y:c,height:s.cell-c,width:s.cs.bandWidth,className:Lt(`fillPrimary-${l.id}`,l.classNames.bar),style:Xt(l.styles.bar,t.color)}),i.createElement("text",{y:c-l.barLabelOffset,x:s.cell/2,style:l.styles.barLabel,className:Lt(`barTextStyle-${l.id}`,l.classNames.barLabel)},s.sets.format(t.cardinality)))}));function Mn(e,t,n,r){const a=e*t,s=e*n;return[r.x.map((t=>`M ${t*e},0 l0,${a}`)),r.y.map((t=>`M 0,${t*e} l${s},0`))].flat().join(" ")}const Nn=i.memo((function(e){let{data:t,style:n,size:r,h:a}=e;const s="auto"===n.cs.offset?t.cs.labelOffset:n.cs.offset;return i.createElement("g",null,i.createElement("g",{transform:`translate(${r.w-s-2}, ${r.h-t.cell-50})`},i.createElement(Vt,{scale:t.cs.scale,orient:"left",size:t.cell,start:t.cs.barLabelFontSize,style:n}),i.createElement("text",{className:Lt(`cChartTextStyle-${n.id}`,n.classNames.chartLabel),style:n.styles.chartLabel,transform:`translate(${-s}, ${t.cell})rotate(-90)`},n.cs.name)),i.createElement("g",null,t.sets.l.map(((e,r)=>{const s=t.sets.v[r],l=s.name;return i.createElement("g",{key:l,onClick:a.onClick(s,[]),onMouseEnter:a.onMouseEnter(s,[]),onMouseLeave:a.onMouseLeave,onContextMenu:a.onContextMenu(s,[]),onMouseMove:a.onMouseMove(s,[]),className:Lt(a.hasClick&&`clickAble-${n.id}`)},e.text.map(((t,r)=>i.createElement("text",{key:r,transform:`translate(${t.x},${t.y})${e.hor?"":"rotate(-90)"}`,className:Lt(`setTextStyle-${n.id}`)},l))))})),t.sets.l.map(((e,r)=>{const a=t.sets.v[r].name;return i.createElement(i.Fragment,{key:a},e.notText.map(((t,r)=>i.createElement("text",{key:r,transform:`translate(${t.x},${t.y})${e.hor?"":"rotate(-90)"}`,className:Lt(`setTextStyle-${n.id}`,`not-${n.id}`)},a))))}))),i.createElement("g",{className:Lt(a.hasClick&&`clickAble-${n.id}`)},t.cs.v.map(((e,r)=>i.createElement(Cn,{key:t.cs.keys[r],d:e,i:r,h:a,style:n,data:t})))),i.createElement("g",{transform:`translate(${t.grid.x}, ${t.grid.y})`},t.grid.levels.map(((e,r)=>i.createElement("path",{key:r,d:Mn(t.cell,t.grid.vCells,t.grid.hCells,e),className:`gridStyle-${n.id} gridStyle-${n.id}-${r}`})))))}));function On(e){let{data:t,style:n,elemOverlap:r,secondary:a,tooltip:s,suffix:l,empty:o}=e;const c=t.cs.bandWidth,m=(t.cell-c)/2,u=Lt(`fill${l}`,!s&&`pnone-${n.id}`,n.classNames.bar);return i.createElement("g",{"data-upset":a?"cs-q":"cs-s"},t.cs.v.map(((e,l)=>{const d=t.cs.l[l],y=t.cs.keys[l];if(o&&!a)return i.createElement("rect",{key:y,x:d.x+m,y:d.y+t.cell,height:0,width:c,className:u,style:Xt(n.styles.bar,n.selectionColor?void 0:e.color)},s&&i.createElement("title",null));const f=r(e);if(0===f)return null;const p=t.cs.scale(f),h=s&&i.createElement("title",null,`${e.name} \u2229 ${s}: ${f}`);return a?i.createElement("path",{key:y,transform:`translate(${d.x+m}, ${d.y+p})`,d:`M0,-1 l${c},0 l0,2 l${-c},0 L-${t.triangleSize},-${t.triangleSize} L-${t.triangleSize},${t.triangleSize} Z`,className:u,"data-i":l,"data-cardinality":f,style:Xt(void 0,n.selectionColor?void 0:e.color)},h):i.createElement("rect",{key:y,x:d.x+m,y:d.y+p,height:t.cell-p,"data-i":l,"data-cardinality":f,width:c,className:u,style:Xt(n.styles.bar,n.selectionColor?void 0:e.color)},h)})))}const An=i.memo((function(e){let{data:t,style:n,hasHover:r,secondary:a,queries:s}=e;const l=(0,i.useMemo)((()=>s.map((e=>Object.assign(Object.assign({},e),{overlap:x(e,"intersection",t.toElemKey)})))),[s,t.toElemKey]);return i.createElement("g",{className:r&&!a?`pnone-${n.id}`:void 0},l.map(((e,s)=>i.createElement(On,{key:e.name,data:t,style:n,elemOverlap:e.overlap,suffix:`Q${s}-${t.id}`,secondary:a||s>0,tooltip:r&&!(a||s>0)?void 0:e.name}))))}));function Ln(e){let{data:t,style:n,selection:r,hasHover:a}=e;const s=n.emptySelection,l=_t(r,t.overlapGuesser,t.toElemKey),o=Tt(r);return i.createElement("g",{className:a?`pnone-${n.id}`:void 0},(r||s)&&i.createElement(On,{data:t,style:n,empty:s&&!r,elemOverlap:l,suffix:`Selection-${n.id}`,tooltip:a?void 0:o}))}function qn(e,t){return Array(e).fill(0).map(((e,n)=>t(n)))}function jn(e){const t=Array(Math.pow(2,e)).fill(0);qn(e,(e=>{const n=Math.pow(2,e);for(let r=0;r<t.length;r+=n)t[r]++}));const n=qn(Math.max(e,1),(()=>[]));return t.forEach(((e,t)=>{const r=Math.max(0,e-1);n[r].push(t)})),n[n.length-1].push(t.length),n}function zn(e,t,n,r){const{xBefore:a,yBefore:s,cell:l,hCells:o,vCells:i,horizontalSets:c,verticalSets:m}=In(e.length,r),u=function(e,t){const{xOffset:n,yOffset:r,cell:a,xBefore:s,yBefore:l,hCells:o,vCells:i}=In(e,t),c=t.width-n,m=t.height-r;return qn(e,(e=>{const u=Math.floor(e/2),d=e%2==0,y=Math.pow(2,u),f=(d?o:i)/y/2,p=d?s:l,h=[{v:!0,x:p+f*a*.5},{v:!1,x:p+f*a*1.5}];for(let t=1;t<=u;t++){const e=f*Math.pow(2,t)*a,n=h.length-1;h.push(...h.map(((t,r)=>({v:h[n-r].v,x:t.x+e}))))}const g=u%2==1,x=Math.floor(u/2);let v=0;if(g){v=(d?m:c)-t.labelHeight*(.5+x)}else{v=(d?r:n)+t.labelHeight*(.5+x)}return d?{hor:!0,span:f,text:h.filter((e=>e.v)).map((e=>({x:e.x,y:v}))),notText:h.filter((e=>!e.v)).map((e=>({x:e.x,y:v})))}:{hor:!1,span:f,text:h.filter((e=>e.v)).map((e=>({x:v,y:e.x}))),notText:h.filter((e=>!e.v)).map((e=>({x:v,y:e.x})))}}))}(e.length,r),d=function(e,t,n,r){return e.map(((e,a)=>{const s=Math.floor(a/2),l=a%2==0,o=Math.pow(2,s),i=(l?t:n)/o/2;return(t,n)=>{let[a,s]=n;return r(t,e)?[a,s]:i>1?l?[i-1-a+i,s]:[a,i-1-s+i]:l?[a+i,s]:[a,s+i]}}))}(e,o,i,n),y=t.map((e=>{const[t,n]=d.reduceRight(((t,n)=>n(e,t)),[0,0]);return{x:a+t*l,y:s+n*l}})),f=jn(c),p=jn(m);return{s:u,c:y,cell:l,grid:{x:a,y:s,hCells:o,vCells:i,levels:f.map(((e,t)=>({x:e,y:t<p.length?p[t]:[]})))}}}function In(e,t){const n=Math.ceil(e/2),r=Math.floor(e/2),a=Math.pow(2,n),s=Math.pow(2,r),l=Math.floor(Math.min((t.width-t.labelHeight*r)/a,(t.height-t.labelHeight*n)/s)),o=(t.width-a*l-t.labelHeight*r)/2,i=(t.height-s*l-t.labelHeight*n)/2;return{xOffset:o,horizontalSets:n,yOffset:i,verticalSets:r,cell:l,xBefore:o+Math.ceil(r/2)*t.labelHeight,yBefore:i+Math.ceil(n/2)*t.labelHeight,hCells:a,vCells:s}}const _n=i.forwardRef((function(e,t){const n=vt(e),{queries:r=[],fontSizes:a,selection:s=null}=n,l=(0,i.useMemo)((()=>n.id?n.id:qt((n.fontFamily,a.axisTick,a.barLabel,a.legend,a.setLabel,a.title,a.exportLabel,a.description,n.textColor,n.color,n.hasSelectionColor,n.strokeColor,n.selectionColor,n.opacity,n.hasSelectionOpacity))),[n.id,n.fontFamily,a.axisTick,a.barLabel,a.legend,a.setLabel,a.title,a.exportLabel,a.description,n.textColor,n.color,n.hasSelectionColor,n.strokeColor,n.selectionColor,n.opacity,n.hasSelectionOpacity]),o=(0,i.useMemo)((()=>function(e,t,n,r,a,s,l,o,i,c,m,u){return{theme:e,styles:t,classNames:n,emptySelection:i,id:s,barLabelOffset:l,selectionColor:o,title:c,description:m,tooltips:u,cs:{name:r,offset:a}}}(n.theme,n.styles,n.classNames,n.combinationName,n.combinationNameAxisOffset,l,n.barLabelOffset,n.selectionColor,n.emptySelection,n.title,n.description,n.tooltips)),[n.theme,n.styles,n.classNames,n.combinationName,n.combinationNameAxisOffset,l,n.barLabelOffset,n.selectionColor,n.emptySelection,n.title,n.description,n.tooltips]),c=(0,i.useMemo)((()=>Sn(n.width,n.height,n.padding,n.id)),[n.width,n.height,n.padding,n.id]),m=(0,i.useMemo)((()=>function(e,t,n,r,a,s,l,o,i,c,m,u){const d=Pt(r),y=e.map(i),f=Kt(t)?t:D(e,Object.assign({type:"distinctIntersection"},null!=t?t:{})),p=f.map(i),h=(e,t)=>{const n=i(t);return Array.from(e.sets).some((e=>i(e)===n))},g=Math.ceil(1.2*l),x=zn(e,f,h,{width:n.area.w,height:n.area.h,labelHeight:g}),v=null!=u?u:f.reduce(((e,t)=>Math.max(e,t.cardinality)),0),b=d(v,[x.cell,a],{orientation:"vertical",fontSizeHint:o}),$=Math.round(x.cell*(1-s)),w=Math.min(Math.max(2,$/2*s),5),S=(E=v,Math.floor(a/1.4*.7*b.tickFormat()(E).length));var E;return{id:m||qt(),grid:x.grid,sets:{keys:y,l:x.s,v:e,labelHeight:g,format:b.tickFormat()},triangleSize:w,cell:x.cell,cs:{keys:p,l:x.c,v:f,barLabelFontSize:a,has:h,scale:b,bandWidth:$,labelOffset:S+9+6},toKey:i,toElemKey:c,overlapGuesser:oe(f,It,i)}}(n.sets,n.combinations,c,n.numericScale,n.barLabelOffset+Bt(a.barLabel),n.barPadding,Bt(a.setLabel),Bt(a.axisTick),n.toKey,n.toElemKey,n.id,n.combinationMaxScale)),[n.sets,n.combinations,c,n.numericScale,n.barLabelOffset,a.barLabel,n.barPadding,a.axisTick,a.setLabel,n.toKey,n.toElemKey,n.id,n.combinationMaxScale]),u=gn(n),d=Tt(s),y=hn(l,n,n.fontFamily,a),f=`\n  ${y.root}\n  ${y.text}\n\n  .axisTextStyle-${l} {\n    fill: ${n.textColor};\n    ${y.p(a.axisTick)}\n    text-anchor: end;\n  }\n  .barTextStyle-${l} {\n    fill: ${n.textColor};\n    ${y.p(a.barLabel)}\n    text-anchor: middle;\n  }\n  .setTextStyle-${o.id} {\n    fill: ${n.textColor};\n    ${y.p(a.setLabel)}\n    text-anchor: middle;\n    dominant-baseline: central;\n  }\n  .cChartTextStyle-${l} {\n    fill: ${n.textColor};\n    ${y.p(a.chartLabel)}\n  }\n\n  .not-${o.id} {\n    text-decoration: overline;\n  }\n\n  .axisLine-${l} {\n    fill: none;\n    stroke: ${n.textColor};\n  }\n\n  .gridStyle-${o.id} {\n    fill: none;\n    stroke: ${n.strokeColor};\n    stroke-linecap: round;\n  }\n  .gridStyle-${o.id}-1 {\n    stroke-width: 2;\n  }\n  .gridStyle-${o.id}-2 {\n    stroke-width: 3;\n  }\n\n  ${y.fill}\n  ${y.export}\n\n  ${r.map(((e,t)=>`.fillQ${t}-${m.id} {\n    fill: ${e.color};\n  }`)).join("\n")}\n  `,p=En(m,n,"kmap"),h=m.sets.l.reduce(((e,t)=>Math.min(e,t.text[0].x-m.sets.labelHeight)),c.area.w);return i.createElement(vn,{rules:f,style:o,size:c,p:n,data:m,tRef:t,selectionName:d,h:u,exportChart:p},i.createElement(Gt,{style:o,width:h}),i.createElement(Nn,{style:o,data:m,h:u,size:c}),i.createElement(Ln,{style:o,data:m,hasHover:u.hasHover,selection:s}),i.createElement(An,{style:o,data:m,hasHover:u.hasHover,queries:r,secondary:u.hasHover||null!=s}))})),Tn="#F4F4F4",Fn="#A6A8AB",Bn="#E1E2E3";function Pn(e){var t,n,r,a;const s=null!==(t=e.color)&&void 0!==t?t:Fn,l=null!==(n=e.secondaryColor)&&void 0!==n?n:Bn,o=Object.assign({},e),i=null!==(r=e.background)&&void 0!==r?r:Tn;return delete o.color,delete o.secondaryColor,delete o.background,i&&(o.style=Object.assign({background:i},null!==(a=o.style)&&void 0!==a?a:{})),{color:s,secondary:l,rest:o}}const Hn=i.memo(i.forwardRef((function(e,t){const{color:n,secondary:r,rest:a}=Pn(e),s=20,l=[10,20,35,60,65,80,90],o=[50,30,15];return i.createElement("svg",Object.assign({viewBox:"0 0 300 200",ref:t},a),l.map(((e,t)=>i.createElement("rect",{key:t,x:85+30*t,y:e,width:s,height:100-e,fill:n}))),o.map(((e,t)=>i.createElement("rect",{key:t,x:e,y:110+30*t,width:75-e,height:s,fill:n}))),l.map(((e,t)=>o.map(((e,a)=>{const s=a===2-t||3===t&&a>0||4===t&&1!==a||5===t&&a<2||6===t;return i.createElement("circle",{key:`${t}x${a}`,cx:85+30*t+10,cy:110+30*a+10,r:10,fill:s?n:r})})))),i.createElement("rect",{x:"182",y:"150",width:"6",height:"30",fill:n}),i.createElement("rect",{x:"212",y:"120",width:"6",height:"60",fill:n}),i.createElement("rect",{x:"242",y:"120",width:"6",height:"30",fill:n}),i.createElement("rect",{x:"272",y:"120",width:"6",height:"60",fill:n}))}))),Kn=i.memo(i.forwardRef((function(e,t){const{color:n,secondary:r,rest:a}=Pn(e),s=st(3,280,3180);return i.createElement("svg",Object.assign({viewBox:"0 0 300 200",ref:t},a),s.sets.map(((e,t)=>i.createElement("circle",{key:t,cx:e.cx,cy:e.cy+10,r:e.r,fill:r}))),s.sets.map(((e,t)=>i.createElement("circle",{key:t,cx:e.cx,cy:e.cy+10,r:e.r,stroke:n,fill:"none"}))))}))),Rn=i.memo(i.forwardRef((function(e,t){const{rest:n,color:r,secondary:a}=Pn(e),{xBefore:s,yBefore:l,cell:o,hCells:c,vCells:m}=In(2,{width:270,height:170,labelHeight:20}),u=c*o,d=m*o;return i.createElement("svg",Object.assign({viewBox:"0 0 300 200",ref:t,fontFamily:"sans-serif"},n),i.createElement("g",{transform:`translate(${s+10},${l+10})`},i.createElement("text",{x:.5*o,y:-3,fill:r,textAnchor:"middle"},"A"),i.createElement("text",{x:1.5*o,y:-3,fill:r,textAnchor:"middle",style:{textDecoration:"overline"}},"A"),i.createElement("text",{x:-3,y:.5*o,fill:r,textAnchor:"end",dominantBaseline:"central"},"B"),i.createElement("text",{x:-3,y:1.5*o,fill:r,textAnchor:"end",dominantBaseline:"central",style:{textDecoration:"overline"}},"B"),i.createElement("rect",{x:.1*o,y:o*(1-.9),height:.9*o,width:.8*o,fill:a}),i.createElement("rect",{x:1.1*o,y:.5*o,height:.5*o,width:.8*o,fill:a}),i.createElement("rect",{x:.1*o,y:1.74*o,height:.26*o,width:.8*o,fill:a}),i.createElement("rect",{x:1.1*o,y:1.25*o,height:.75*o,width:.8*o,fill:a}),i.createElement("path",{d:`M0,0 l${u},0 l0,${d} l${-u},0 l0,${-d} M${u/2},0 l0,${d} M0,${d/2} l${u},0`,fill:"none",stroke:r})))}))),Dn=1/180*Math.PI;function Wn(e,t,n,r){return{x:e+Math.cos(r*Dn)*n,y:t+Math.sin(r*Dn)*n}}function Un(e,t){return{maxSets:1/0,compute(n,r,a,s){const l=r.map((e=>({sets:Array.from(e.sets).map((e=>e.name)),size:e.cardinality}))),o=e(l,Object.assign({},{width:a,height:s,distinct:!0},null!=t?t:{})),i=o.filter((e=>1===e.data.sets.length)),c=new Map(n.map(((e,t)=>[e.name,t]))),m=i.map((e=>e.circles[0])),u=function(e){const t=e.reduce(((e,t)=>e+t.x),0),n=e.reduce(((e,t)=>e+t.y),0);return{x:t/e.length,y:n/e.length}}(m),d=e=>({x2:e.p1.x,y2:e.p1.y,cx:e.circle.x,cy:e.circle.y,sweep:!0,large:e.width>e.circle.radius,ref:m.findIndex((t=>Math.abs(t.x-e.circle.x)<.05&&Math.abs(t.y-e.circle.y)<.05)),mode:"i"});return{sets:i.map((e=>{const t=e.circles[0],n=function(e,t){const n=e.x-t.x,r=e.y-t.y;return Math.atan2(r,n)/Dn}(t,u);return{cx:t.x,cy:t.y,r:t.radius,align:n>90?"end":"start",verticalAlign:"bottom",text:Wn(t.x,t.y,1.1*t.radius,n)}})),intersections:o.map((e=>{const t=e.arcs,n={x:e.text.x,y:e.text.y};if(0===t.length)return{sets:e.data.sets.map((e=>c.get(e))),text:n,x1:0,y1:0,arcs:[]};if(1===t.length){const t=e.arcs[0].circle;return{sets:e.data.sets.map((e=>c.get(e))),text:n,x1:e.arcs[0].p2.x,y1:t.y-t.radius,arcs:[d(e.arcs[0]),Object.assign(d(e.arcs[0]),{y2:t.y-t.radius})],path:e.distinctPath||e.path}}return{sets:e.data.sets.map((e=>c.get(e))),text:n,x1:e.arcs[0].p2.x,y1:e.arcs[0].p2.y,arcs:e.arcs.map((e=>d(e))),path:e.distinctPath||e.path}}))}}}}var Vn=Object.freeze({__proto__:null,widthRatios:function(e){return null==e||Array.isArray(e)&&e.length>=2&&e.every((e=>"number"==typeof e))},heightRatios:function(e){return null==e||Array.isArray(e)&&e.length>=1&&e.every((e=>"number"==typeof e))},setLabelAlignment:function(e){return null==e||"left"===e||"center"===e||"right"===e},sets:function(e){return Array.isArray(e)&&e.every($)},combinations:function(e){return null==e||Array.isArray(e)&&e.every(w)||E(e)},selection:function(e){return null==e||Array.isArray(e)||S(e)},onHover:function(e){return null==e||"function"==typeof e},onClick:function(e){return null==e||"function"==typeof e},onContextMenu:function(e){return null==e||"function"==typeof e},onMouseMove:function(e){return null==e||"function"==typeof e},queries:function(e){return!e||Array.isArray(e)&&e.every(k)},stringOrFalse:function(e){return null==e||"string"==typeof e||!1===e},setLabelOffsets:function(e){return null==e||Array.isArray(e)&&e.every((e=>null))},theme:function(e){return null==e||"light"===e||"dark"===e||"vega"===e},classNames:function(e){return null==e||Object.keys(e).every((t=>Ve.includes(t)&&"string"==typeof e[t]))},fontSizes:function(e){return null==e||Object.keys(e).every((t=>Ue.includes(t)&&"string"==typeof e[t]))},numericScale:function(e){return null==e||"linear"===e||"log"===e||"function"==typeof e},bandScale:function(e){return null==e||"band"===e||"function"==typeof e},axisOffset:function(e){return null==e||"auto"===e||"number"==typeof e},style:function(e){return null==e||"object"==typeof e},styles:function(e){return null==e||Object.keys(e).every((e=>Ve.includes(e)))},exportButtons:function(e){return null==e||"boolean"==typeof e||Object.keys(e).every((t=>Qe.includes(t)&&"boolean"==typeof e[t]))}}),Qn=n(7713),Gn=n(4316),Jn=n(6507),Zn=n.n(Jn);function Yn(e){return Object.assign({theme:"light",title:"",description:""},ct(e.theme),e)}function Xn(e,t){if(h(e))return t=>e.overlap([t])>0;if(g(e)){const n=e.set.overlap;if(n)return e=>n([e])>0;if(t){const n=new Set(e.set.elems.map(t));return e=>n.has(e)}{const t=new Set(e.set.elems);return e=>t.has(e)}}if(p(e)){if(t){const n=new Set(Array.from(e.elems).map(t));return e=>n.has(e)}const n=new Set(e.elems);return e=>n.has(e)}return!1}function er(e,t){if(!e)return!1;if("function"==typeof e)return t=>e({type:"set",name:"S",cardinality:1,elems:[t]})>0;if(S(e)){const n=e.overlap;if(n)return e=>n([e])>0;if(t){const n=new Set(e.elems.map(t));return e=>n.has(e)}{const t=new Set(e.elems);return e=>t.has(e)}}if(Array.isArray(e)){if(t){const n=new Set(e.map(t));return e=>n.has(e)}const n=new Set(e);return e=>n.has(e)}return!1}function tr(e){return!1!==e&&(()=>e)}function nr(e,t){return void 0===t&&(t="k"),{test:`inSetStore(upset_signal, datum.${t})`,value:e}}function rr(e,t){return void 0===e&&(e="values"),void 0===t&&(t="k"),`countInSetStore(upset_signal, datum.${e}, '${t}')`}function ar(e,t,n){return void 0===t&&(t="values"),void 0===n&&(n="k"),`countInSetStore(upset_q${e}_signal, datum.${t}, '${n}')`}function sr(e,t){return void 0===t&&(t="k"),(null!=e?e:[]).map(((e,n)=>({test:`inSetStore(upset_q${n}_signal, datum.${t})`,value:e.color})))}function lr(e,t,n,r){void 0===r&&(r=!1);const a=(0,i.useRef)(null),s=(0,i.useRef)(n),l=(0,i.useCallback)((n=>(n.signals=n.signals||[],n.signals.push({name:"upset_signal",value:tr(er(s.current,e))}),(null!=t?t:[]).forEach(((t,r)=>n.signals.push({name:`upset_q${r}_signal`,value:tr(Xn(t,e))}))),n)),[s,t,e]);(0,i.useLayoutEffect)((()=>{s.current=null!=n?n:null,a.current&&(a.current.signal("upset_signal",er(n,e)),(null!=t?t:[]).forEach(((t,n)=>a.current.signal(`upset_q${n}_signal`,Xn(t,e)))),r&&!a.current._running&&a.current.resize().run())}),[a,n,t,r,e]);const o=(0,i.useCallback)((e=>{a.current=e}),[a]);return{viewRef:a,vegaProps:{patch:l,onNewView:o}}}function or(e,t,n){if(e.length!==t.length)return!1;if(n){const r=new Set(t.map(n));return e.every((e=>r.has(n(e))))}const r=new Set(t);return e.every((e=>r.has(e)))}function ir(e){return{name:"Vega Selection",type:"composite",cardinality:e.length,degree:0,elems:e,sets:new Set}}function cr(e,t){const n=t.signal(`${e}_tuple`);n&&Array.isArray(n.values)&&0!==n.values.length&&t.signal(`${e}_tuple`,null)}function mr(e,t,n,r,a,s){return(l,o)=>{if(!e.current)return;const i=o;if(!i||!i._vgsid_||0===i._vgsid_.length)return void r(null);const c=new Set(i._vgsid_),m=e.current.data(a).filter((e=>c.has(e._vgsid_))).map((e=>e[s]));if(0===m.length)return void r(null);if(t.current&&w(t.current)&&or(t.current.elems,m,n))return;const u=ir(m);r(u)}}function ur(e,t,n,r,a,s,l){let{paramName:o="select",transformedData:c="data_0",unitData:m="",elemField:u="e"}=void 0===l?{}:l;const d=(0,i.useRef)(r),y=(0,i.useMemo)((()=>{if(!a&&!s)return;const e={};return a&&(e[o]=mr(t,d,n,a,c,u)),s&&(e[`${o}_hover`]=mr(t,d,n,s,c,u)),e}),[a,s,t,d,o,c,u,n]);(0,i.useLayoutEffect)((()=>{d.current=null!=r?r:null,t.current&&a&&(w(r)?function(e,t,n,r,a,s){const l=t.signal(`${e}_tuple`),o=t.data(r),i=new Set(n.elems),c=o.filter((e=>i.has(e[s]))).map((e=>e._vgsid_));if(or(l?l.values:[],c))return;const m=l?Object.assign({},l,{values:c}):{unit:a,fields:t.signal(`${e}_tuple_fields`,c)};t.signal(`${e}_tuple`,m)}(o,t.current,r,c,m,u):null==r&&cr(o,t.current))}),[t,r,o,a,c,m,u]);const f=(0,i.useMemo)((()=>{const t=[];return a&&t.push({name:o,select:{type:"single"===e?"point":"interval"}}),s&&t.push({name:`${o}_hover`,select:{type:"point",on:"mouseover"}}),t}),[e,o,a,s]);return{signalListeners:y,hoverParamName:s?`${o}_hover`:null,paramName:a?o:null,params:f}}function dr(e){var t,n;const{title:r,description:a,selectionColor:s,color:l,theme:o}=Yn(e),{vAttr:c,iAttr:m,elems:u,width:d,height:y,orientation:f="vertical",actions:p,toElemKey:h}=e,g="horizontal"===f?"y":"x",x="horizontal"===f?"x":"y",v=(null!==(t=e.vLabel)&&void 0!==t?t:"function"==typeof c)?"v":c.toString(),b=(null!==(n=e.iLabel)&&void 0!==n?n:"function"==typeof m)?"i":m.toString(),$=(0,i.useMemo)((()=>{const e="function"==typeof c?c:e=>e[c],t="function"==typeof m?m:e=>e[m];return{table:u.map((n=>({e:n,v:e(n),i:t(n),k:h?h(n):n})))}}),[u,c,m,h]),{viewRef:w,vegaProps:S}=lr(h,e.queries,e.selection,!0),{signalListeners:E,params:k,paramName:C,hoverParamName:M}=ur("multi",w,h,e.selection,e.onClick,e.onHover),N=(0,i.useMemo)((()=>({title:r,description:a,data:{name:"table"},params:k,mark:{type:"bar",stroke:null,cursor:M?"pointer":void 0,tooltip:!0},encoding:{fill:{condition:[M&&{param:M,empty:!1,value:s},C&&{param:C,empty:!1,value:s},nr(s),...sr(e.queries)].filter(Boolean),value:l},[g]:{field:"i",type:"nominal",title:b,axis:{labelAngle:0}},[x]:{field:"v",type:"quantitative",title:v}}})),[b,v,r,a,s,l,e.queries,C,k,M,g,x]);return i.createElement(Qn.Z,Object.assign({spec:N,signalListeners:E,width:d,height:y,data:$,theme:"dark"===o?"dark":void 0,actions:p},S))}function yr(e,t,n){return null!=e&&S(e)&&"composite"===e.type&&"interval"===e.subType&&e.xAttr===t&&e.yAttr===n}function fr(e){return`[${Math.round(100*e[0])/100},${Math.round(100*e[1])/100}]`}function pr(e,t,n,r,a){return{name:`Vega Brush (${e}: ${fr(r)}, ${t}: ${fr(a)}`,type:"composite",subType:"interval",cardinality:n.length,degree:0,elems:n,sets:new Set,x:r,y:a,xAttr:e,yAttr:t}}function hr(e,t){return e===t||null!=e&&null!=t&&e[0]===t[0]&&e[1]===t[1]}function gr(e,t,n,r,a,s,l,o){let{paramName:c="select",transformedData:m="data_0",xField:u="x",yField:d="y",elemField:y="e"}=void 0===o?{}:o;const f=(0,i.useRef)(t),p=(0,i.useMemo)((()=>{if(!s&&!l)return;const t={};return s&&(t[c]=Zn()(((t,a)=>{if(!e.current)return;const l=a;if(null==l[u])return void s(null);if(f.current&&yr(f.current,n,r)&&(o=f.current,i=l[u],c=l[d],hr(o.x,i)&&hr(o.y,c)))return;var o,i,c;const m=e.current.data("table").filter((e=>e[u]>=l[u][0]&&e[u]<=l[u][1]&&e[d]>=l[d][0]&&e[d]<=l[d][1])).map((e=>e[y])),p=pr(n,r,m,l[u],l[d]);s(p)}),200)),l&&(t[`${c}_hover`]=mr(e,f,a,l,m,y)),t}),[c,s,l,a,e,n,r,f,m,u,d,y]);(0,i.useLayoutEffect)((()=>{f.current=null!=t?t:null,e.current&&s&&(yr(t,n,r)?function(e,t,n,r,a){const s=t.signal(`${e}_${r}`),l=t.signal(`${e}_${a}`);s&&Array.isArray(s)&&hr(s,n.x)||t.signal(`${e}_${r}`,n.x);const o=[n.y[1],n.y[0]];l&&Array.isArray(l)&&hr(l,o)||t.signal(`${e}_${a}`,o)}(c,e.current,t,u,d):t||function(e,t,n,r){const a=t.signal(`${e}_${n}`),s=t.signal(`${e}_${r}`);a&&t.signal(`${e}_${n}`,null),s&&t.signal(`${e}_${r}`,null)}(c,e.current,u,d))}),[c,e,t,n,r,s,u,d]);const h=(0,i.useMemo)((()=>{const e=[];return s&&e.push({name:c,select:{type:"interval"}}),l&&e.push({name:`${c}_hover`,select:{type:"point",on:"mouseover"}}),e}),[c,s,l]);return{signalListeners:p,hoverParamName:l?`${c}_hover`:null,paramName:s?c:null,params:h}}function xr(e,t){return null!=e&&S(e)&&"composite"===e.type&&"aggregate"===e.subType&&e.attr===t}function vr(e,t,n,r){return{name:null!=r?r:`Vega Group ${e}: ${n.join(", ")}`,type:"composite",subType:"aggregate",cardinality:t.length,degree:0,elems:t,sets:new Set,groups:n,attr:e}}function br(e,t,n,r,a,s){let{paramName:l="select",aggregatedData:o="data_0",unitData:c="layer_0",aggregateField:m="v",valuesField:u="values",elemField:d="e",nameGen:y}=void 0===s?{}:s;const f=(0,i.useRef)(t),p=(0,i.useMemo)((()=>{if(!r&&!a)return;const t={},s=t=>(r,a)=>{if(!e.current)return;const s=a;if(!s||!s._vgsid_||0===s._vgsid_.length)return void t(null);const l=new Set(s._vgsid_),i=e.current.data(o).filter((e=>l.has(e._vgsid_))),c=i.map((e=>e[m]));if(f.current&&xr(f.current,n)&&or(f.current.groups,c))return;const p=i.map((e=>e[u]||[])).flat().map((e=>e[d])),h=vr(n,p,c,y?y(i):void 0);t(h)};return r&&(t[l]=s(r)),a&&(t[`${l}_hover`]=s(a)),t}),[r,a,e,n,f,l,o,d,m,u,y]);(0,i.useLayoutEffect)((()=>{f.current=null!=t?t:null,e.current&&r&&(xr(t,n)?function(e,t,n,r,a,s){const l=t.signal(`${e}_tuple`),o=t.data(r).filter((e=>n.groups.includes(e[s]))).map((e=>e._vgsid_));if(or(l&&l.values?l.values:[],o))return;const i=l?Object.assign({},l,{values:o}):{unit:a,fields:t.signal(`${e}_tuple_fields`),values:o};t.signal(`${e}_tuple`,i)}(l,e.current,t,o,c,m):null==t&&cr(l,e.current))}),[e,t,n,l,r,o,c,m]);const h=(0,i.useMemo)((()=>{const e=[];return r&&e.push({name:l,select:{type:"point"}}),a&&e.push({name:`${l}_hover`,select:{type:"point",on:"mouseover"}}),e}),[l,r,a]);return{signalListeners:p,hoverParamName:a?`${l}_hover`:null,paramName:r?l:null,params:h}}function $r(e,t,n,r,a,s){let{paramName:l="select",aggregatedData:o="data_1",unitData:c="layer_0",valueField:m="v",valuesField:u="values",elemField:d="e"}=void 0===s?{}:s;const y=`bin_maxbins_10_${m}`,f=(0,i.useCallback)((e=>`Vega Bin ${n}: ${e.map((e=>`[${e[y]},${e[`${y}_end`]})`)).join(", ")}`),[y,n]);return br(e,t,n,r,a,{paramName:l,aggregatedData:o,unitData:c,valuesField:u,elemField:d,aggregateField:y,nameGen:f})}function wr(e){var t,n;const{title:r,description:a,selectionColor:s,color:l,theme:o}=Yn(e),{xAttr:c,yAttr:m,elems:u,width:d,height:y,actions:f,toElemKey:p}=e,h=(null!==(t=e.xLabel)&&void 0!==t?t:"function"==typeof c)?"x":c.toString(),g=(null!==(n=e.yLabel)&&void 0!==n?n:"function"==typeof m)?"y":m.toString(),x=(0,i.useMemo)((()=>{const e="function"==typeof c?c:e=>e[c],t="function"==typeof m?m:e=>e[m];return{table:u.map((n=>({e:n,x:e(n),y:t(n),k:p?p(n):n})))}}),[u,c,m,p]),{viewRef:v,vegaProps:b}=lr(p,e.queries,e.selection),{signalListeners:$,params:w,paramName:S,hoverParamName:E}=gr(v,e.selection,h,g,p,e.onClick,e.onHover),k=(0,i.useMemo)((()=>({title:r,description:a,data:{name:"table"},params:w,mark:{type:"point",stroke:null,cursor:E?"pointer":void 0,tooltip:!0},encoding:{fill:{condition:[E?[{param:E,empty:!1,value:s}]:[],S?[{param:S,empty:!1,value:s}]:[],nr(s),sr(e.queries)].flat(),value:l},x:{field:"x",type:"quantitative",title:h},y:{field:"y",type:"quantitative",title:g}}})),[h,g,r,a,s,l,e.queries,w,S,E]);return i.createElement(Qn.Z,Object.assign({spec:k,signalListeners:$,width:d,height:y,data:x,theme:"dark"===o?"dark":void 0,actions:f},b))}function Sr(e,t){return{transform:[{aggregate:[{op:"values",as:"values"}],groupby:["bin_maxbins_10_v","bin_maxbins_10_v_end"]}],mark:{type:"bar",tooltip:!1},encoding:{color:{value:t},x:{bin:!0,field:"v",type:"quantitative"},y:{datum:{signal:e},type:"quantitative",title:null},y2:{type:"quantitative",datum:0,title:null}}}}function Er(e){var t;const{title:n,description:r,selectionColor:a,color:s,theme:l}=Yn(e),{attr:o,elems:c,width:m,height:u,actions:d,toElemKey:y}=e,f=(null!==(t=e.label)&&void 0!==t?t:"function"==typeof o)?"v":o.toString(),p=(0,i.useMemo)((()=>{const e="function"==typeof o?o:e=>e[o];return{table:c.map((t=>({e:t,i:1,v:e(t),k:y?y(t):t})))}}),[c,o,y]),{viewRef:h,vegaProps:g}=lr(y,e.queries,e.selection,!0),{params:x,signalListeners:v,paramName:b,hoverParamName:$}=$r(h,e.selection,f,e.onClick,e.onHover),w=(0,i.useMemo)((()=>{var t;return{title:n,description:r,data:{name:"table"},layer:[{params:x,mark:{type:"bar",cursor:b||$?"pointer":void 0,tooltip:!0},encoding:{color:{condition:[$?{param:$,empty:!1,value:a}:[],b?{param:b,empty:!1,value:a}:[]].flat(),value:s},x:{bin:!0,field:"v",type:"quantitative",title:f},y:{aggregate:"sum",field:"i",type:"quantitative",title:"Count"}}},Sr(rr(),a),...(null!==(t=e.queries)&&void 0!==t?t:[]).map(((e,t)=>t>0||null!=b||null!=$?function(e,t){return{transform:[{aggregate:[{op:"values",as:"values"}],groupby:["bin_maxbins_10_v","bin_maxbins_10_v_end"]}],mark:{type:"point",shape:"triangle-right",tooltip:!1},encoding:{color:{value:t},x:{bin:!0,band:0,field:"v",type:"quantitative"},y:{datum:{signal:e},type:"quantitative"}}}}(ar(t),e.color):Sr(ar(t),e.color)))],resolve:{scale:{y:"shared"}}}}),[f,n,r,a,s,e.queries,x,b,$]);return i.createElement(Qn.Z,Object.assign({spec:w,width:m,height:u,data:p,signalListeners:v,theme:"dark"===l?"dark":void 0,actions:d},g))}function kr(e,t,n,r,a){return{mark:{type:"arc",tooltip:!1,innerRadius:a},encoding:Object.assign({theta:{field:"i_sum_start",type:"quantitative",title:null},theta2:{datum:{signal:`datum.i_sum_start + ${e}`},type:"quantitative",title:null}},n?{stroke:{value:t},color:{value:t},fillOpacity:{value:.3}}:{color:{value:t},stroke:{field:"v",type:"nominal",title:null,legend:null,scale:{scheme:"dark"===r?"dark2":"set2"}}})}}function Cr(e){var t;const{title:n,description:r,selectionColor:a,theme:s}=Yn(e),{attr:l,elems:o,width:c,height:m,innerRadius:u,actions:d,toElemKey:y}=e,f=(null!==(t=e.label)&&void 0!==t?t:"function"==typeof l)?"v":l.toString(),p=(0,i.useMemo)((()=>{const e="function"==typeof l?l:e=>e[l];return{table:o.map((t=>({e:t,i:1,v:e(t),k:y?y(t):t})))}}),[o,l,y]),{viewRef:h,vegaProps:g}=lr(y,e.queries,e.selection,!0),{params:x,signalListeners:v,paramName:b,hoverParamName:$}=br(h,e.selection,f,e.onClick,e.onHover),w=(0,i.useMemo)((()=>{var t;return{title:n,description:r,data:{name:"table"},transform:[{aggregate:[{op:"values",as:"values"},{op:"sum",field:"i",as:"i_sum"}],groupby:["v"]},{stack:"i_sum",as:["i_sum_start","i_sum_end"],sort:[{field:"v",order:"ascending"}],groupby:[]}],layer:[{params:x,mark:{type:"arc",cursor:b||$?"pointer":void 0,tooltip:!0,innerRadius:u},encoding:{color:{condition:[$?[{param:$,empty:!1,value:a}]:[],b?[{param:b,empty:!1,value:a}]:[]].flat(),field:"v",type:"nominal",title:f,scale:{scheme:"dark"===s?"dark2":"set2"}},theta:{field:"i_sum",type:"quantitative",title:"Count"}}},kr(rr(),a,!1,s,u),...(null!==(t=e.queries)&&void 0!==t?t:[]).map(((e,t)=>kr(ar(t),e.color,t>0||null!=$||null!=b,s,u)))],resolve:{scale:{theta:"shared"}}}}),[f,n,r,a,e.queries,x,b,$,u,s]);return i.createElement(Qn.Z,Object.assign({spec:w,width:c,height:m,data:p,signalListeners:v,theme:"dark"===s?"dark":void 0,actions:d},g))}(0,Gn.expressionFunction)("inSetStore",(function(e,t){return"function"==typeof e&&e(t)})),(0,Gn.expressionFunction)("countInSetStore",(function(e,t,n){return"function"==typeof e&&Array.isArray(t)?t.reduce(((t,r)=>t+(e(r[n])?1:0)),0):0}));var Mr=n(2210);const Nr={hinges:Mr.HV,fivenum:Mr.Jc,type7:Mr.Du,quantiles:Mr.Du,linear:Mr.sZ,lower:Mr.E5,higher:Mr.kE,nearest:Mr.HT,midpoint:Mr.X_};function Or(e,t){void 0===t&&(t={});const n=Object.assign({},t,{quantiles:"function"==typeof t.quantiles||null==t.quantiles?t.quantiles:Nr[t.quantiles]});return null==n.quantiles&&delete n.quantiles,(0,Mr.ZP)(e,n)}function Ar(e){const t=e[1]-e[0];return n=>n*t+e[0]}function Lr(e){const t=e[1]-e[0];return n=>(n-e[0])/t}function qr(e,t){const n=new Map(e.map((e=>[e.value,0])));return t.forEach((e=>{if(null==e)return;const t=e.toString();n.has(t)&&n.set(t,n.get(t)+1)})),n}function jr(e,t,n,r){void 0===r&&(r=!1);const a=function(e){const t=["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d"],n=["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494"],r=e?t.concat(n):n.concat(t);let a=0;return()=>r[a++%r.length]}(r),s=t.map((e=>{return Object.assign({count:0,acc:0,percentage:0},{value:t="string"==typeof e?e:e.value,label:t.length>0?`${t[0].toUpperCase()}${t.slice(1)}`:t,color:a()},"string"==typeof e?{}:e);var t})),l=qr(s,e),o=n?qr(s,n):null,i=Array.from(l.values()).reduce(((e,t)=>e+t),0);let c=0;return s.forEach((e=>{e.acc=c,e.count=l.get(e.value),e.percentage=e.count/i,c+=o?o.get(e.value):e.count})),s}function zr(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}function Ir(e){return Math.round(100*e)/100}function _r(e,t,n){void 0===n&&(n="horizontal");const r=Lr(e),a=Ar(e),s=Ar(t),l=e=>s(r(e)),o="horizontal"===n?5:7;return l.ticks=function(e){return void 0===e&&(e=o),Array(e).fill(0).map(((t,n)=>{const r=a(n/(e-1));return{value:r,label:r.toLocaleString(void 0,{maximumFractionDigits:2})}}))},l.tickFormat=()=>e=>e.toFixed(2),l}const Tr=e=>e.toFixed(2);function Fr(e,t){return`Min: ${t(e.min)}, 25% Quantile: ${t(e.q1)}, Median: ${t(e.median)}, 75% Quantile: ${t(e.q3)}, Max: ${t(e.max)}`}const Br=e=>{const{theme:t="light",mode:n="normal",boxStyle:r,lineStyle:a,outlierStyle:s,margin:l=0,boxPadding:o=.1,outlierRadius:c=3,numberFormat:m=Tr}=e,u=zr(e,["theme","mode","boxStyle","lineStyle","outlierStyle","margin","boxPadding","outlierRadius","numberFormat"]),d=Array.isArray(e.values)?Or(e.values,u):e.values;if(Number.isNaN(d.median))return i.createElement("g",null);const y="vertical"!==e.orient,f=Lr([e.min,e.max]),p=Ar([0,y?e.width:e.height]),h=e=>Ir(p(f(e))),g={max:h(d.max),avg:h(d.mean),med:h(d.median),min:h(d.min),q1:h(d.q1),q3:h(d.q3),wh:h(d.whiskerHigh),wl:h(d.whiskerLow)},x=!1!==e.tooltips&&i.createElement("title",null,Fr(d,m)),v=ct(t).notMemberColor,b={box:Object.assign({fill:v},r),line:Object.assign({fill:"none",stroke:"light"===t?"black":"#cccccc"},a),outlier:Object.assign({fill:v},s)};if(y){const t=e.height/2,r=Ir(e.height*o)+l,a=e.height-r,s=`M${g.wl},${l} l0,${e.height-2*l} M${g.wl},${t} L${g.q1},${t}`,u=`M${g.q3},${t} L${g.wh},${t} M${g.wh},${l} L${g.wh},${e.height-l}`,y=`M${g.q1},${r} L${g.q3},${r} L${g.q3},${a} L${g.q1},${a} L${g.q1},${r} M${g.med},${r} l0,${a-r}`,f=i.createElement("path",{d:`${s} ${u} ${y}`,style:b.line});return"indicator"===n?f:i.createElement("g",null,x,"normal"===n&&i.createElement("rect",{x:g.q1,y:r,width:g.q3-g.q1,height:e.height-2*r,style:b.box}),f,d.outlier.map((e=>i.createElement("circle",{key:e,r:c,cy:t,cx:h(e),style:b.outlier},i.createElement("title",null,"$",m(e))))))}{const t=e.width/2,r=Ir(e.width*o)+l,a=e.width-r,s=`M${l},${g.wl} l${e.width-2*l},0 M${t},${g.wl} L${t},${g.q1}`,u=`M${t},${g.q3} L${t},${g.wh} M${l},${g.wh} L${e.width-l},${g.wh}`,y=`M${r},${g.q1} L${r},${g.q3} l${a-r},0 L${a},${g.q1} L${r},${g.q1} M${r},${g.med} l${a-r},0`,f=i.createElement("path",{d:`${s} ${u} ${y}`,style:b.line});return"indicator"===n?f:i.createElement("g",null,x,"normal"===n&&i.createElement("rect",{y:g.q1,x:r,height:g.q3-g.q1,width:e.width-2*r,style:b.box}),f,d.outlier.map((e=>i.createElement("circle",{key:e,r:c,cx:t,cy:h(e),style:b.outlier},i.createElement("title",null,"$",m(e))))))}},Pr=i.memo(Br);function Hr(e,t,n){void 0===n&&(n={});var{size:r=100,position:a,name:s=e.toString()}=n,l=zr(n,["size","position","name"]);const o="function"==typeof e?e:t=>t[e];let c=Number.POSITIVE_INFINITY,m=Number.NEGATIVE_INFINITY;if(Array.isArray(t))t.forEach((e=>{const t=o(e);null==t||Number.isNaN(t)||(t<c&&(c=t),t>m&&(m=t))}));else{const e=t;c=e.min,m=e.max}const u=_r([c,m],[0,r],l.orient);return{name:s,position:a,size:r,scale:u,createOnHandlerData:e=>{const t=Or(e.elems.map(o),l);return{id:"boxplot",name:s,value:Object.assign(Object.assign(Object.assign({},t),{toString(){var e;return Fr(this,null!==(e=l.numberFormat)&&void 0!==e?e:Tr)}}),t)}},render:e=>{let{width:t,height:n,set:r,theme:a}=e;const s=r.elems.map(o);return i.createElement(Pr,Object.assign({values:s,width:t,height:n,min:c,max:m,theme:a},l))},renderSelection:e=>{let{width:t,height:n,overlap:r,selectionColor:a,theme:s}=e;if(null==r||0===r.length)return null;const u=r.map(o);return i.createElement(Pr,Object.assign({values:u,width:t,height:n,min:c,max:m,mode:"box",lineStyle:{stroke:a,strokeWidth:2},outlierStyle:{fill:a},theme:s},l))},renderQuery:e=>{let{width:t,height:n,overlap:r,query:a,secondary:s,index:u,theme:d}=e;if(null==r||0===r.length)return null;const y=r.map(o);return i.createElement(Pr,Object.assign({values:y,width:t,height:n,min:c,max:m,mode:s?"indicator":"box",margin:s?u+2:0,lineStyle:{stroke:a.color,strokeWidth:s?1:2},outlierStyle:{fill:a.color},theme:d},l))}}}function Kr(e,t,n){void 0===n&&(n={});var{size:r=100,position:a,name:s="BoxPlot"}=n,l=zr(n,["size","position","name"]);const o=t.min,c=t.max,m=_r([o,c],[0,r],l.orient);return{name:s,position:a,size:r,scale:m,createOnHandlerData:t=>{const n=e(t.elems);return n.toString=function(){var e;return Fr(this,null!==(e=l.numberFormat)&&void 0!==e?e:Tr)},{id:"boxplot",name:s,value:n}},render:t=>{let{width:n,height:r,set:a,theme:s}=t;const m=e(a.elems);return i.createElement(Pr,Object.assign({values:m,width:n,height:r,min:o,max:c,theme:s},l))},renderSelection:t=>{let{width:n,height:r,overlap:a,selectionColor:s,theme:m}=t;if(null==a||0===a.length)return null;const u=e(a);return i.createElement(Pr,Object.assign({values:u,width:n,height:r,min:o,max:c,mode:"box",lineStyle:{stroke:s,strokeWidth:2},outlierStyle:{fill:s},theme:m},l))},renderQuery:t=>{let{width:n,height:r,overlap:a,query:s,secondary:m,index:u,theme:d}=t;if(null==a||0===a.length)return null;const y=e(a);return i.createElement(Pr,Object.assign({values:y,width:n,height:r,min:o,max:c,mode:m?"indicator":"box",margin:m?u+2:0,lineStyle:{stroke:s.color,strokeWidth:m?1:2},outlierStyle:{fill:s.color},theme:d},l))}}}function Rr(e){return Array.isArray(e.bins)}function Dr(e){return e.map((e=>`${e.label}: ${e.count}`)).join(", ")}const Wr=e=>{var t,n;const{margin:r=0,rectStyle:a={}}=e,s=Rr(e)?e.bins:jr(e.values,e.categories,e.base,"dark"===e.theme),l=Lr([0,Rr(e)?e.bins.reduce(((e,t)=>e+t.count),0):null!==(n=null===(t=e.base)||void 0===t?void 0:t.length)&&void 0!==n?n:e.values.length]),o="vertical"!==e.orient,c=Ar([0,o?e.width:e.height]),m=e=>c(l(e));return o?i.createElement("g",null,s.map((t=>i.createElement("rect",{key:t.value,x:m(t.acc),width:m(t.count),y:r,height:e.height-2*r,style:Object.assign({fill:t.color},a)},!1!==e.tooltips&&i.createElement("title",null,`${t.label}: ${t.count}`))))):i.createElement("g",null,s.map((t=>i.createElement("rect",{key:t.value,y:m(t.acc),height:m(t.count),x:r,width:e.width-2*r,style:Object.assign({fill:t.color},a)},!1!==e.tooltips&&i.createElement("title",null,`${t.label}: ${t.count}`)))))},Ur=i.memo(Wr),Vr="rgba(255,255,255,0.2)",Qr="rgba(0,0,0,0.1)";function Gr(e,t,n){void 0===n&&(n={});var{size:r=100,position:a,name:s=e.toString()}=n,l=zr(n,["size","position","name"]);const o="function"==typeof e?e:t=>t[e];let c=[];if(Array.isArray(t)){const e=new Set;t.forEach((t=>{const n=o(t);null!=n&&e.add(n.toString())})),c=Array.from(e).sort()}else c=t.categories;return{name:s,position:a,size:r,createOnHandlerData:e=>{const t=jr(e.elems.map(o),c,void 0,"dark"===l.theme);return t.toString=function(){return Dr(this)},{id:"categorical",name:s,value:t}},render:e=>{let{width:t,height:n,set:r,theme:a}=e;const s=r.elems.map(o);return i.createElement(Ur,Object.assign({values:s,categories:c,width:t,height:n,theme:a},l))},renderSelection:e=>{let{width:t,height:n,set:r,theme:a,overlap:s,selectionColor:m}=e;if(null==s||0===s.length)return null;const u=r.elems.map(o),d=s.map(o);return i.createElement(Ur,Object.assign({values:d,base:u,categories:c,width:t,height:n,theme:a,rectStyle:{stroke:m,strokeWidth:2,fill:"light"===a?Qr:Vr}},l))},renderQuery:e=>{let{width:t,height:n,overlap:r,set:a,query:s,secondary:m,index:u,theme:d}=e;if(null==r||0===r.length)return null;const y=a.elems.map(o),f=r.map(o);return i.createElement(Ur,Object.assign({values:f,base:y,categories:c,width:t,height:n,margin:m?u+2:0,rectStyle:{stroke:s.color,fill:"light"===d?Qr:Vr},theme:d},l))}}}function Jr(e,t){void 0===t&&(t={});var{size:n=100,position:r,name:a="Histogram"}=t,s=zr(t,["size","position","name"]);return{name:a,position:r,size:n,createOnHandlerData:t=>{const n=e(t.elems);return{id:"categorical",name:a,value:Object.assign(Object.assign(Object.assign({},n),{toString(){return Dr(this)}}),n)}},render:t=>{let{width:n,height:r,set:a,theme:l}=t;const o=e(a.elems);return i.createElement(Ur,Object.assign({bins:o,width:n,height:r,theme:l},s))},renderSelection:t=>{let{width:n,height:r,theme:a,overlap:l,selectionColor:o}=t;if(null==l||0===l.length)return null;const c=e(l);return i.createElement(Ur,Object.assign({bins:c,width:n,height:r,theme:a,rectStyle:{stroke:o,strokeWidth:2,fill:"light"===a?Qr:Vr}},s))},renderQuery:t=>{let{width:n,height:r,overlap:a,query:l,secondary:o,index:c,theme:m}=t;if(null==a||0===a.length)return null;const u=e(a);return i.createElement(Ur,Object.assign({bins:u,width:n,height:r,margin:o?c+2:0,rectStyle:{stroke:l.color,fill:"light"===m?Qr:Vr},theme:m},s))}}}const Zr=[{name:"Alton Lannister",sets:["was killed","Lannister","male"]},{name:"Arya Stark",sets:["Stark","female"]},{name:"Benjen Stark",sets:["was killed","Stark","male"]},{name:"Bran Stark",sets:["royal","Stark","male"]},{name:"Brandon Stark",sets:["was killed","Stark"]},{name:"Catelyn Stark",sets:["was killed","Stark","female"]},{name:"Cersei Lannister",sets:["royal","was killed","Lannister","female"]},{name:"Eddard Stark",sets:["was killed","Stark","male"]},{name:"Jaime Lannister",sets:["was killed","Lannister","male"]},{name:"Jon Snow",sets:["royal","was killed","Stark","male"]},{name:"Kevan Lannister",sets:["was killed","Lannister","male"]},{name:"Lancel Lannister",sets:["was killed","Lannister","male"]},{name:"Lyanna Stark",sets:["was killed","Stark","female"]},{name:"Martyn Lannister",sets:["was killed","Lannister","male"]},{name:"Rickard Stark",sets:["was killed","Stark","male"]},{name:"Rickon Stark",sets:["was killed","Stark","male"]},{name:"Robb Stark",sets:["royal","was killed","Stark","male"]},{name:"Sansa Stark",sets:["royal","Stark","female"]},{name:"Tyrion Lannister",sets:["Lannister","male"]},{name:"Tywin Lannister",sets:["was killed","Lannister","male"]},{name:"Willem Lannister",sets:["was killed","Lannister","male"]}],Yr=G(Zr,{order:"cardinality"}),Xr=[{name:"Q1",color:"steelblue",elems:Zr.filter((()=>Math.random()>.7))},{name:"Q2",color:"red",elems:Zr.filter((()=>Math.random()>.8))}],ea=["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494"],ta={React:i,GameOfThronesDataSet:o,...i,...r,...l,...s,...a};delete ta.default;const na=ta}}]);